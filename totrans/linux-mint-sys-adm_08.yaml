- en: Chapter 8. Storage and Backup
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '*This chapter covers basic concepts and information about filesystems, storage
    types, and how to create and restore backups. System administrators should have
    a clear knowledge about them as this information is of huge value among users,
    companies, universities, and other kinds of organizations.*'
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, we shall learn the following topics:'
  prefs: []
  type: TYPE_NORMAL
- en: Finding out the main filesystem types used by GNU/Linux distributions
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How to assign disk quota to users
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How to analyze your disk usage
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How to create and restore backups
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Filesystem types
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Computer data is stored and organized in a specific system in storage devices.
    The operating system should be able to store, organize, access, and update that
    data. In order to execute all mentioned operations, a **filesystem** is used.
    All files and folders inside a storage device are organized by a filesystem, and
    the operating system deals with it. A storage device can be a hard drive, an external
    USB drive, or a set of files and folders on a network.
  prefs: []
  type: TYPE_NORMAL
- en: Each filesystem offers the system administrators and users a set of metadata
    to work with it. This metadata includes information such as length of a data contained
    in a file, the owner of a file, and the time that the file was last modified.
    Currently, you can find a lot of filesystems, and each family of operating systems
    is able to work with many of them. The Linux kernel is the main component of the
    operating system that deals directly with filesystems. Also, Linux distributions
    offer tools and techniques to work with different types of filesystems.
  prefs: []
  type: TYPE_NORMAL
- en: Filesystems and storage devices use the concept of **partition** , which identifies
    a slice of a storage device used by a filesystem. Usually, each storage device
    is divided by partitions, and each of them can be formatted using a specific filesystem.
    A formatting operation provides a mechanism to create a filesystem inside a partition.
    Remember that Mint automatically creates some partitions in our hard drive during
    the installation process.
  prefs: []
  type: TYPE_NORMAL
- en: Mint allows us to work with some of the most popular filesystem used by the
    Linux operating system family. Specifically, Linux Mint can work with partitions
    such as `ext2`, `ext3`, `ext4`, `btrfs`, `xfs`, and `reiserfs`. Currently, `ext4`
    is a standard de facto for Linux partitions, and Linux Mint uses it by default.
    Although `btrfs` is experimental, you can test it in your hard drive, thanks to
    Mint. On the other hand, `reiserfs` is very popular for its journaled features
    and its stability. Some system administrators prefer to use `xfs` due to its high-performance
    journaled system.
  prefs: []
  type: TYPE_NORMAL
- en: Decisions about which is the best filesystem type for each computer and storage
    device are not trivial. Usually, system administrators prefer to use `ext4` for
    PC and workstations; `xfs` and `reiserfs` are common for servers and for devices
    that need high availability and performance.
  prefs: []
  type: TYPE_NORMAL
- en: 'Related to filesystems, we found the other concept: **storages types** . In
    servers running GNU/Linux operating systems, it is common to use storage types
    such as **Redundant Array of Independent Disks** (**RAID**) and **Logical Volume
    Management** (**LVM**). The first one is a technology that basically combines
    multiple disks into a unique logic unit. Different levels of RAID can be applied,
    popular ones are RAID 5 and RAID 1\. Some advantages of RAID usage are redundancy
    of data and a high level of performance.'
  prefs: []
  type: TYPE_NORMAL
- en: On the other hand, LVM is a method of allocating spaces in storage devices in
    a more convenient and flexible way using traditional partitions. Using LVM, it
    is possible to create backups by taking snapshots. In addition to this important
    feature, LVM allows system administrators to apply hot swapping for adding or
    replacing disks without disrupting services provided by the device storage. During
    the installation process Mint allows you to use LVM instead of partitions.
  prefs: []
  type: TYPE_NORMAL
- en: Disk quotas
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Hard drives and storages in general have limited space, so it's important to
    do some tasks of maintenance to prevent those devices from reaching their maximum
    capacity. An easy way to manage limits on storage is to use **disk quotas** ;
    this is a technique of assigning a specific size space for each user or group
    of the operating system.
  prefs: []
  type: TYPE_NORMAL
- en: 'Linux kernel allows us to use two types of quotas for disks: **soft** and **hard**.
    On using the first one, the user will receive a warning when the limit is reached.
    On the other hand, a hard quota doesn''t allow a user to create files after reaching
    the limit.'
  prefs: []
  type: TYPE_NORMAL
- en: Time for action – assigning disk quota to a specific user
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We're going to learn how to set a limit of 20 MB for the `/dev/sda3` partition
    of a specific hard drive for a user called `arturo` . Let's imagine that the `/home`
    partition is mounted on `/dev/sda3`. The quota assigned to a user will be soft,
    so a warning message will be received. Obviously, you can choose a different user
    and partition for your hard drive or other device accessible through your computer.
  prefs: []
  type: TYPE_NORMAL
- en: Go to **Menu** and launch the **Software Manager** application, then look for
    and install an application called **quota**.![Time for action – assigning disk
    quota to a specific user](img/9601_08_01.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Enable quota checking on the filesystem by modifying the `/etc/fstab` file
    and adding `usrquota` and `grquota` values to a specific partition. Only the root
    user has permissions to modify the mentioned file, so you need to log in as `root`
    before changing it. The line in the `/etc/fstab` file should be the following
    one:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: After editing and changing the `/etc/fstab` file, you must reboot your computer.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Execute the following command to check the partition where quota has been enabled:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Let''s assign a quota to our user. In order to do that, you need to execute
    the next command that will open an editor to modify a specific configuration file
    for assigning quotas:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Right now, you can modify the opened file by adding the value `20480` to the
    **soft** column in the line corresponding to the `/dev/sda3` partition. Save the
    file when you're ready. Disk quota has now been assigned to the user `arturo`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '*What just happened?*'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The quota application contains two useful commands (`quotacheck` and `edquota`)
    for setting and checking quotas in hard drives for users and groups. In our example,
    we've configured our system to launch a warning when a specific user is trying
    to use more than 20 MB in the `/home` partition.
  prefs: []
  type: TYPE_NORMAL
- en: All information about the partitions that are going to be mounted when a computer
    boots can be found in the `/etc/fstab` file, which has been modified to activate
    quota checking. Instead of rebooting the computer, you can unmount and mount the
    specific partition.
  prefs: []
  type: TYPE_NORMAL
- en: We've just used a limit of 20 MB to check out how a warning message is displayed.
    Obviously, system administrators choose different values for specific purposes,
    as each scenario is different.
  prefs: []
  type: TYPE_NORMAL
- en: Have a go hero – scheduling quota checking
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'You can check periodically whether quota has been reaching the storage limit.
    In order to do that, you can use the `quotacheck` command through the `cron` tool.
    We only need to create a file `/etc/cron.daily/quotacheck` with the following
    line:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: Thanks to `cron`, the operating system checks each day whether the quota has
    been reached for each configured user.
  prefs: []
  type: TYPE_NORMAL
- en: Disk usage analysis
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We've learned how to assign quotas to users and to preserve space in hard drives.
    Regarding this functionality, it's important to know how much space is used in
    each partition and directory. Thanks to this feature, a system administrator can
    decide how to organize partitions upon disk usage.
  prefs: []
  type: TYPE_NORMAL
- en: Time for action – examining disk usage
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We're going to take a look at our hard drive to discover how much space is used
    for each partition and directory.
  prefs: []
  type: TYPE_NORMAL
- en: Go to the main menu and click on the **Disk Usage Analyzer** menu option, which
    belongs to the **System tools** menu group.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Now you have access to a new window, which displays graphic information about
    your hard drive space and usage:![Time for action – examining disk usage](img/9601_08_02.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '*What just happened?*'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '**Baobab** is the name of the tool used to analyze disk usage provided by Linux
    Mint. It offers us graphical information about the filesystem capacity and the
    way in which space is distributed along the hard drive. For each directory in
    your `home` folder, you can see a number of files, space in percentage, and size.
    Also, it''s possible to choose information about a specific folder, which can
    be selected through the folder icon located in the main toolbar of Baobab.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Regarding graphical information displayed by Baobab, we can select between
    two kinds of charts: **treemap** and **rings**. Below the toolbar, a simple line
    informs us about the capacity of the filesystem and how much space is available.
    This is a simple but very practical information.'
  prefs: []
  type: TYPE_NORMAL
- en: Creating backups
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Some information stored on computers is very important and valuable, so we need
    to keep it safe. Also, it's recommended to make backups, so that if some of this
    information is lost or damaged, we can restore the backup, and everything should
    work properly again. Let's learn how to create backups from Linux Mint.
  prefs: []
  type: TYPE_NORMAL
- en: Time for action – making a backup of a specific folder
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We're going to make a backup of a folder called `testbackup`, which is inside
    your `home` folder, to a folder called `backup` inside the `/tmp` directory. You
    can create the `testbackup` folder and add some files inside it.
  prefs: []
  type: TYPE_NORMAL
- en: Click on **Menu** and then click again on the **All Applications** option, and
    choose **Backup Tool** inside the **Administration** group.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The **Backup Tool** application will be launched and you can see a new window
    with a few buttons. Click on the **Backup files** button:![Time for action – making
    a backup of a specific folder](img/9601_08_03.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Choose the **testbackup** folder for the **Source** option and select the **backup**
    folder from the **/tmp** folder for the **Destination** drop-down option. Click
    on the **Forward** button when you're ready:![Time for action – making a backup
    of a specific folder](img/9601_08_04.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Next options allow you to exclude some folders and directories. We're not going
    to exclude anything, so you can click on the **Forward** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Review your source and destination folders. If everything is fine, then click
    **Apply**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Finally, you can see a message informing you about the success of the backup
    operation. Click on the **Close** button when you're ready. Take a look at the
    `backup` folder to make sure your files are there.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '*What just happened?*'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Backup Tool is an application included in Linux Mint that provides a simple
    and effective way to make and restore backups of files, folders, and applications.
    We've explained a basic operation—how to make a backup of a folder. However, Backup
    Tool also allows you to create a backup of a simple file or even some applications
    installed on your computer.
  prefs: []
  type: TYPE_NORMAL
- en: '**Advanced options** provided by Backup Tool allows us to choose an output
    format and options to perform overwrite, preserve permissions, and timestamp,
    follow symlinks, or confirm integrity of files and folders. We used the default
    options, but you can choose your own preferences too.'
  prefs: []
  type: TYPE_NORMAL
- en: If you access the `/tmp/backup` folder, you can find files created from Backup
    Tool. These files will be identical to your files inside the `testbackup` folder.
  prefs: []
  type: TYPE_NORMAL
- en: Apart from choosing a folder inside the same hard disk, you also can make a
    backup using different devices such as USB pen drives, an external USB disk, or
    a folder accessible through your network.
  prefs: []
  type: TYPE_NORMAL
- en: Keep in mind that Backup Tool is executed through a root user, so you can backup
    any directory of your hard drive. Also, you should be authenticated before using
    this tool.
  prefs: []
  type: TYPE_NORMAL
- en: Have a go hero – creating and restoring a backup file
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: You can try to create a `tarball` (created with the `tar` utility) file and
    restore it. As source, you can use a few files instead of a whole directory. Backup
    Tool offers you the chance to do that with a few clicks. Don't forget to choose
    the **.tar.gz file** option for the **Output** drop-down option inside **Advanced
    options**.
  prefs: []
  type: TYPE_NORMAL
- en: Restoring backups
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Once you have made backups of your important files, folders, or applications,
    you should store them in a safe place. If something goes wrong, you can restore
    these backups in selected files or folders of your hard drive. Despite each company
    and system administrator using a specific policy for making and restoring backups,
    we should learn how to perform a simple restoring of a folder.
  prefs: []
  type: TYPE_NORMAL
- en: Time for action – restoring a backup folder
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: After creating a backup, it's time to restore it. We'll restore the `/tmp/backup`
    folder to `testbackup` inside your `home` folder.
  prefs: []
  type: TYPE_NORMAL
- en: Access the **Backup Tool** from the main menu.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Restore files** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the **Directory** checkbox and choose the **backup** folder from the
    **tmp** directory. For the **Destination** menu option, you should select **testbackup**
    from your **home** folder. Click on **Forward** button when you're ready:![Time
    for action – restoring a backup folder](img/9601_08_05.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Review your options to make sure you're going to restore to the correct backup
    folder.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **Apply,** and a new message will be displayed informing you about
    the restore operation. Your files should be available in the `testbackup` folder.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '*What just happened?*'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We've restored a backup inside the `home` folder. Obviously, the original backup
    should exist in the place where it was created previously. Thanks to this action,
    you can recover your files and folders without any problems.
  prefs: []
  type: TYPE_NORMAL
- en: Regarding **Advanced** **options**, when you're restoring a backup, you only
    can choose what kind of overwrite you want to apply. Some options are **never**,
    **by size**, **always**, and **checksum mismatch**; among these, one option is
    selected by default.
  prefs: []
  type: TYPE_NORMAL
- en: Alternative to restoring a directory, you can restore a backup file created
    using the same tool.
  prefs: []
  type: TYPE_NORMAL
- en: Have a go hero – create backup for applications
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: It would be interesting to prove how to create and restore a backup of some
    applications installed on your computer. You can do that using the **Backup software**
    selection and the **Restore** **software** selection buttons provided by Backup
    Tool.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Computer storage is complex as it's possible to find different kinds of devices
    and filesystems. Usually, technology used for storage is complicated and before
    taking a decision about what kind of storage and device of a filesystem should
    be used, it's important to make a complete analysis of the final scenario.
  prefs: []
  type: TYPE_NORMAL
- en: In this chapter, you've learned the basic concepts to deal with storage. Also,
    you know how to create and restore simple backups.
  prefs: []
  type: TYPE_NORMAL
- en: 'Specifically, we covered:'
  prefs: []
  type: TYPE_NORMAL
- en: Main filesystems used in Linux Mint and other GNU/Linux distributions
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How to assign disk quotas to users
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Graphically examining your disk usage
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How to create and make backups
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In the next chapter, you're going to learn about security, which is one of the
    topics more relevant for system administrators.
  prefs: []
  type: TYPE_NORMAL
