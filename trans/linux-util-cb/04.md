# 第四章。网络和互联网

在本章中，我们将介绍:

*   不良连接故障排除
*   将文件复制到另一台机器–文件传输协议和文件传输协议
*   登录到另一台机器–远程登录和安全外壳
*   无需浏览器即可获取网页–wget
*   浏览网页——火狐
*   电子邮件–使用网络邮件程序
*   运行您自己的网络服务器–httpd
*   什么在使用那个端口？/etc/services 文件
*   IPv4 与 IPv6

# 简介

在当今世界，“上网”至关重要。这里我们解释连通性以及当它不起作用时该怎么做。但是首先我们将解释有线连接和无线连接的优缺点。

典型的有线以太网连接快速可靠。它通常不会出现掉线或数据包丢失的情况。像 5E 类或 6 类这样的优质电线可以运行数英尺而不会丢失任何信号。

无线连接让你可以自由地，嗯，一方面不用电线。如果配置得当，使用起来毫不费力，而且非常可靠。

有线连接有以下优点:

*   有线连接通常比无线连接快
*   总的来说，它更可靠
*   它不会遭受定期掉线或数据包丢失的困扰
*   更容易配置和排除故障

有线连接有以下缺点:

*   我们需要使用电线；重新排列或更改可能非常困难，尤其是在计算机实验室环境中
*   我们需要有人来设计和物理连接网络
*   当使用具有多个以太网端口的大型服务器时，可能会令人困惑

无线连接有以下优点:

*   很方便；我们不需要处理电线
*   在某些情况下，它可能会远离基础路由器
*   它很容易为客人设置

无线连接有以下缺点:

*   它并不总是可靠的。掉包比有线连接更频繁。
*   可能很难设置，尤其是第一次。
*   我们必须处理密码和加密，以防止不必要的访问。

# 排除不良连接

这似乎偶尔会发生，而且是在最糟糕的时候。这些是我诊断和解决有线连接问题时通常采取的步骤。假设连接在过去的某个时间正常工作。

## 做好准备

这个例子没有特别的设置，除非你碰巧在某个地方有一台坏了的机器。您可以运行这些命令中的大部分，而不用担心伤害一个好的系统。

## 怎么做...

诊断网络问题时，请尝试以下步骤:

1.  首先，让我们通过 ping 一个已知的外部地址来确定连接是否真的中断了。我使用路跑者作为我的 ISP，所以对我来说命令应该是:

    ```
    ping rr.com

    ```

2.  Something like this should appear:

    ![How to do it...](graphics/3008OS_04_00.jpg)

3.  按*Ctrl* + *C* 至停止输出。如果命令行显示超时，或者显示没有主机或路由错误，则连接确实中断。让我们试着解决它。
4.  找到您的网关地址。运行 `route`命令；您的网关应该显示在输出的顶部。注意，`route`命令需要很长时间才能完成，这也是连接中断的信号。
5.  Ping 上面路由提供的网关。如果它成功 pings 通，那么问题很可能出在路由器上，或者 ISP 本身。
6.  如果它没有得到一个好的 ping，让我们试试这个。如果您已经知道接口名称，请跳到下一步。如果没有，使用`ifconfig`命令找到它。寻找一个类似于`eth0`或`p3p2`的小节。
7.  运行界面上的 `ethtool` 命令。对我来说是 `ethtool eth0`。看最后一行；上面应该写着:

    ```
    Link detected:   yes

    ```

8.  如果不是，问题可能是电线。如果您的端口有指示灯，请查看它们是否亮起。其中一个应该不时眨眼。试着扭动电线。当然，如果您有已知良好的电线，请尝试更换。请注意，“已知良好的焊线”并不意味着*就一定是包装外的焊线。曾经被咬过一次。*
9.  如果电线看起来没问题，我们再深入看看。确保在上面的步骤中，您有正确的界面。注意此时，您可能只想阅读这些步骤，而不是运行命令，因为它们会使您的网络瘫痪。
10.  尝试运行 `ifdown` `<interface>`命令。您可能看不到任何输出。
11.  现在运行 `ifup` `<interface>`命令。这可能需要几秒钟，然后您应该会看到一些输出。如果您正在使用 DHCP，您应该会看到正在建立的连接。当您得到提示后，再次尝试 ping。
12.  我假设如果你还在阅读，`ping`失败，连接仍然关闭。您的路由器和/或调制解调器可能出现了故障。试着关掉它们，等一分钟，然后再打开。
13.  待网络稳定后，再次尝试`ping`。如果它仍然关闭，请继续下一步。
14.  尽管我鄙视这种解决方案，但在这一点上，我建议冷关机。关闭除一个终端以外的所有终端，并运行以下命令:

    ```
    shutdown -h now

    ```

15.  我喜欢在重启前等待几分钟，只是为了确保内存实际上是干净的。好吧，把它打开，等它一路启动。
16.  再次尝试`ping`命令。如果它现在工作，我会怀疑某种短暂的错误或问题。如果它继续工作，那太好了。然而，如果它再次失败，我会怀疑硬件可能会变坏。
17.  如果`ping`命令在重新启动后仍然失败，我会尝试启动实时媒体映像。如果这种方法有效并在网上传播，那么你的基本系统中的文件就有问题。如果不工作，我会再次怀疑硬件。
18.  最后一件事；确保没有人对您的 DHCP 服务器进行任何更改。配置错误的服务器会导致各种不好的事情发生，比如没有连接。

## 还有更多...

我希望这部分是有用的。这些步骤在过去对我起了无数次作用。我还有一个建议是看看你的`/var/log/messages`文件(和/或`dmesg`)。这也许能解释为什么连接失败。

### 注

**处理 IP 地址、子网、域等**

这将是对 IP 地址、子网和域的简要概述。了解这些信息将有助于你阅读本书的后续章节。

总的来说， IP 地址是网络上一台计算机与另一台计算机的区别。是`66.69.172.30`等一组数字。在家庭网络中，由于最有可能使用 **NAT** ( **网络地址转换** ) ，您可能更熟悉本地地址，例如`192.168.1.115`。

以下是术语的快速列表:

*   **IP 地址** : 本机的互联网协议地址，例如`192.168.1.115`。
*   **子网**:第三个八位字节(或一组数字)是子网。例如，`192.168.1.115`和`192.168.1.120`在同一个子网。然而，`192.168.2.115`不是。
*   **域**:域通常用主机名来指代，如[rr.com](http://rr.com)。它也有一个数字 IP。使用`ping`命令确定主机名使用的是哪个 IP。

# 将文件复制到另一台机器–FTP 和 SCP

不算邮件，将文件复制到另一台机器上最常见的两种方式是 **FTP** ( **文件传输协议**)和 **SCP** ( **安全复制**)。这里我们将讨论两者。

FTP 已经存在很多年了，今天仍然被大量使用。然而，标准 FTP 确实有一个严重的缺点。数据以所谓的“明文”形式发送。这意味着知识渊博的人可以在适当的条件下获得数据。我们稍后再谈这个。

## 做好准备

我们将假设已经设置了一个 FTP 服务器，并且可以用于本练习。通常情况下，您会从一台机器(客户端)到另一台机器(服务器)使用`ftp`命令。然而，对于这个例子，我只使用一台机器。启动 FTP 会话的命令是`ftp server-name`，其中服务器名可以是网络上已知的主机名，也可以是数字 IP 地址。例如，我在`/tmp`创建了一个名为`f1.txt`的文件，在`/home/jklewis`创建了一个名为`f5.txt`的文件。

大多数 Linux 发行版已经设置了允许`scp`命令，非常方便。我们假设你的发行版允许这样做。请注意，有些不允许 root 访问，因此我们将使用来宾帐户。

SCP 的语法由给定的命令组成。

要复制到机器:

```
scp local-filename username@hostname:/directory

```

要从机器复制:

```
scp username@hostname:/directory/filename 

```

(别忘了上面的冒号。)

以下是 Fedora 18 上的 FTP 帮助屏幕截图:

![Getting ready](graphics/3008OS_04_01.jpg)

## 怎么做...

下面是如何使用`ftp`命令:

1.  在客户端的终端会话中，运行以下命令:

    ```
    ftp 192.168.1.115

    ```

2.  它会给你一个提示。输入用户名并按*进入*。
3.  输入密码，按*进入*。
4.  应该显示类似**登录成功**的内容。如果没有，那么你就没有登录，虽然还是会有 FTP 提示。假设它已经登录，运行以下命令:

    ```
    ls -la

    ```

5.  您应该会看到文件列表。运行`help`显示命令列表。它们可能不都在你的系统上可用(我认为这是一个错误)。
6.  使用`ftp` 时要记住的一件事就是要时刻知道自己在哪里。很容易混淆。经常使用`pwd`。立即运行:

    ```
    pwd

    ```

7.  您键入的命令在服务器上。要在本地运行命令，请在命令前面加上感叹号。尝试以下命令:

    ```
    !pwd, !ls

    ```

8.  所以，让我们做点什么。通过运行

    ```
    lcd /tmp

    ```

    将您的本地目录更改为 `/tmp`
9.  运行`!ls`命令。现在让我们将文件`f1.txt`复制到服务器:

    ```
    put f1.txt

    ```

10.  现在让我们从服务器中检索文件【T0:

    ```
    get f5.txt

    ```

11.  这一开始可能会显得有点混乱。那是因为它是。然而，如果你经常使用它，它会变得容易得多。记住，你把它放到服务器上，然后从服务器上得到它。
12.  完成 FTP 会话后，运行以下命令:

    ```
    quit

    ```

13.  现在让我们运行一些命令，开始:

    ```
    cd /tmp

    ```

14.  通过运行

    ```
    ls > f1.txt

    ```

    创建测试文件
15.  运行以下命令:

    ```
    scp f1.txt guest1@192.168.1.115:/temp

    ```

16.  输入用户`guest`的密码。
17.  假设文件`f5.txt`在遥控器`/temp`上，让它运行:

    ```
    scp guest1@192.168.1.115:/temp/f5.txt

    ```

18.  别忘了上面的冒号。跑`ls -la`看看怎么样。

## 还有更多...

我提到 FTP 以明文形式发送数据。安全外壳命令(下一节将详细介绍)使用加密，因此安全性不是问题。此外，还可以设置机器，这样就不需要密码。有关这方面的更多信息，请参见`ssh-keygen`命令。这个主题也包含在[附录 A](11.html "Appendix A. Linux Best Practices") 、 *Linux 最佳实践*中。例如，要配置`sshd`来更改根登录的工作方式，请参见`sshd_config`文件。

# 登录到另一台机器–远程登录和安全外壳

**Telnet** 是一种较旧的协议，但今天仍被大量使用。它遭受着与 FTP 相同的安全问题；它以非加密格式发送文本。然而，在说一个由好的防火墙保护的实验室环境中，它仍然是有用的。

## 做好准备

我将再次使用同一台机器作为客户端和服务器。对于本例，我们将假设远程登录客户端和服务器都已经安装并运行。

启动远程登录会话的命令是`telnet hostname`。主机名可以是网络上可到达的名称，也可以是数字 IP。

**安全外壳** ( **SSH)** ，是一个更流行的协议，因为它提供了密码和文本的强加密。在我看来，它也更容易使用。

要启动安全外壳，命令如下:

```
ssh username@hostname

```

## 怎么做...

这里我们将运行一些远程登录和 SSH 命令:

1.  运行以下命令:

    ```
    telnet 192.168.1.115

    ```

2.  应该会出现横幅和提示。输入用户名。
3.  输入密码。
4.  可能会显示当天的消息(`/etc/motd)`文件)。对于登录的任何人来说，这是一个放置消息和其他信息的好地方。在这个终端中，你几乎可以运行任何你想要的文本模式命令。试试`pwd`。
5.  您可以切换到另一个目录，编辑文件，以及如果您实际上在系统上，您通常会做的几乎所有事情。
6.  完成会话后，运行:

    ```
    exit

    ```

这是在 Fedora 18 上运行的 Telnet 的截图:

![How to do it...](graphics/3008OS_04_02.jpg)

1.  现在让我们尝试运行一个安全外壳会话:

    ```
    ssh jklewis@192.168.1.115

    ```

2.  输入您的密码。`/etc/motd`文件应像以前一样显示。让我们尝试一些命令。运行以下命令:

    ```
    pwd

    ```

3.  运行以下命令:

    ```
    uptime

    ```

4.  与远程登录一样，每个基于文本的命令都应该像在实际机器上一样工作。完成会话后，运行:

    ```
    exit

    ```

## 还有更多...

安全拷贝和安全外壳是拷贝文件和访问远程机器的最佳方式。好好了解他们。我上面提到 `ssh-keygen`程序允许一个人在没有密码的情况下复制文件。这也适用于 SSH。我在我所有的家用机器上使用这个，也在我的网站上使用，这个网站是由服务提供商托管的。有关这个非常酷的功能的更多信息，请运行`man ssh-keygen`。

另外，我提到了远程登录和 SSH 会话应该像在实际机器上一样工作。当客户端运行在非 Linux 机器上时，情况并非总是如此。例如，一些键击可以被不同地映射。看看您正在使用的客户端程序的文档，因为可能有一种方法可以调整键映射。

# 在没有浏览器的情况下获取网页–wget

可能每个人都收到过来源可疑的电子邮件。你知道你不应该点击任何链接，但是如果有一个安全的方法来确定那个网站上有什么，那不是很好吗？嗯，有。

`wget`程序允许你从网址下载文件。虽然可以做很多，但最简单的命令形式是:`wget <some URL>`。假设没有错误，它会将该文件放在当前目录中。如果您没有指定文件名，默认情况下，它将尝试获取`index.html`文件。

## 怎么做...

以下是运行`wget`的方法:

1.  运行以下命令:

    ```
    cd /tmp

    ```

2.  运行以下命令:

    ```
    wget www.jklewis.com

    ```

3.  生成的文件将被命名为`index.html`。查看更多`index.html`。是的，这是我的个人网页。
4.  您也可以参考特定的文件。试试:

    ```
    wget www.jklewis.com/shipfire.gif

    ```

5.  试试其他网站。你可以在一个可疑的网站上这样做，看看它是否安全。
6.  如果你心中有一个可疑地点，在文件上做一个`wget`。查看它，并寻找其他网站的链接。如果你看到类似`http:/DoWeCheatThemAndHow.com`的东西。我可能不会点击那个。

## 还有更多...

`wget`命令可以做得更多。有了正确的参数，它可以用来克隆整个网站和许多其他整洁的东西。有关更多信息，请参考手册页。

# 浏览网页——火狐

对于您的 Linux 系统，有几种不同的浏览器可供选择。这里我们将重点介绍 Mozilla 的 Firefox。

## 做好准备

火狐通常可以通过点击桌面上的浏览器图标获得。您也可以从命令行启动它。对于这个例子，我们将首次使用用户`jklewis`启动火狐。

下面的截图展示了我第一次在用户`jklewis`下打开火狐的样子:

![Getting ready](graphics/3008OS_04_03.jpg)

## 怎么做...

以下是从终端运行火狐的方法:

1.  为来宾用户打开终端会话。对于这个例子，我运行`su - jklewis`并输入我的密码
2.  运行`firefox &`(符号告诉它在后台运行命令，这样你仍然可以访问那个终端。此处还将显示错误消息)。
3.  Firefox 应该会提供默认设置。让我们改变其中的一些。**转到编辑|首选项**。

    ```
    Click on Edit->Preferences

    ```

4.  **火狐首选项**画面应该会出现，在**通用** 部分。看它在哪里显示**首页**，改成更有用的。我把我的换成了[http://jklewis.com](http://jklewis.com)。
5.  **通用**部分也是可以控制**下载**窗口行为的地方。我已选择为该用户保留该复选框。
6.  现在点击**选项卡**部分。我个人鄙视浏览器标签，所以我已经关闭了它们。为此，移除**中的复选标记，在新选项卡中打开新窗口，而不是**和**始终显示选项卡栏**。请注意，在本练习中，您不必这样做。
7.  **内容**部分允许您控制显示的内容。好好看看这个页面，不过，我通常会保持这些设置不变。
8.  **应用程序**部分显示了可用的浏览器插件。我在这里什么都不改变。
9.  现在点击**隐私**部分。这是你可以清除你的历史和处理饼干的地方。
10.  现在点击**安全**。我建议保持现状。
11.  **同步**部分允许您与移动设备同步。
12.  **高级**部分有几页。**通用**页面允许您控制浏览器的运行方式。现在点击**网络**页面。这是您配置缓存的地方。
13.  **更新**页面处理自动更新的内容，**加密**页面是设置协议的地方，您可以在这里查看和修改您的证书。我建议让这些保持原样。
14.  现在关闭**首选项**对话框。
15.  Now let's view a website and bookmark it. Go to the URL field and double-click on it. Press the **Delete** key. Now enter `jklewis.com`.

    ### 类型

    “www”通常不是必需的。

16.  你应该看看我的网页。现在点击**书签**。
17.  点击**为本页面添加书签**。将出现一个标题为**页面书签**的对话框(实际上这是绝对错误的，因为该页面还没有*书签*)。在这里，您可以更改书签的标题或放置书签的文件夹。现在只需点击**完成**即可完成。
18.  该页面现在应该被书签标记。

## 还有更多...

如你所见，还有很多选择。根据需要探索这些。以下是浏览时的一些提示。

在给一个页面添加书签的时候，好好看看给定的标题。出于某种原因，他们并不总是给出一个好的描述性名称。“帐户登录”只是没有告诉我太多。但是，如果我将其更改为“高费用银行和信托-登录”，这将准确告诉我它是哪个帐户。

我强烈建议您的浏览器从来宾帐户运行，而不是从 root 帐户运行。请注意，如果您在来宾用户下运行您的桌面(也强烈建议)，从图标启动 Firefox 将是很好的。

网址字段的右边是一颗星。点击此处调出**历史**。旁边是一个带箭头的半圆。这是**刷新**按钮。如果一个页面加载太慢，或者运行不正常，点击这个图标刷新页面。

# 电子邮件–使用网络邮件程序

有很多网络邮件客户端可用，如**进化**T4【雷鸟】。我两个都用过，发现有些地方有欠缺。出于这个原因和其他原因，我使用浏览器网络邮件应用程序来代替。

## 做好准备

如果你已经使用了一个网络邮件程序，这可能对你来说是旧帽子。但是，如果你以前没有用过，这应该会很有帮助。注意，对于这一部分，我不建议您尝试运行这些命令，只是阅读它们。

## 怎么做...

以下是使用火狐访问网络邮件客户端的方法:

1.  在提供商的网站上登录您的帐户。应该有一个链接可以访问您的电子邮件。您的提供商甚至可能会让您选择使用哪个网络邮件应用程序。我选择了 **松鼠邮件**。
2.  无论你选择哪一个，它都应该打开并询问你的电子邮件帐户密码。请记住，这可能与您用来进入提供商主帐户的密码不同。
3.  一旦你进入邮件应用程序，就应该向你展示收件箱的内容。在这里，您可以回复邮件、转发邮件、提供附件等等。
4.  应该还有通讯录。找到它，打开它，了解如何使用它。如果提供商有办法将地址簿文件导出到您的计算机，请经常使用该功能，以便您可以在以后损坏时恢复它。
5.  记住这一点；如果你要写一封电子邮件并附上一个文件，在做其他事情之前先附上文件。然后去填写其他字段并撰写文本。相信我，你的朋友、家人、潜在雇主等等都会感谢你没有忘记这份依恋。
6.  大多数网络邮件程序不会自动刷新屏幕。所以，如果你让它开着(我一直这样做)，离开电脑，当你回来的时候，一定要刷新电子邮件会话。这通常通过点击**收件箱**标题来完成。您也可以点击浏览器的刷新按钮。
7.  关于网络邮件的最后一件事；邮件可能最终会填满您分配的空间，您甚至可能会从您的提供商那里收到一些关于它的电子邮件。我所做的就是等到我使用了收件箱中大约 80%的空间。然后我直接翻到最后一页(通常是第 30 页左右)，把这些东西扔到垃圾桶里。我一页一页地浏览并删除这些内容，直到我回到第 20 页。
8.  有些人边走边删除邮件。如果你擅长这个就好了。我没有。如果我那样做，我最终会删除一些我希望能找回的东西。
9.  说到找回文件，通常可以通过在**垃圾桶**文件夹中查找来恢复被删除的文件。但是，一旦清除了文件夹，电子邮件将永远消失。清除通常每周自动进行一次(可在某些邮件机上配置)。

## 还有更多...

网络邮件程序的一个很好的特性是你应该能够从任何机器上的任何浏览器访问你的电子邮件。所有信息都存储在提供商的网站上。

以下为**松鼠邮件** | **选项**截图:

![There's more...](graphics/3008OS_04_04.jpg)

# 运行自己的网络服务器–httpd

也许有一天你会想要运行你自己的网络服务器。在我的软件工程师生涯中，我经常被要求管理部门实验室。让我的用户知道正在发生什么的最简单的方法是把笔记和文件放在我自己控制的本地网站上。这听起来可能很难，但事实并非如此。

## 做好准备

这假设您有一个 Linux 系统可以试用。如果没有，你仍然可以从这个部分得到很多。这也是假设 **httpd** 还没有安装。这些步骤是在我运行 Fedora 18 的笔记本电脑上执行的。

## 怎么做...

以下是在 Fedora 上安装自己的“T2”Apache httpd 服务器的步骤:

1.  首先安装 httpd:

    ```
    yum install httpd

    ```

2.  现在转到配置目录:

    ```
    cd /etc/httpd/conf

    ```

3.  制作文件的备份副本:`cp httpd.conf /tmp/httpd.conf.orig`。您可能需要选择更合适的备份目录。
4.  用文本编辑器编辑文件:

    ```
    vi httpd.conf

    ```

5.  这个文件包含了几乎所有你需要知道的东西，以便设置你的 httpd 服务器。仔细阅读第一页关于服务器根的内容。
6.  简而言之，如果文件名以斜杠开头，服务器将按照指示使用该路径。但是，如果使用相对路径，则预先考虑服务器根的值。例如，向下滚动到这一行:

    ```
    Include conf.modules.d/*.conf

    ```

7.  由于这是一个相对路径，并且 ServerRoot 设置为`/etc/httpd`，因此将要包含的目录实际上是`/etc/httpd/conf.modules.d`。
8.  在另一个终端中，现在改变到目录:

    ```
    cd /etc/httpd

    ```

9.  一定要记住 ServerRoot 是如何工作的！这会节省你很多时间。现在让我们再看一遍`httpd.conf`文件。`Listen`指令告诉 httpd 使用哪个端口。暂时放在`80`吧。
10.  向下滚动至服务器名。您可以在这里输入特定服务器的名称。暂时留空。
11.  我们将讨论的最后一个是 DocumentRoot。这是提供网页的目录。应该设置为`/var/www/html`。
12.  让我们实际启动 httpd 服务。运行`systemctl start httpd.service`。这应该会无声地返回到命令行。
13.  我们还必须使用命令`systemctl enable httpd.service`来启用它。这将显示一条成功的链接消息。
14.  现在我们来试试:

    ```
    cd /var/www/html

    ```

15.  运行`ls -la`。它可能是空的。通过运行

    ```
    dmesg > dmesg1.txt

    ```

    创建文件
16.  现在转到或打开浏览器会话。我们会先在本地检查，所以在网址字段输入`file:///var/www/html/dmesg1.txt`。
17.  应该显示文件内容。现在让我们创建另一个文件:

    ```
    echo "This is a new file" > newfile.txt

    ```

18.  用你的知识产权代替我的知识产权，在网址栏中试试这个:`192.168.1.115:/newfile.txt`。应显示`newfile.txt`的内容。

## 还有更多...

如果你决定做大量的“网页服务”，一定要阅读并理解`httpd.conf`文件。网上也有相当多的信息。

您可能会发现您实际上无法从网络上的另一台计算机访问您的文件。这很可能是由于防火墙(`iptables`)问题；但是，您的路由器可能也需要一些配置。这将在[第 5 章](05.html "Chapter 5. Permissions, Access, and Security")、*权限、访问和安全*中介绍。

# 那个端口是干什么用的？/etc/services 文件

有时，您可能需要知道特定端口上运行的是什么服务。`/etc/services`文件包含该信息及更多信息。

## 怎么做...

这里我们将看一下 Linux 系统上的一些常见服务:

1.  查看您的`/etc/services`文件:`more /etc/services`。
2.  按一次空格键向下滚动页面。看它显示的地方`"ftp"?`。下一列的`21`表示 FTP 正在使用的端口。`/tcp`和`/udp`意味着端口可用于两种协议。
3.  还应该看到`telnet`(如果没有，按下*进入*几次)。它应该显示端口`23`。
4.  现在让我们搜索一项服务。按几次退格键回到顶部，输入`/nameserver`。
5.  我们可以看到`nameserver`正在使用端口`42`，并且同时适用于 TCP 和 UDP。
6.  文件很长(在我的系统中超过 11，000 行)，因为有很多很多的标准端口。

## 还有更多...

按照惯例，编号为`0`至`1023`的港口被视为“知名港口”。编号为`1024`至`49151`的港口为“注册港口”。私有和动态端口从`49152`到`65535`。如果您正在开发一个应用程序或者正在处理端口，请确保遵循这个端口使用约定。

以下是 Fedora 18 上`/etc/services`前几行截图:

![There's more...](graphics/3008OS_04_05.jpg)

# IPv4 对 IPv6

截至本书撰写之时，**互联网协议第 4 版** ( **IPv4** )用于路由互联网上的大部分网络流量。它使用 32 位(4 字节)地址，允许 232 个地址的空间。在 IPv4 下，没有足够的剩余地址来容纳现在使用的所有互联网设备，这就是为什么创建 **IPv6** 的原因。在本节中，我们将首先运行一些命令，然后讨论 IPv4 和 IPv6。

## 怎么做...

让我们尝试使用两种协议的一些命令:

1.  让我们从 IPv4 开始。运行以下命令:

    ```
    ping 192.168.1.115

    ```

2.  然后，运行以下命令:

    ```
    ssh 192.168.1.115

    ```

3.  现在让我们试试 IPv6。首先，让我们看看您的计算机是否有 IPv6 地址。在你的界面上运行`ifconfig`；在我的笔记本电脑上是`ifconfig wlan0`。
4.  您应该会看到如下输出:

    ```
    inet 192.168.1.115  netmask 255.255.255.0  broadcast 192.168.1.255

    ```

5.  您还应该看到类似以下输出的内容:`inet6 2002:244:b303:0:221:5eff:feff:f15d`。试着敲一下。我的是`ping 2002:244:b303:0:221:5eff:feff:f15d` **。**
6.  你得到一个`ping: unknown host`错误吗？那是因为我们必须使用IPv6 版本的 ping。再试一次，但是像下面的命令:

    ```
    ping6 2002:244:b303:0:221:5eff:feff:f15d

    ```

7.  现在试试`ssh`，好像已经知道 IPv6 了:

    ```
    ssh 2002:244:b303:0:221:5eff:feff:f15d

    ```

## 还有更多...

一般来说，在 IPv4、下，一个数字 IP 地址写成`xxx.yyy.zzz.www`，称为点分十进制格式。由点分隔的 3 个数字中的每一个被称为八位字节。高位八位字节，本例中的`xxx`表示这是哪一类的 IP。以下是 IPv4 中可用类别的部分列表:

<colgroup><col style="text-align: left"> <col style="text-align: left"></colgroup> 
| 

班级

 | 

港口

 |
| --- | --- |
| 专用网 | 10.0.0.0 |
| 本地环回 | 127.0.0.1 |
| 链接-本地 | 169.254.0.0 |
| 专用网 | 192.168.0.0 |
| IP 多播 | 224.0.0.0 |
| 广播 | 255.255.255.255 |

您已经看到了一些我在家庭网络中使用的私有地址的例子。格式通常类似于以下命令集:

```
ping 192.168.1.115
scp file1.txt guest1@192.168.1.115:/temp
telnet 192.168.1.115
ssh 192.168.1.115

```

IPv4 地址空间在 2011 年正式耗尽。出于这个和其他原因，IPv6 被创建。

IPv6 是互联网协议的最新版本。与使用 32 位地址的 IPv4 相反，IPv6 使用 128 位地址。这是 2128 个地址，或者说足够地球上的每个人都有超过 100 万个地址供自己使用。我们可能不会很快用完这些。

IPv6 地址有 8 组 4 个十六进制数字，用冒号分隔:`2002:4244:b323:0:4687:fcff:fe69:4d0f`。

是的，这看起来令人生畏，但这种变化有几个原因:

*   地址越长，路由效率越高
*   它允许特殊的寻址技术
*   子网的大小现在是 264 个地址
*   在 IPv4 下对现有网络重新编号可能非常复杂；如果配置正确，这不是 IPv6 的问题
*   多播可以更有效地完成
*   IPv6 有 **无状态地址自动配置** ( **SLAAC** )

IPv6 地址可以缩写如下:前导零可以省略。

连续的零组可以省略并用两个冒号替换。

看下面的例子:IP 地址是`2002:0244:0000:0000:0000:fcff:fe69:4d0f`。

省略前导零，我们得到`2002:244:0:0:0:fcff:fe69:4d0f`。

现在省略零组，我们得到`2002:244::fcff:fe69:4d0f`。

有关更多信息，请参考手册页和互联网。大量使用 IPv6 还有很长的路要走，但最终会到来。