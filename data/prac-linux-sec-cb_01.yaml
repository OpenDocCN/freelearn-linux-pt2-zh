- en: Chapter 1. Linux Security Problems
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第1章。Linux 安全问题
- en: 'In this chapter, we will discuss the following:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将讨论以下内容：
- en: The security policy of Linux
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Linux 的安全策略
- en: Configuring password protection
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置密码保护
- en: Configuring server security
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置服务器安全性
- en: Conducting integrity checks of the installation medium using checksum
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用校验和对安装介质进行完整性检查
- en: Using the LUKS disk encryption
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 LUKS 磁盘加密
- en: Making use of sudoers – configuring sudo access
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 sudoers – 配置 sudo 访问
- en: Scanning hosts with Nmap
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 Nmap 扫描主机
- en: Gaining a root on a vulnerable Linux system
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在易受攻击的 Linux 系统上获取 root 权限
- en: Introduction
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍
- en: A Linux machine is only as secure as an administrator configures it to be. Once
    we are done with the installation of the Linux OS and we remove its unnecessary
    packages after the installation has been completed, we can start working on the
    security aspect of the software and the services provided by the Linux machine.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: Linux 机器的安全性取决于管理员的配置。一旦我们完成了 Linux 操作系统的安装，并在安装完成后删除了不必要的软件包，我们可以开始处理软件的安全性以及
    Linux 机器提供的服务方面。
- en: The security policy of Linux
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Linux 的安全策略
- en: A security policy is a definition that outlines the rules and practices to be
    followed to set up the computer network security in an organization. How the organization
    should manage, protect, and distribute sensitive data is also defined by the security
    policy.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 安全策略是定义了组织中设置计算机网络安全的规则和实践。安全策略还定义了组织应该如何管理、保护和分发敏感数据。
- en: Developing a security policy
  id: totrans-14
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 制定安全策略
- en: When creating a security policy, we should keep in mind that it should be simple
    and easy for all users. The objective of the policy should be to protect data
    while keeping the privacy of users intact.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 在制定安全策略时，我们应该牢记它应该对所有用户简单易懂。政策的目标应该是在保护数据的同时保持用户的隐私。
- en: 'It should be developed around these points:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 它应该围绕这些要点展开：
- en: Accessibility to the system
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对系统的可访问性
- en: Software installation rights on the system
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 系统上的软件安装权限
- en: Data permission
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据权限
- en: Recovery from failure
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从故障中恢复
- en: When developing a security policy, a user should use only those services for
    which permission has been granted. Anything that is not permitted should be restricted
    in the policy.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 在制定安全策略时，用户应该只使用已获得许可的服务。不允许的任何事物都应该在政策中受到限制。
- en: Configuring password protection
  id: totrans-22
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 配置密码保护
- en: In any system, the password plays a very important role in terms of security.
    A poor password may lead to an organization's resources being compromised. The
    password protection policy should be adhered to by everyone in the organization,
    from users to the administrator level.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 在任何系统中，密码在安全方面起着非常重要的作用。弱密码可能导致组织资源被 compromise。密码保护政策应该被组织中的每个人遵守，从用户到管理员级别。
- en: How to do it…
  id: totrans-24
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做到…
- en: Follow the given rules when selecting or securing your password.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 在选择或保护密码时，请遵循给定的规则。
- en: 'For the creation policy, follow these rules:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 对于创建策略，请遵循以下规则：
- en: A user should not use the same password for all the accounts in an organization
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用户不应该在组织中的所有账户上使用相同的密码。
- en: All access-related passwords should not be the same
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 所有与访问相关的密码都不应该相同
- en: Any system-level account should have a password that's different from any other
    account held by the same user
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 任何系统级别的账户的密码都应该与同一用户拥有的其他账户不同
- en: 'For the protection policy, follow these rules:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 对于保护策略，请遵循以下规则：
- en: A password is something that needs to be treated as sensitive and confidential
    information. Hence, it should not be shared with anyone.
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 密码是需要被视为敏感和机密信息的东西。因此，不应该与任何人分享。
- en: Passwords should not be shared through any electronic communication, such as
    e-mails.
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 密码不应该通过电子通信（如电子邮件）分享。
- en: Never reveal a password on your phone or questionnaire.
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 永远不要在电话或问卷调查中透露密码。
- en: Do not use password hints that could provide clues to an attacker.
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不要使用可能为攻击者提供线索的密码提示。
- en: Never share company passwords with anyone, including administrative staff, managers,
    colleagues, and even family members.
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 永远不要与任何人分享公司密码，包括管理人员、经理、同事，甚至家人。
- en: Don't store passwords in written form anywhere in your office. If you store
    passwords on a mobile device, always use encryption.
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不要在办公室的任何地方以书面形式存储密码。如果在移动设备上存储密码，始终使用加密。
- en: Don't use the *Remember Password* feature of applications.
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不要使用应用程序的“记住密码”功能。
- en: In there's any doubt of a password being compromised, report the incident and
    change the password as soon as possible.
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果怀疑密码被 compromise，立即报告事件并尽快更改密码。
- en: 'For the change policy, follow these rules:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 对于更改策略，请遵循以下规则：
- en: All users and administrators must change their password on a regular basis or
    at least on a quarterly basis
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 所有用户和管理员必须定期更改密码，或者至少每季度更改一次
- en: The security audit team of an organization must conduct random checks to check
    whether the passwords of any user can be guessed or cracked
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 组织的安全审计团队必须进行随机检查，以检查任何用户的密码是否可以被猜测或破解。
- en: How it works…
  id: totrans-42
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何运作的…
- en: With the help of the preceding points, ensure that a password, when created
    or changed, is not easy enough to be guessed or cracked.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 通过前述要点的帮助，确保密码在创建或更改时不容易被猜测或破解。
- en: Configuring server security
  id: totrans-44
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 配置服务器安全性
- en: A major reason for malicious attacks on Linux servers has been poorly implemented
    security or existing vulnerabilities. When configuring a server, security policies
    need to be implemented properly, and ownership needs to be taken in order to properly
    customize the server.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 对 Linux 服务器进行恶意攻击的一个主要原因是安全性实施不当或现有的漏洞。在配置服务器时，安全策略需要得到适当的实施，并且需要承担责任以便正确定制服务器。
- en: How to do it…
  id: totrans-46
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做到…
- en: 'General Policy:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 一般政策：
- en: The administration of all the internal servers in an organization is the responsibility
    of a dedicated team, which should also keep a look out for any kind of compliance.
    If any compliance takes place, the team should accordingly implement or review
    the security policy.
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 组织内所有内部服务器的管理是专门团队的责任，该团队还应该密切关注任何合规性。如果发生任何合规性，团队应相应地实施或审查安全策略。
- en: 'When configuring internal servers, they must be registered in such a way that
    the servers can be identified on the basis of the following information:'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在配置内部服务器时，必须以这样的方式注册服务器，以便可以根据以下信息识别服务器：
- en: Location of the server
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 服务器的位置
- en: The operating system version and its hardware configuration
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 操作系统版本及其硬件配置
- en: Services and applications that are being run
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 正在运行的服务和应用程序
- en: Any kind of information in the organization's management system must always
    be kept up to date.
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 组织管理系统中的任何信息都必须始终保持最新。
- en: 'Configuration Policy:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 配置策略：
- en: The operating system on the server should be configured in accordance with the
    guidelines approved for InfoSec.
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 服务器上的操作系统应按照InfoSec批准的指南进行配置。
- en: Any service or application not being used should be disabled wherever possible.
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 尽可能禁用未使用的任何服务或应用程序。
- en: All access to the services and applications on the server should be monitored
    and logged. They should also be protected through access-control methods. An example
    of this will be covered in [Chapter 3](ch03.html "Chapter 3. Local Filesystem
    Security"), *Local Filesystem Security*.
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对服务器上的所有服务和应用程序的所有访问都应进行监控和记录。它们还应通过访问控制方法进行保护。这方面的示例将在[第3章](ch03.html "第3章
    本地文件系统安全")中进行介绍，*本地文件系统安全*。
- en: The system should be kept updated, and any recent security patches, if available,
    should be installed as soon as possible.
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 系统应保持更新，并且应尽快安装任何最近的安全补丁（如果有的话）。
- en: Avoid using a root account to the maximum extent. It's preferable to use security
    principles that require the least amount of access to perform a function.
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 尽量避免使用root帐户。最好使用需要最少访问权限来执行功能的安全原则。
- en: Any kind of privileged access must be performed over secure channel connection
    (SSH) wherever possible.
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 任何特权访问必须尽可能通过安全通道连接（SSH）进行。
- en: The server should be accessed in a controlled environment.
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应在受控环境中访问服务器。
- en: 'Monitoring Policy:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 监控策略：
- en: 'All security-related actions on server systems must be logged, and audit reports
    should be saved as follows:'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 服务器系统上的所有与安全相关的操作必须记录，并且审计报告应保存如下：
- en: For a period of 1 month, all security-related logs should be kept online
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 所有与安全相关的日志应在线保存1个月
- en: For a period of 1 month, daily backups as well as weekly backups should be retained
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在1个月的时间内，应保留每日备份以及每周备份
- en: For minimum of 2 years, full monthly backups should be retained
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 至少保留2年的完整月度备份
- en: Any event related to security being compromised should be reported to the InfoSec
    team. They shall then review the logs and report the incident to the IT department.
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 任何与安全有关的事件应报告给InfoSec团队。然后他们将审查日志并向IT部门报告事件。
- en: 'A few examples of security-related events are as follows:'
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一些与安全相关的事件的示例如下：
- en: Port scanning-related attacks
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与端口扫描相关的攻击
- en: Access to privileged accounts without authorization
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 未经授权访问特权帐户
- en: Unusual occurrences due to a particular application being present on the host
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 由于主机上存在特定应用程序而导致的异常事件
- en: How it works…
  id: totrans-72
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理…
- en: Following the preceding policy helps in the base configuration of the internal
    server that is owned or operated by the organization. Implementing the policy
    effectively will minimize any unauthorized access to sensitive and proprietary
    information.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 遵循前述政策有助于对组织拥有或运营的内部服务器进行基本配置。有效实施该政策将最大程度地减少对敏感和专有信息的未经授权访问。
- en: There's more…
  id: totrans-74
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多内容…
- en: There are some more things to discover when we talk about security in Linux.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 在谈论Linux安全时，还有一些其他要发现的事情。
- en: Security controls
  id: totrans-76
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安全控制
- en: When we talk about securing a Linux machine, it should always start with following
    a checklist in order to help in the hardening of the system. The checklist should
    be such that following it will confirm the implementation of proper security controls.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们谈论保护Linux机器时，应始终从遵循清单开始，以帮助加固系统。清单应该是这样的，遵循它将确认适当的安全控制的实施。
- en: Conducting integrity checks of the installation medium using checksum
  id: totrans-78
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用校验和对安装介质进行完整性检查
- en: Whenever we download an image file of any Linux distribution, it should always
    be checked for correctness and safety. This can be achieved by doing an MD5 checksum
    of the downloaded image with the MD5 value of the correct image.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 每当我们下载任何Linux发行版的镜像文件时，都应始终检查其正确性和安全性。可以通过将下载的镜像的MD5校验和与正确镜像的MD5值进行比较来实现这一点。
- en: This helps in checking the integrity of the downloaded file. Any changes to
    the files can be detected by the MD5 hash comparison.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 这有助于检查下载文件的完整性。通过MD5哈希比较可以检测到文件的任何更改。
- en: Whenever any changes take place in the downloaded files, the MD5 hash comparison
    can detect it. The larger the file size, the higher the possibility of changes
    in the file. It is always recommended to do the MD5 hash comparison for files
    such as operating system installation files on a CD.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 每当下载文件发生更改时，MD5哈希比较可以检测到。文件越大，文件更改的可能性就越高。建议对诸如光盘上的操作系统安装文件之类的文件进行MD5哈希比较。
- en: Getting ready
  id: totrans-82
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: The MD5 checksum is normally installed on most Linux distributions, so installation
    is not required.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数Linux发行版通常已安装了MD5校验和，因此不需要安装。
- en: How to do it…
  id: totrans-84
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 操作步骤…
- en: First open the Linux terminal and then change the directory to the folder containing
    the downloaded ISO file using the `ubuntu@ubuntu-desktop:~$ cd Downloads` command.
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先打开Linux终端，然后使用`ubuntu@ubuntu-desktop:~$ cd Downloads`命令将目录更改为包含下载的ISO文件的文件夹。
- en: Note
  id: totrans-86
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Linux is case-sensitive, and type the correct spelling for the folder name.
    *Downloads* is not the same as *downloads* in Linux.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: Linux区分大小写，请为文件夹名称输入正确的拼写。在Linux中，*Downloads*与*downloads*不同。
- en: 'After changing to the `Downloads` directory, type the following command:'
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 切换到`Downloads`目录后，键入以下命令：
- en: '[PRE0]'
  id: totrans-89
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'The `md5sum` command will then print the calculated hash in a single line,
    as shown here:'
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，`md5sum`命令将以单行打印计算出的哈希，如下所示：
- en: '[PRE1]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Now, we can compare the hash calculated by the preceding command with the hash
    on the UbuntuHashes page ([https://help.ubuntu.com/community/UbuntuHashes](https://help.ubuntu.com/community/UbuntuHashes)).
    After opening the UbuntuHashes page, we just need to copy the preceding hash that
    has been calculated in the *Find* box of the browser (by pressing *Ctrl* + *F*).
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以将前面命令计算的哈希与UbuntuHashes页面上的哈希进行比较（[https://help.ubuntu.com/community/UbuntuHashes](https://help.ubuntu.com/community/UbuntuHashes)）。打开UbuntuHashes页面后，我们只需要在浏览器的*查找*框中复制前面计算的哈希（按下*Ctrl*
    + *F*）。
- en: How it works…
  id: totrans-93
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理…
- en: If the calculated hash and the hash on the UbuntuHashes page match, then the
    downloaded file is not damaged. If the hashes don't match, then there might be
    a problem with either the downloaded file or the server from where the download
    was made. Try downloading the file again. If the issue still persists, it is recommended
    that you report the issue to the administrator of the server.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 如果计算出的哈希与UbuntuHashes页面上的哈希匹配，则下载的文件没有损坏。如果哈希不匹配，则可能是下载的文件或下载的服务器出了问题。尝试重新下载文件。如果问题仍然存在，建议您向服务器管理员报告问题。
- en: See also
  id: totrans-95
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: 'Here''s something extra in case you want to go the extra mile: try out the
    GUI checksum calculator that is available for Ubuntu'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您想要额外的东西，可以尝试一下Ubuntu可用的GUI校验和计算器
- en: Sometimes, it's really inconvenient to use a terminal in order to perform checksums.
    You need to know the right directory of the downloaded file and also the exact
    filename. This makes it difficult to remember the exact commands.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 有时，使用终端执行校验和真的很不方便。您需要知道已下载文件的正确目录以及确切的文件名。这使得很难记住确切的命令。
- en: As a solution for this, there is a very small and simple software called **GtkHash**.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 作为解决方案，有一个名为**GtkHash**的非常小型和简单的软件。
- en: 'You can download the tool from [http://gtkhash.sourceforge.net/](http://gtkhash.sourceforge.net/),
    and install it using this command:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以从[http://gtkhash.sourceforge.net/](http://gtkhash.sourceforge.net/)下载该工具，并使用此命令进行安装：
- en: '[PRE2]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Using the LUKS disk encryption
  id: totrans-101
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用LUKS磁盘加密
- en: In enterprises such as small businesses and government offices users may have
    to secure their systems in order to protect their private data, which includes
    customers details, important files, contact details, and so on. To do so, Linux
    provides good number of cryptographic techniques, which can be used to protect
    data on physical devices such as hard disks or a removable media. One such cryptographic
    technique uses the **Linux Unified Key Setup**-on-disk-format (**LUKS**). This
    technique allows for the encryption of Linux partitions.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 在小型企业和政府办公室等企业中，用户可能需要保护其系统以保护其私人数据，包括客户详细信息、重要文件、联系方式等。为此，Linux提供了大量的加密技术，可用于保护硬盘或可移动介质上的数据。其中一种加密技术使用**Linux统一密钥设置**-磁盘格式（**LUKS**）。该技术允许对Linux分区进行加密。
- en: 'LUKS has the following functionality:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: LUKS具有以下功能：
- en: An entire block device can be encrypted using LUKS. It's well suited to protecting
    data on removable storage media or laptop disk drives.
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可以使用LUKS对整个块设备进行加密。它非常适合保护可移动存储介质或笔记本电脑硬盘驱动器上的数据。
- en: Once encrypted, the contents of the encrypted block devices are random, thus
    making it useful for the encryption of swap devices.
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一旦加密，加密块设备的内容就是随机的，因此对于加密交换设备非常有用。
- en: LUKS uses an existing device mapper kernel subsystem.
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: LUKS使用现有的设备映射器内核子系统。
- en: It also provides a passphrase strengthener, which helps in protecting against
    dictionary attacks.
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 它还提供了一个口令强化器，有助于防范字典攻击。
- en: Getting ready
  id: totrans-108
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备就绪
- en: For the following process to work, it is necessary that `/home` is created on
    a separate partition while installing Linux.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 为了使以下过程工作，需要在安装Linux时在单独的分区上创建`/home`。
- en: Tip
  id: totrans-110
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: '**WARNING**'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: '**警告**'
- en: Configuring LUKS using the given steps will remove all the data on the partition
    that's being encrypted. So, before starting the process of using LUKS, make sure
    to back up the data on an external source.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 使用给定的步骤配置LUKS将删除正在加密的分区上的所有数据。因此，在开始使用LUKS的过程之前，请务必将数据备份到外部来源。
- en: How to do it…
  id: totrans-113
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作…
- en: 'For manually encrypting directories follow these steps:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 要手动加密目录，请按照以下步骤进行：
- en: 'Move to Run level 1\. Type the following command in the shell prompt or terminal:'
  id: totrans-115
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 切换到运行级别1。在shell提示符或终端中键入以下命令：
- en: '[PRE3]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Now, unmount the current /home partition using this command:'
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，使用此命令卸载当前的`/home`分区：
- en: '[PRE4]'
  id: totrans-118
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'The previous command might fail if there is any process controlling `/home`.
    Find and kill any such process using the `fuser` command:'
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果有任何控制`/home`的进程，前面的命令可能会失败。使用`fuser`命令找到并终止任何此类进程：
- en: '[PRE5]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Check to confirm that the `/home` partition is not mounted now:'
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查确认`/home`分区现在未挂载：
- en: '[PRE6]'
  id: totrans-122
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Now, put some random data into the partition:'
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，将一些随机数据放入分区：
- en: '[PRE7]'
  id: totrans-124
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: The previous command might take some time to complete, so be patient. The time
    taken depends on the write speed of your device.
  id: totrans-125
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前面的命令可能需要一些时间才能完成，所以请耐心等待。所花费的时间取决于您设备的写入速度。
- en: 'Once the previous command completes, initialize the partition:'
  id: totrans-126
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦前面的命令完成，初始化分区：
- en: '[PRE8]'
  id: totrans-127
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Open the newly created encrypted device:'
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开新创建的加密设备：
- en: '[PRE9]'
  id: totrans-129
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Check to confirm that the device is present:'
  id: totrans-130
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查确认设备是否存在：
- en: '[PRE10]'
  id: totrans-131
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Now create a filesystem:'
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在创建文件系统：
- en: '[PRE11]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Then, mount the new filesytem:'
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，挂载新的文件系统：
- en: '[PRE12]'
  id: totrans-135
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Confirm that the filesystem is still visible:'
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确认文件系统仍然可见：
- en: '[PRE13]'
  id: totrans-137
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Enter the following line in the `/etc/crypttab` file:'
  id: totrans-138
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`/etc/crypttab`文件中输入以下行：
- en: '[PRE14]'
  id: totrans-139
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Make changes in the `/etc/fstab` file to delete the entry for `/home` and add
    the following line:'
  id: totrans-140
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`/etc/fstab`文件中进行更改，删除`/home`的条目并添加以下行：
- en: '[PRE15]'
  id: totrans-141
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Once completed, run this command to restore the default SELinux security settings:'
  id: totrans-142
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 完成后，运行此命令以恢复默认的SELinux安全设置：
- en: '[PRE16]'
  id: totrans-143
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'Reboot the machine:'
  id: totrans-144
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重新启动机器：
- en: '[PRE17]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: After rebooting, the system will prompt us for the LUKS passphrase on boot.
    You can log in as the root now and restore your backup.
  id: totrans-146
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重启后，系统将在启动时提示我们输入LUKS密码。您现在可以以root身份登录并恢复您的备份。
- en: Congratulations! You have successfully created an encrypted partition. Now you
    can keep all your data safe even when your computer is off.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 恭喜！您已成功创建了一个加密分区。现在，即使计算机关闭，您也可以保持所有数据的安全。
- en: How it works…
  id: totrans-148
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理…
- en: We first move into running level 1 and unmounting the `/home` partition. Once
    unmounted, we fill some random data in the `/home` partition. Then, we initialize
    the partition, using the `cryptsetup` command to encrypt it.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 我们首先进入运行级别1并卸载`/home`分区。卸载后，在`/home`分区中填充一些随机数据。然后，我们使用`cryptsetup`命令对分区进行初始化并加密。
- en: Once the encryption is done, we mount the filesystem back again, and then make
    an entry of the partition in the `/etc/crypttab` file. Also, the `/etc/fstab`
    file is edited to add an entry for the preceding encrypted partition.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 加密完成后，我们再次挂载文件系统，然后在`/etc/crypttab`文件中添加分区的条目。此外，编辑`/etc/fstab`文件以添加前面加密的分区的条目。
- en: After completing all the steps, we have restored the default settings of SELinux.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 完成所有步骤后，我们已恢复了SELinux的默认设置。
- en: Doing this, the system will always ask for the LUKS passphrase on boot.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 这样做，系统将始终在启动时要求输入LUKS密码。
- en: Making use of sudoers – configuring sudo access
  id: totrans-153
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 利用sudoers – 配置sudo访问权限
- en: Whenever the system administrator wants to provide trusted users administrative
    access to the system without sharing the password of the root user, they can do
    so using the `sudo` mechanism.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 每当系统管理员希望为受信任的用户提供对系统的管理访问权限，而不共享root用户的密码时，他们可以使用`sudo`机制来实现。
- en: Once the user is given access using the `sudo` mechanism, they can execute any
    administrative command by preceding it with `sudo`. Then, the user will be asked
    to enter their own password. After this, the administrative command will be executed
    in the same way as run by the root user.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦用户使用`sudo`机制获得访问权限，他们可以通过在命令前加上`sudo`来执行任何管理命令。然后，用户将被要求输入他们自己的密码。之后，管理命令将以与root用户相同的方式执行。
- en: Getting ready
  id: totrans-156
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: As the file for the configuration is predefined and the commands used are inbuilt,
    nothing extra needs to be configured before starting these steps.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 由于配置文件是预定义的，使用的命令是内置的，在开始这些步骤之前不需要额外配置。
- en: How to do it…
  id: totrans-158
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 操作步骤…
- en: We will first create a normal account and then give it `sudo` access. Once done,
    we will be able to use the `sudo` command from the new account and then execute
    the administrative commands. Follow the steps given to configure the `sudo` access.
    Firstly, use the root account to login to the system. Then, create a user account
    using the `useradd` command, as shown in the following figure:![How to do it…](img/B04234_01_01.jpg)
  id: totrans-159
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将首先创建一个普通帐户，然后给予它`sudo`访问权限。完成后，我们将能够从新帐户使用`sudo`命令，然后执行管理命令。按照给定的步骤配置`sudo`访问权限。首先，使用root帐户登录系统。然后，使用`useradd`命令创建用户帐户，如下图所示：![操作步骤…](img/B04234_01_01.jpg)
- en: Replace `USERNAME` with any name of your choice in the preceding command.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的命令中，用任何您选择的名称替换`USERNAME`。
- en: Now, using the `passwd` command, set a password for the new user account.![How
    to do it…](img/B04234_01_02.jpg)
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，使用`passwd`命令为新用户帐户设置密码。![操作步骤…](img/B04234_01_02.jpg)
- en: Edit the `/etc/sudoers` file by running `visudo`. The policies applied when
    using the `sudo` command are defined by the `/etc/sudoers` file.![How to do it…](img/B04234_01_03.jpg)
  id: totrans-162
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过运行`visudo`编辑`/etc/sudoers`文件。使用`sudo`命令时应用的策略由`/etc/sudoers`文件定义。![操作步骤…](img/B04234_01_03.jpg)
- en: Once the file is open in the editor, search for the following lines, which allow
    `sudo` access to the users in the `test` group:![How to do it…](img/B04234_01_04.jpg)
  id: totrans-163
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦文件在编辑器中打开，搜索以下允许`test`组中的用户使用`sudo`访问的行：![操作步骤…](img/B04234_01_04.jpg)
- en: We can enable the given configuration by deleting the comment character (`#`)
    at the beginning of the second line. Once the changes are made, save the file
    and exit from the editor. Now, using the `usermod` command, add the previously
    created user to the `test` group.![How to do it…](img/B04234_01_05.jpg)
  id: totrans-164
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们可以通过删除第二行开头的注释字符(`#`)来启用给定的配置。一旦更改完成，保存文件并退出编辑器。现在，使用`usermod`命令，将先前创建的用户添加到`test`组。![操作步骤…](img/B04234_01_05.jpg)
- en: We need to check whether the configuration shown in the preceding screenshot
    allows the new user account to run commands using `sudo`.
  id: totrans-165
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们需要检查前面截图中显示的配置是否允许新用户帐户使用`sudo`运行命令。
- en: To switch to the newly created user account, use the `su` option.![How to do
    it…](img/B04234_01_06.jpg)
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`su`选项切换到新创建的用户帐户。![操作步骤…](img/B04234_01_06.jpg)
- en: Now, use the `groups` command to confirm the presence of the user account in
    the `test` group.![How to do it…](img/B04234_01_07.jpg)
  id: totrans-167
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，使用`groups`命令确认`test`组中存在用户帐户。![操作步骤…](img/B04234_01_07.jpg)
- en: Finally, run the `whoami` command with `sudo` from the new account. As we have
    executed a command that uses `sudo` for the first time, using this new user account,
    the default banner message will be displayed for the `sudo` command. The screen
    will also ask for the user account password to be entered.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，使用新帐户从`sudo`运行`whoami`命令。由于我们是第一次使用新用户帐户执行使用`sudo`的命令，`sudo`命令将显示默认的横幅消息。屏幕还会要求输入用户帐户密码。
- en: '![How to do it…](img/B04234_01_08.jpg)'
  id: totrans-169
  prefs: []
  type: TYPE_IMG
  zh: '![操作步骤…](img/B04234_01_08.jpg)'
- en: The last line of the preceding output is the username returned by the `whoami`
    command. If `sudo` is configured correctly, this value will be `root`.
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前面输出的最后一行是`whoami`命令返回的用户名。如果`sudo`配置正确，这个值将是`root`。
- en: You have successfully configured a user with `sudo` access. You can now log
    in to this user account and use `sudo` to run commands the same way as you would
    from the root user.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 您已成功配置了一个具有`sudo`访问权限的用户。您现在可以登录到这个用户帐户，并使用`sudo`来运行命令，就像您从根用户那里一样。
- en: How it works…
  id: totrans-172
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的…
- en: When we create a new account, it does not have permission to run administrator
    commands. However, after editing the `/etc/sudoers` file and making an appropriate
    entry to grant `sudo` access to the new user account, we can start using the new
    user account to run all the administrator commands.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们创建一个新帐户时，它没有权限运行管理员命令。但是，在编辑`/etc/sudoers`文件并对新用户帐户授予`sudo`访问的适当条目后，我们可以开始使用新用户帐户运行所有管理员命令。
- en: There's more…
  id: totrans-174
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多…
- en: Here is an extra measure that you can take to ensure total security.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是您可以采取的额外措施，以确保总体安全。
- en: Vulnerability assessment
  id: totrans-176
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 漏洞评估
- en: A vulnerability assessment is the process of auditing our network and system
    security through which we can know about the confidentiality, integrity, and availability
    of our network. The first phase in the vulnerability assessment is reconnaissance,
    and this further leads to the phase of system readiness in which we mainly check
    for all known vulnerabilities in the target. The next phase is reporting, where
    we group all the vulnerabilities found into categories of low, medium, and high
    risk.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 漏洞评估是通过审计我们的网络和系统安全性来了解我们网络的机密性、完整性和可用性的过程。漏洞评估的第一阶段是侦察，这进一步导致了系统准备阶段，我们主要检查目标中所有已知的漏洞。下一个阶段是报告，我们将所有发现的漏洞分为低、中和高风险的类别。
- en: Scanning hosts with Nmap
  id: totrans-178
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Nmap扫描主机
- en: Nmap is one of the most popular tools included in Linux that can be used to
    scan a network. It has been in existence for many years, and to date, it is one
    of the most preferable tools to gather information about a network.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap是Linux中包含的最流行的工具之一，可用于扫描网络。它已经存在多年，迄今为止，它是收集有关网络信息的最可取的工具之一。
- en: Nmap can be used by administrators on their networks to find any open ports
    and host systems.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap可以被管理员用于他们的网络上找到任何开放的端口和主机系统。
- en: When doing a vulnerability assessment, Nmap is surely a tool that can't be missed.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 在进行漏洞评估时，Nmap无疑是一个不可或缺的工具。
- en: Getting ready
  id: totrans-182
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备就绪
- en: 'Most Linux versions have Nmap installed. The first step is to check whether
    you already have it using this command:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数Linux版本都安装了Nmap。第一步是使用以下命令检查您是否已经拥有它：
- en: '[PRE18]'
  id: totrans-184
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'If Nmap exists, you should see an output similar to what is shown here:'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 如果Nmap存在，你应该看到类似于这里显示的输出：
- en: '![Getting ready](img/B04234_01_17.jpg)'
  id: totrans-186
  prefs: []
  type: TYPE_IMG
  zh: '![准备就绪](img/B04234_01_17.jpg)'
- en: If Nmap is not already installed, you can download and install it from [https://nmap.org/download.html](https://nmap.org/download.html)
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 如果尚未安装Nmap，可以从[https://nmap.org/download.html](https://nmap.org/download.html)下载并安装它
- en: How to do it…
  id: totrans-188
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做…
- en: 'Follow these steps to scan hosts using Nmap:'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤使用Nmap扫描主机：
- en: The most common use of Nmap is to find all online hosts within a given IP range.
    The default command used to do this takes some time to scan the complete network,
    depending on the number of hosts present in the network. However, we can optimize
    the process in order to scan the range faster.
  id: totrans-190
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Nmap最常见的用途是找到给定IP范围内的所有在线主机。用于执行此操作的默认命令需要一些时间来扫描完整的网络，这取决于网络中存在的主机数量。但是，我们可以优化这个过程，以便更快地扫描范围。
- en: 'The following screenshot shows you an example of this:'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图向您展示了一个例子：
- en: '![How to do it…](img/B04234_01_09.jpg)'
  id: totrans-192
  prefs: []
  type: TYPE_IMG
  zh: '![如何做…](img/B04234_01_09.jpg)'
- en: In the preceding example, the time taken to complete the scan was 6.67 seconds
    when scanning 100 hosts. If the whole IP range for a particular network is to
    be scanned, it would take a lot more time.
  id: totrans-193
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在前面的例子中，扫描完成所用的时间为6.67秒，扫描了100个主机。如果要扫描特定网络的整个IP范围，将需要更多的时间。
- en: Now, let's try to speed up the process. The `n` switch tells Nmap not to perform
    the DNS resolution of the IP addresses, hence making the process faster. The `T`
    switch tells Nmap what speed to operate at. Here, `T1` is the slowest and `T5`
    is the fastest. The `max-rtt-timeout` option specifies the maximum time required
    to wait for the response.
  id: totrans-194
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们试着加快这个过程。`n`开关告诉Nmap不执行IP地址的DNS解析，从而使过程更快。`T`开关告诉Nmap以什么速度运行。在这里，`T1`是最慢的，`T5`是最快的。`max-rtt-timeout`选项指定等待响应的最长时间。
- en: 'Now, the same command is shown in this example:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，相同的命令在这个例子中显示如下：
- en: '![How to do it…](img/B04234_01_10.jpg)'
  id: totrans-196
  prefs: []
  type: TYPE_IMG
  zh: '![如何做…](img/B04234_01_10.jpg)'
- en: This time, Nmap scanned the complete IP range in 1.97 seconds. Pretty good,
    right?
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 这一次，Nmap在1.97秒内扫描了完整的IP范围。相当不错，对吧？
- en: Port scanning using Nmap helps us discover services that are online, such as
    finding FTP servers. To do this, use the following command:![How to do it…](img/B04234_01_11.jpg)
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用Nmap进行端口扫描有助于我们发现在线的服务，比如找到FTP服务器。要做到这一点，使用以下命令：![如何做…](img/B04234_01_11.jpg)
- en: The preceding command of Nmap shall list out all the IP addresses that have
    port 21 open.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap的前面的命令将列出所有开放端口21的IP地址。
- en: Not only FTP, other services can also be discovered by matching the port numbers
    on which they run. For example, MySQL runs on port 3306\. The command will now
    look like this:![How to do it…](img/B04234_01_12.jpg)
  id: totrans-200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 不仅FTP，其他服务也可以通过匹配它们运行的端口号来发现。例如，MySQL运行在端口3306上。命令现在将如下所示：![如何做…](img/B04234_01_12.jpg)
- en: How it works…
  id: totrans-201
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的…
- en: Nmap checks for services that are listening by testing the most common network
    communication ports. This information helps the network administrator to close
    down any unwanted or unused services. The preceding examples show you how to use
    port scanning and Nmap as powerful tools to study the network around us.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap通过测试最常见的网络通信端口来检查正在监听的服务。这些信息有助于网络管理员关闭任何不需要或未使用的服务。前面的例子向您展示了如何使用端口扫描和Nmap作为研究我们周围网络的强大工具。
- en: See also
  id: totrans-203
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: Nmap also has scripting features using which we can write custom scripts. These
    scripts can be used with Nmap to automate and extend its scanning capabilities.
    You can find more information about Nmap on its official home page at [https://nmap.org/](https://nmap.org/)
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap还具有脚本功能，可以编写自定义脚本。这些脚本可以与Nmap一起使用，自动化和扩展其扫描能力。您可以在其官方主页[https://nmap.org/](https://nmap.org/)上找到有关Nmap的更多信息。
- en: Gaining a root on a vulnerable Linux system
  id: totrans-205
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在易受攻击的Linux系统上获得root权限
- en: When trying to learn how to scan and exploit a Linux machine, one major problem
    we encounter is where to try learning it. For this purpose, the Metasploit team
    has developed and released a VMware machine called **Metasploitable**. This machine
    has been made vulnerable purposefully and has many services running unpatched.
    Due to this, it becomes a great platform to practice or develop penetration testing
    skills. In this section, you will learn how to scan a Linux system, and then using
    the scanning result, find a service that is vulnerable. Using this vulnerable
    service, we shall gain root access to the system.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 学习如何扫描和利用Linux机器时，我们遇到的一个主要问题是在哪里学习。为此，Metasploit团队开发并发布了一个名为**Metasploitable**的VMware机器。这台机器被故意制作成易受攻击，并且有许多未打补丁的服务在运行。因此，它成为了一个练习或开发渗透测试技能的绝佳平台。在本节中，您将学习如何扫描Linux系统，然后使用扫描结果找到一个有漏洞的服务。利用这个有漏洞的服务，我们将获得对系统的root访问权限。
- en: Getting ready
  id: totrans-207
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: Backtrack 5R2 and the Metasploitable VMware system will be used in this section.
    The image file of Metasploitable can be downloaded from [http://sourceforge.net/projects/metasploitable/files/Metasploitable2/](http://sourceforge.net/projects/metasploitable/files/Metasploitable2/).
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 本节将使用Backtrack 5R2和Metasploitable VMware系统。Metasploitable的镜像文件可以从[http://sourceforge.net/projects/metasploitable/files/Metasploitable2/](http://sourceforge.net/projects/metasploitable/files/Metasploitable2/)下载。
- en: How to do it…
  id: totrans-209
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 操作步骤…
- en: 'Follow these steps to gain root access to a vulnerable Linux system:'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤获得对易受攻击的Linux系统的root访问权限：
- en: 'First, open the Metasploit console on the backtrack system by following this
    menu: navigate to **Main Menu** | **Backtrack** | **Exploitation Tools** | **Network
    Exploitation Tools** | **Metasploit Framework** | **Msfconsole**.'
  id: totrans-211
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，通过以下菜单在backtrack系统上打开Metasploit控制台：导航到**Main Menu** | **Backtrack** | **Exploitation
    Tools** | **Network Exploitation Tools** | **Metasploit Framework** | **Msfconsole**。
- en: 'Next, we need to scan the target (which is `192.168.0.1` in this example) with
    Nmap:'
  id: totrans-212
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们需要使用Nmap扫描目标（在本例中是`192.168.0.1`）：
- en: 'This figure shows the output of the command that is executed:'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 这张图片显示了执行的命令的输出：
- en: '![How to do it…](img/B04234_01_13.jpg)'
  id: totrans-214
  prefs: []
  type: TYPE_IMG
  zh: '![如何操作…](img/B04234_01_13.jpg)'
- en: In the preceding command, the `-Ss` option allows us to perform a stealth scan,
    and the `-A` option tries to discover the version information of the OS and service.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 在上述命令中，`-Ss`选项允许我们执行隐蔽扫描，`-A`选项尝试发现操作系统和服务的版本信息。
- en: Also, in the preceding command, we can see that there are many services running
    on different ports. Among them is Samba, which runs on ports 139 and 445.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，在上述命令中，我们可以看到许多服务在不同的端口上运行。其中包括运行在端口139和445上的Samba。
- en: Note
  id: totrans-217
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Note that Samba is a service that provides the SMB file and prints services
    for Windows systems.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，Samba是一个为Windows系统提供SMB文件和打印服务的服务。
- en: Once we are able to locate the Samba service, we will just focus on it now.
    From the preceding output, we can see that Samba is running version 3.x. Now,
    we shall try to get more specific information about the service. To do this, we
    will use any of the auxiliary modules of Metasploit, such as the scanner section,
    and look for the SMB protocol.![How to do it…](img/B04234_01_14.jpg)
  id: totrans-219
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦我们能够找到Samba服务，我们现在将专注于它。从上述输出中，我们可以看到Samba运行的是3.x版本。现在，我们将尝试获取有关服务的更具体信息。为此，我们将使用Metasploit的任何辅助模块，比如扫描器部分，并寻找SMB协议。![如何操作…](img/B04234_01_14.jpg)
- en: We can see that the scanner section has a SMB version detector. Now, we'll get
    the exact version of Samba using the SMB detector program. If we search online
    for all the vulnerabilities of the particular version of Samba, we will find the
    username map script.
  id: totrans-220
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们可以看到扫描器部分有一个SMB版本检测器。现在，我们将使用SMB检测程序获得Samba的确切版本。如果我们在线搜索特定版本的Samba的所有漏洞，我们将找到用户名map
    script。
- en: We can now search in the list of exploits available in Metasploit to check whether
    an exploit exists for the `map script` username using the `search samba` command.![How
    to do it…](img/B04234_01_15.jpg)
  id: totrans-221
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们现在可以在Metasploit提供的漏洞列表中搜索`map script`用户名是否存在漏洞，使用`search samba`命令。![如何操作…](img/B04234_01_15.jpg)
- en: We have found an exploit for the map script username, and it has a rating that
    is excellent, which means that we can use this exploit.
  id: totrans-222
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们已经找到了map script用户名的一个漏洞利用，并且它的评分非常优秀，这意味着我们可以使用这个漏洞利用。
- en: Now, use the map script username to gain a root level shell in the system.![How
    to do it…](img/B04234_01_16.jpg)
  id: totrans-223
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，使用map script用户名在系统中获得root级别的shell。![如何操作…](img/B04234_01_16.jpg)
- en: Now, we shall gain root-level access to the system using the preceding exploit.
    Once we choose the exploit and configure it with the target IP address (in this
    case, `192.168.0.1`), we will execute a command to run the exploit. Doing this
    will create and give us a remote session on the target system and also open a
    command shell. Now, run the `id` command in the remote shell. This will give a
    result—`uid=0(root)gid=0(root)`. This confirms that we have remote root access
    to the target system.
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们将使用上述漏洞利用获得对系统的root级别访问权限。一旦我们选择了漏洞利用并配置了目标IP地址（在本例中是`192.168.0.1`），我们将执行一个命令来运行漏洞利用。这将在目标系统上创建并给我们一个远程会话，并打开一个命令shell。现在，在远程shell中运行`id`命令。这将给出一个结果—`uid=0(root)gid=0(root)`。这证实我们已经对目标系统具有远程root访问权限。
- en: How it works
  id: totrans-225
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的
- en: We first performed an Nmap scan to check for running services and open ports
    and found the Samba service running. Then, we tried to find the version of the
    SMB service. Once we got this information, we searched for any exploit available
    for Samba. Using the exploit, we tried to attack the target system and got the
    root shell on it.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 我们首先执行了Nmap扫描，以检查运行的服务和开放的端口，并发现Samba服务正在运行。然后，我们尝试找到SMB服务的版本。一旦获得这些信息，我们就搜索了Samba的任何利用。使用利用漏洞，我们试图攻击目标系统，并在其中获得了root
    shell。
- en: There's more…
  id: totrans-227
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多…
- en: Let's learn about a few more exploits and attacks that are peculiar to Linux.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们了解一些特有于Linux的更多利用和攻击。
- en: In this section, we shall go through a few of the common exploits and attacks
    that Linux is vulnerable to. However, in this section, will not cover any recipes
    to deal with the attacks. This section is just to let you know about the common
    exploits used in Linux.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将介绍Linux容易受到的一些常见利用和攻击。但是，在本节中，我们不会涵盖任何处理攻击的方法。本节只是让您了解Linux中常用的利用。
- en: Null or default passwords
  id: totrans-230
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 空密码或默认密码
- en: Often, administrators use default passwords that are provided to them by a vendor
    or they may even leave the administrative password blank. This happens mainly
    while configuring devices, such as routers, and also in BIOSes. Even some services
    running on Linux can contain the default administrator password. It is always
    recommended that you change the default password and set a new one that is only
    known to the administrator.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，管理员使用供应商提供给他们的默认密码，或者甚至将管理密码留空。这主要发生在配置设备（如路由器）和BIOS时。甚至一些在Linux上运行的服务可能包含默认的管理员密码。建议您始终更改默认密码，并设置一个只有管理员知道的新密码。
- en: IP spoofing
  id: totrans-232
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: IP欺骗
- en: An attacker can find vulnerabilities on our systems and servers, and using these,
    they can install background programs or attack a network. This can be done if
    the attacker connects his system to our network in a way that makes it appear
    as though there's a node in the local network. There are various tools available
    to assist crackers while performing IP spoofing.
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者可以在我们的系统和服务器上找到漏洞，并利用这些漏洞安装后台程序或攻击网络。如果攻击者以一种使其看起来像是本地网络中的一个节点的方式连接他的系统到我们的网络，就可以实现这一点。在执行IP欺骗时，有各种工具可用于帮助黑客。
- en: Eavesdropping
  id: totrans-234
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 窃听
- en: An attacker can collect data passing between two active nodes that communicate
    on a network by eavesdropping. This type of attack works mostly with protocols
    such as Telnet, FTP, and HTTP. Attacks of this kind can be done when the remote
    attacker already has access to any system on the network. This can be made possible
    using other attacks such as the Man in the Middle Attack.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者可以通过窃听来收集在网络上进行通信的两个活动节点之间传递的数据。这种类型的攻击主要适用于Telnet、FTP和HTTP等协议。这种攻击可以在远程攻击者已经可以访问网络上的任何系统时进行。这可以通过其他攻击，如中间人攻击来实现。
- en: Service vulnerabilities
  id: totrans-236
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 服务漏洞
- en: If an attacker is able to find a flaw or vulnerability in any service running
    on the network system, they can compromise the entire system and its data as well
    as other systems on the network.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 如果攻击者能够发现网络系统上运行的任何服务的缺陷或漏洞，他们可以 compromise整个系统及其数据以及网络上的其他系统。
- en: Administrators should stay updated about any patches or updates that are available
    for any service or application running on the network system.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 管理员应该及时了解网络系统上运行的任何服务或应用程序的可用补丁或更新。
- en: Denial of Service (DoS) attack
  id: totrans-239
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 拒绝服务（DoS）攻击
- en: When an attacker sends unauthorized packets to the target system, which could
    be a server, router, or a workstation, in large numbers, it forces the resource
    to become unavailable to legitimate users.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 当攻击者向目标系统发送未经授权的数据包（可以是服务器、路由器或工作站），并且数量很大时，会导致资源对合法用户不可用。
- en: The packets being sent by the attacker are usually forged, making the investigation
    process difficult.
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者发送的数据包通常是伪造的，这使得调查过程变得困难。
