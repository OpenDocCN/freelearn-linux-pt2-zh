- en: Chapter 7. Disks and Partitioning
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第7章。磁盘和分区
- en: 'In this chapter we will cover the following topics:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下主题：
- en: Using `fdisk`
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`fdisk`
- en: Using `mkfs` to format a drive
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`mkfs`格式化驱动器
- en: Using `fsck` to check the filesystem
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`fsck`检查文件系统
- en: Logical Volume Management (LVM)
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 逻辑卷管理（LVM）
- en: Introduction
  id: totrans-6
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍
- en: When installing a machine, you can take the defaults or set up your disk(s)
    practically any way you want. Here is a brief review of partitions and filesystems.
    A typical Linux system usually has at least three separate partitions. They are
    labelled `/`, `/boot`, and `swap`. The `/` (pronounced *root*) is the parent of
    the directory structure. `/boot` is where the system kernel and map files reside.
    The `swap` partition is used when parts of memory need to be moved to the hard
    drive because of over-commitment. This is called being *swapped out* to disk.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 在安装机器时，您可以采用默认设置或根据需要设置磁盘。以下是对分区和文件系统的简要回顾。典型的Linux系统通常至少有三个单独的分区。它们被标记为`/`，`/boot`和`swap`。`/`（发音为*root*）是目录结构的父目录。`/boot`是系统内核和映射文件所在的地方。当内存的部分需要移动到硬盘上时，将使用`swap`分区。这被称为因过度承诺而将内存部分*交换出*到磁盘上。
- en: 'The following are usually on separate partitions:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 以下通常位于单独的分区上：
- en: '`/`: It is the parent directory'
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/`：它是父目录'
- en: '`/boot`: The boot and map files are located in here'
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/boot`：引导和映射文件位于此处'
- en: '`(swap)`: It signifies the swap space'
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: （交换）：它表示交换空间
- en: 'The following are traditionally on a separate partition, but do not have to
    be:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 以下传统上位于单独的分区上，但不一定要这样：
- en: '`/home`'
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/home`'
- en: '`/tmp`'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/tmp`'
- en: '`/etc`'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/etc`'
- en: '`/var`'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/var`'
- en: 'Here is a partial list of the filesystems and directories and their general
    use, that are normally present on a Linux system. This is taken from Fedora 17
    64-bit:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是Linux系统上通常存在的文件系统和目录及其一般用途的部分列表。这是来自Fedora 17 64位的信息：
- en: '`/`: It is the parent directory.'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/`：它是父目录。'
- en: '`/boot`: The boot, map files, and system kernel are present in it.'
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/boot`：引导、映射文件和系统内核都在其中。'
- en: '`(swap)`: It stands for the swap space.'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: （交换）：它代表交换空间。
- en: '`/root`: It is the home directory for the superuser.'
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/root`：这是超级用户的主目录。'
- en: '`/home`: The user directories go here (for example, `/home/guest1`, which has
    been used throughout this book).'
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/home`：用户目录放在这里（例如，`/home/guest1`，在本书中一直在使用）。'
- en: '`/tmp`: It is a directory that has the file deletion bit set. Temporary files
    can be placed here by users and various other programs. A `cron` job run by root
    cleans `/tmp` at periodic intervals (usually once a week).'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/tmp`：这是一个具有文件删除位设置的目录。用户和各种其他程序可以将临时文件放在这里。由root运行的`cron`作业会定期清理`/tmp`（通常一周一次）。'
- en: '`/usr`: It consists of the operating system''s (OS)’s parent user directory.'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/usr`：它包括操作系统（OS）的父用户目录。'
- en: '`/usr/bin`: It has the OS’s executable programs.'
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/usr/bin`：它包含操作系统的可执行程序。'
- en: '`/usr/etc`: It contains the OS’s configuration files.'
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/usr/etc`：它包含操作系统的配置文件。'
- en: '`/usr/games`: It consists of the games provided by the distribution.'
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/usr/games`：它包括发行版提供的游戏。'
- en: '`/usr/include`: It includes files for programming languages such as C.'
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/usr/include`：它包括用于编程语言如C的文件。'
- en: '`/usr/lib`: It contains the OS’s library files.'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/usr/lib`：它包含操作系统的库文件。'
- en: '`/usr/lib64`: It consists of the OS’s library files of 64 bit versions.'
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/usr/lib64`：它包括64位版本的操作系统库文件。'
- en: '`/usr/local`: The user programs can be placed here by the system admin for
    their use.'
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/usr/local`：系统管理员可以将用户程序放在这里供其使用。'
- en: '`/usr/sbin`: It has the OS’s executable programs used by the system.'
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/usr/sbin`：它包含系统使用的操作系统可执行程序。'
- en: '`/usr/share`: It includes the OS’s shared programs and files.'
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/usr/share`：它包括操作系统的共享程序和文件。'
- en: '`/usr/src`: The OS’s kernel source, include, and make files are placed here'
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/usr/src`：操作系统的内核源代码、包含和制作文件都放在这里'
- en: '`/dev`: It represents the device directory. For example, the `/dev/sda` device
    points to the first SCSI hard drive.'
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/dev`：它代表设备目录。例如，`/dev/sda`设备指向第一个SCSI硬盘。'
- en: '`/lib`: It is a symbolic link to `/usr/lib`.'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/lib`：它是指向`/usr/lib`的符号链接。'
- en: '`/lib64`: It is a symbolic link to `/usr/lib64`.'
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/lib64`：它是指向`/usr/lib64`的符号链接。'
- en: '`/mnt`: It is used as a mount point.'
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/mnt`：它用作挂载点。'
- en: '`/opt`: It represents the optional files.'
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/opt`：它代表可选文件。'
- en: '`/var/logs`: It consists of the OS’s logs.'
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/var/logs`：它包括操作系统的日志。'
- en: '`/var/spool`: It contains the printer files.'
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/var/spool`：它包含打印机文件。'
- en: '`/var/run`: The OS keeps data on running programs here.'
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/var/run`：操作系统在此处保存运行中的程序的数据。'
- en: '`/run`: It is the symbolic link to `/var/run`.'
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/run`：它是指向`/var/run`的符号链接。'
- en: '`lost+found`: It is where the OS keeps track of filesystem data.'
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`lost+found`：这是操作系统用来跟踪文件系统数据的地方。'
- en: '`/etc`: It is pronounced *etcetera* and stands for *everything else*. Configuration
    files tend to be located here.'
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/etc`：它的发音是*etcetera*，代表*其他所有东西*。配置文件通常位于此处。'
- en: 'The different types of virtual filesystems are as follows:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 不同类型的虚拟文件系统如下：
- en: '`/proc`: The OS keeps track of processes here. See the previous chapter for
    more information.'
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/proc`：操作系统在此处跟踪进程。有关更多信息，请参阅上一章。'
- en: '`/sys`: The OS keeps track of other processes in this directory.'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/sys`：操作系统在此目录中跟踪其他进程。'
- en: 'Some other useful terms have been defined in the following list:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是以下列表中定义的一些其他有用术语：
- en: '**device**: It refers to the entire disk. For example, the first SCSI disk
    is normally named `/dev/sda`.'
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**设备**：它指的是整个磁盘。例如，第一个SCSI磁盘通常被命名为`/dev/sda`。'
- en: '**partition**: It is the device name followed by a number. The first SCSI partition
    would be `/dev/sda1`.'
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**分区**：它是设备名称后跟一个数字。第一个SCSI分区将是`/dev/sda1`。'
- en: '**filesystem**: It defines the type of filesystem being used. Some examples
    are `ext2`, `ext3`, `ext4`, `vfat`, and `xfs`.'
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文件系统**：它定义了正在使用的文件系统类型。一些示例是`ext2`，`ext3`，`ext4`，`vfat`和`xfs`。'
- en: '**mount point**: It is the directory that points to the partition. The `/etc/fstab`
    file contains a table showing mount points and the partitions they are associated
    with. This file, which is created by a system installer such an Anaconda, can
    be manually edited by the superuser to add or delete devices and mounts.'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**挂载点**：它是指向分区的目录。`/etc/fstab`文件包含一个表，显示挂载点和它们关联的分区。这个文件是由系统安装程序（如Anaconda）创建的，可以由超级用户手动编辑以添加或删除设备和挂载。'
- en: 'The boot partition is where the operating system kernel and other startup files
    are located. Here is a description of the files found in `/boot`:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 引导分区是操作系统内核和其他启动文件所在的位置。以下是在`/boot`中找到的文件的描述：
- en: '`vmlinuz`: It represents a symbolic link to the kernel. For example, it points
    to `vmlinuz-2.6.35.6-45.fc14.x86_64` on Fedora 14.'
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`vmlinuz`：它代表内核的符号链接。例如，在Fedora 14上，它指向`vmlinuz-2.6.35.6-45.fc14.x86_64`。'
- en: '`initramfs`: It represents the initial RAM disk. On Fedora 14, it is named
    as `initramfs-2.6.35.6-45.fc14.x86_64.img`.'
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`initramfs`：它代表初始RAM磁盘。在Fedora 14上，它被命名为`initramfs-2.6.35.6-45.fc14.x86_64.img`。'
- en: '`config`: This file is used to configure the kernel. We will see more on that
    in [Chapter 10](ch10.html "Chapter 10. The Kernel"), *The Kernel*. On Fedora 14,
    it is named as `config-2.6.35.6-45.fc14.x86_64`.'
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`config`：此文件用于配置内核。我们将在[第10章](ch10.html "第10章。内核")*内核*中看到更多内容。在Fedora 14上，它被命名为`config-2.6.35.6-45.fc14.x86_64`。'
- en: '`map`: This is the system map file, which contains entry points into the various
    kernel routines. On Fedora 14, it is named as `System.map-2.6.35.6-45.fc14.x86_64`.'
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`map`：这是系统映射文件，其中包含对各种内核例程的入口点。在Fedora 14上，它被命名为`System.map-2.6.35.6-45.fc14.x86_64`。'
- en: The initial RAM disk needs a bit more explanation. This file contains all the
    device drivers needed to get the kernel loaded and running. For example, the kernel
    needs to access the hard drive in order to boot up. If it needs a special driver
    for this (that is, if it can’t be accessed by the BIOS alone), it must be located
    in the `initramfs` file or else it will not be able to complete the process. The
    `initramfs` file is created during system install, and can be modified by an experienced
    person. This is normally done when testing and/or using a new hardware. This is
    a compressed `GZIP` file that is uncompressed and placed on a ram(in memory) disk
    during boot up.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 初始RAM磁盘需要更多解释。该文件包含加载和运行内核所需的所有设备驱动程序。例如，内核需要访问硬盘才能启动。如果它需要特殊驱动程序（即，如果仅靠BIOS无法访问），则必须位于`initramfs`文件中，否则将无法完成该过程。`initramfs`文件是在系统安装期间创建的，并且可以由经验丰富的人修改。这通常在测试和/或使用新硬件时完成。这是一个压缩的`GZIP`文件，在启动时会被解压并放置在RAM（内存）磁盘上。
- en: 'The following is a snapshot of `/boot` and the file command on my Fedora 17
    system:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是我Fedora 17系统上`/boot`和文件命令的快照：
- en: '![Introduction](img/3008OS_07_01.jpg)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![介绍](img/3008OS_07_01.jpg)'
- en: 'The `df` program is used to report the filesystem disk space usage statistics.
    The following output is a `df -h` listing from my Fedora 14 system. The `-h` parameter
    puts the output into a more human readable form (useful on large disks):'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: '`df`程序用于报告文件系统磁盘空间使用统计信息。以下输出是我Fedora 14系统上的`df -h`列表。`-h`参数将输出放入更易读的形式（在大型磁盘上很有用）：'
- en: '[PRE0]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: The first column shows the partition of the filesystem. The second shows the
    size of the partition. The third is the amount used followed by the amount still
    available. The `Use%` is the percentage used, and the last column is the mount
    point.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 第一列显示文件系统的分区。第二列显示分区的大小。第三列是已使用的量，后面是仍可用的量。`Use%`是使用的百分比，最后一列是挂载点。
- en: This output tells you a lot about how I set up this system. I did not make separate
    partitions for `/home`, `/tmp`, `/etc`, or `/var`. They are all in the same partition
    under `/`. I have the required `/boot` partition which I made larger than the
    default since I frequently build new kernels. There is a separate `/data` and
    `/lewis` partition. All the mentioned partitions are on the `/dev/sda` device.
    So what device and partitions are `/dev/sdf1` and `/dev/sdg1`? The first is an
    Iomega external USB drive and the second is an 8 GB **Universal Serial Bus** (**USB**)
    stick. These are used for backups, just in case the primary drive goes out.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 此输出告诉您有关我如何设置此系统的许多信息。我没有为`/home`、`/tmp`、`/etc`或`/var`创建单独的分区。它们都在`/`下的同一分区中。我有所需的`/boot`分区，我将其大小设置得比默认值大，因为我经常构建新内核。还有一个单独的`/data`和`/lewis`分区。所有提到的分区都在`/dev/sda`设备上。那么`/dev/sdf1`和`/dev/sdg1`是什么设备和分区？第一个是Iomega外部USB驱动器，第二个是8GB的**通用串行总线**（**USB**）存储设备。这些用于备份，以防主要驱动器出现故障。
- en: The `fsck` program is used to check and optionally repair damaged filesystems.
    It can check multiple filesystems in parallel to speed up processing. If no parameters
    are given, `fsck` defaults to checking the filesystems in the `/etc/fstab` file.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: '`fsck`程序用于检查和可选修复损坏的文件系统。它可以并行检查多个文件系统以加快处理速度。如果未给出参数，则`fsck`默认为检查`/etc/fstab`文件中的文件系统。'
- en: When using partitions, you must keep in mind where a directory is mounted on.
    For example, suppose the space on `/` is getting tight and so you decide to delete
    some big files that are located in the `/tmp` directory. You need to first make
    sure that `/tmp` is indeed mounted on `/`, and not on its own partition. It is
    easy to make this mistake, so keep it in mind. This is even more of an issue if
    you are the system administrator for a lot of machines that are not all set up
    the same way.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 在使用分区时，必须记住目录挂载在哪里。例如，假设`/`上的空间变得紧张，因此您决定删除位于`/tmp`目录中的一些大文件。您首先需要确保`/tmp`确实挂载在`/`上，而不是在自己的分区上。很容易犯这个错误，所以要记住。如果您是许多设置不同的机器的系统管理员，这将更加成问题。
- en: Using fdisk
  id: totrans-68
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用fdisk
- en: The `fdisk` program is used to manipulate the disk partition table. You can
    create, modify, and remove partitions with this utility.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: '`fdisk`程序用于操作磁盘分区表。您可以使用此实用程序创建、修改和删除分区。'
- en: Getting ready
  id: totrans-70
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 做好准备
- en: You may follow along with these commands as long as you do not use the write
    table to disk action. However, just to be safe you may want to use a USB stick,
    or some other drive or system you don’t care about.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 只要不使用写入磁盘的操作，您可以按照这些命令进行操作。但是，为了安全起见，您可能希望使用USB存储设备或其他您不在乎的驱动器或系统。
- en: The syntax for the interactive version of `fdisk` is `fdisk <device-name>`.
    I will be using a 4GB USB stick, `/dev/sdb` for this example. Remember that `fdisk`
    works with the entire device, so you do not use a partition number when starting
    the command. We will perform these actions as root.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 交互式版本的`fdisk`的语法是`fdisk <device-name>`。我将使用一个4GB的USB存储设备，`/dev/sdb`作为这个例子。请记住，`fdisk`适用于整个设备，因此在启动命令时不使用分区号。我们将以root用户身份执行这些操作。
- en: 'The following is a screenshot showing `fdisk` on Fedora 18:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是Fedora 18上`fdisk`的屏幕截图：
- en: '![Getting ready](img/3008OS_07_02.jpg)'
  id: totrans-74
  prefs: []
  type: TYPE_IMG
  zh: '![准备就绪](img/3008OS_07_02.jpg)'
- en: How to do it...
  id: totrans-75
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Carry out the following steps for running `fdisk`:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤来运行`fdisk`：
- en: 'Start the command by running `fdisk` on the device:'
  id: totrans-77
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过在设备上运行`fdisk`来启动命令：
- en: '[PRE1]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'To display the Help menu: `enter an m`. It brings up the list of actions that
    can be performed on this device.'
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 显示帮助菜单：`输入an m`。它会显示可以在此设备上执行的操作列表。
- en: 'To display the partition table: `enter a p`. A list of the partitions on this
    device will be displayed.'
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 显示分区表：`输入a p`。将显示此设备上的分区列表。
- en: 'In the case of my USB stick, there is only one partition. So let’s delete it:'
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在我的USB存储设备的情况下，只有一个分区。所以让我们删除它：
- en: '[PRE2]'
  id: totrans-82
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Since there was only one partition, it was deleted by default. Now let’s add
    one:'
  id: totrans-83
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 由于只有一个分区，默认情况下已删除。现在让我们添加一个：
- en: '[PRE3]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Since this is the first partition, `press a p` for Primary.
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 由于这是第一个分区，按`a p`键选择主分区。
- en: Now run `enter a 1` and take the default starting sector.
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在运行`输入a 1`并采用默认的起始扇区。
- en: 'We now have to enter a size. This can be done by the sector number or size.
    Let’s use size and make it 1 GB:'
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在我们必须输入一个大小。这可以通过扇区号或大小来完成。让我们使用大小，将其设置为1GB：
- en: '[PRE4]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Run `enter a p` again to see what we have. You should see something like the
    following output:'
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 再次运行`输入a p`以查看我们有什么。您应该看到类似以下输出：
- en: '[PRE5]'
  id: totrans-90
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'This looks good. Now let’s add another one and then take the defaults:'
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 看起来不错。现在让我们添加另一个，然后采用默认设置：
- en: '[PRE6]'
  id: totrans-92
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'For size, let’s use 2 GB this time:'
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这次让我们使用2GB的大小：
- en: '[PRE7]'
  id: totrans-94
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'To see what it looks like:'
  id: totrans-95
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 查看它的样子：
- en: '[PRE8]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: The table should now show two partitions. At this point, you could continue
    to make more partitions, or save the table. You can always make more partitions
    later if you have the required disk space.
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在表格应该显示两个分区。在这一点上，您可以继续创建更多分区，或者保存表格。如果您有所需的磁盘空间，随时可以稍后创建更多分区。
- en: 'For this example, we will quit without saving the changes:'
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在这个例子中，我们将不保存更改而退出：
- en: '[PRE9]'
  id: totrans-99
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: To make sure nothing went wrong, run `fdisk /dev/sdb -l` to get a listing. It
    should show the same as when we started.
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了确保没有出错，运行`fdisk /dev/sdb -l`来获取列表。它应该显示与我们开始时相同的内容。
- en: There’s more...
  id: totrans-101
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: You may have noticed some other actions available on the `fdisk` help screen.
    You can change the way the units are displayed, list the known partition types,
    and a few other things. For more information, consult the `fdisk man` page.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 您可能已经注意到`fdisk`帮助屏幕上提供了其他一些操作。您可以更改显示单位的方式，列出已知的分区类型，以及其他一些内容。有关更多信息，请参阅`fdisk
    man`页面。
- en: Using mkfs to format a drive
  id: totrans-103
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用mkfs格式化驱动器
- en: 'The `mkfs` command builds a filesystem on the device (similar to formatting
    a drive). It determines the filesystem type and calls the appropriate `mkfs.<type>`
    program. For example, if you were to run `mkfs -t ext4 /dev/sdb5`, it would actually
    run the `mkfs.ext4` program. The `mkfs` options are as follows:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: '`mkfs`命令在设备上构建文件系统（类似于格式化驱动器）。它确定文件系统类型并调用适当的`mkfs.<type>`程序。例如，如果您要运行`mkfs
    -t ext4 /dev/sdb5`，它实际上会运行`mkfs.ext4`程序。`mkfs`选项如下：'
- en: '`-t`: It specifies the type of filesystem desired'
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-t`：指定所需的文件系统类型'
- en: '`-V`: It produces verbose output'
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-V`：生成详细输出'
- en: '`-V`: It displays version information if used as the only parameter'
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-V`：如果作为唯一参数使用，它会显示版本信息'
- en: '`-h`: It displays a help screen'
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-h`：显示帮助屏幕'
- en: Note that no other parameters are passed to the filesystem’s specific program.
    Also note that in some cases, a size value needs to be provided.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，没有传递其他参数给文件系统的特定程序。还要注意，在某些情况下，需要提供大小值。
- en: Getting ready
  id: totrans-110
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备就绪
- en: The `mkfs` program will destroy any data currently residing in the partition.
    So, make sure you have taken the desired backups before proceeding with this command.
    Once this action has been taken, it cannot be reversed. If you would like to follow
    these steps, you should first practice on a USB stick or some other device you
    don’t care about.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: '`mkfs`程序将销毁当前驻留在分区中的任何数据。因此，在继续此命令之前，请确保已备份所需的数据。一旦执行了此操作，就无法撤消。如果您想按照这些步骤操作，您应该先在一个您不在乎的USB存储设备或其他设备上练习。'
- en: Be sure to unmount the partition before proceeding.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 在继续之前，请确保卸载分区。
- en: How to do it...
  id: totrans-113
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'Carry out the following steps for formatting a partition in Linux:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤来在Linux中格式化分区：
- en: 'For this example, I have inserted a USB stick (one I don’t care about). To
    make sure we have the correct device, run `dmesg` and look at the last line:'
  id: totrans-115
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在这个例子中，我插入了一个USB存储设备（我不在乎的一个）。为了确保我们有正确的设备，请运行`dmesg`并查看最后一行：
- en: '[PRE10]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'On my system, it shows the device is `/dev/sdh1` (substitute your device accordingly).
    It did not mount it, so I am ready to proceed. However, if yours is auto-mounted,
    you should be able to unmount it by running:'
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在我的系统上，它显示设备是`/dev/sdh1`（根据您的设备进行替换）。它没有挂载，所以我准备好继续。但是，如果您的设备是自动挂载的，您应该能够通过运行以下命令卸载它：
- en: '[PRE11]'
  id: totrans-118
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Note that the following command will destroy any data on this device. So, be
    sure you have backed up anything that want to keep before proceeding!
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 请注意，以下命令将销毁设备上的任何数据。因此，在继续之前，请确保已备份要保留的任何数据！
- en: 'Run the command `mkfs -V -t vfat /dev/sdh1`. The following output is shown
    on my system:'
  id: totrans-120
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行命令`mkfs -V -t vfat /dev/sdh1`。我的系统上显示以下输出：
- en: '[PRE12]'
  id: totrans-121
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Now mount the device: `mount /dev/sdh1 /usb2` (substitute your device and mount
    point as you feel appropriate).'
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在挂载设备：`mount /dev/sdh1 /usb2`（根据需要替换您的设备和挂载点）。
- en: 'Run `ls -la /usb2`. It should look something like the following output:'
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行`ls -la /usb2`。它应该看起来像以下输出：
- en: '[PRE13]'
  id: totrans-124
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: That’s pretty much it for `mkfs`. Just be very careful when using this command
    and double check everything first before proceeding.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 这基本上就是`mkfs`的全部内容。在使用此命令时要非常小心，并在继续之前仔细检查一切。
- en: Using fsck to check the filesystem
  id: totrans-126
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用fsck检查文件系统
- en: In order to check and repair a Linux filesystem, the `fsck` program is used.
    In reality, `fsck` is just a frontend for the filesystem specific checker (similar
    to `mkfs`).
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 为了检查和修复Linux文件系统，使用`fsck`程序。实际上，`fsck`只是文件系统特定检查器的前端（类似于`mkfs`）。
- en: The `fsck` program can be run on different filesystems in parallel to speed
    up processing. Note that this feature can be disabled on low resource machines.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: '`fsck`程序可以并行运行在不同的文件系统上以加快处理速度。请注意，此功能可以在资源较低的机器上禁用。'
- en: 'In general, the syntax for `fsck` is as follows:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 一般来说，`fsck`的语法如下：
- en: '[PRE14]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Getting ready
  id: totrans-131
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: The `fsck` program if used incorrectly, can corrupt the data currently residing
    on the partition. So make sure you have taken all the desired backups before proceeding
    with this command. Once this action has been taken, it cannot be reversed. If
    you would like to follow these steps, you may first want to practice on a USB
    stick you don’t care about.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 如果不正确使用`fsck`程序，可能会损坏当前驻留在分区上的数据。因此，在执行此命令之前，请确保已经备份了所有所需的数据。一旦执行了此操作，就无法撤销。如果您想要按照这些步骤操作，可以先在一个您不在乎的USB存储设备上练习。
- en: The device must be unmounted before running the command.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 在运行命令之前，设备必须被卸载。
- en: How to do it...
  id: totrans-134
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Carry out the following steps to check and run a partition:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤来检查和运行分区：
- en: 'For this example, I have inserted a USB stick (one I don’t really care about).
    To make sure we have the correct device, run `dmesg` and look at the last line:'
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在此示例中，我插入了一个我不太在乎的USB存储设备。为了确保我们有正确的设备，请运行`dmesg`并查看最后一行：
- en: '[PRE15]'
  id: totrans-137
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: On my system, it shows the device is `/dev/sdh1` (substitute your device accordingly).
    It did not mount it, so I am ready to proceed. However, if yours is auto-mounted,
    you should be able to unmount it by running `umount /dev/sdh1`.
  id: totrans-138
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在我的系统上，它显示设备是`/dev/sdh1`（相应地替换您的设备）。它没有挂载，所以我准备好继续。但是，如果您的设备是自动挂载的，您应该能够通过运行`umount
    /dev/sdh1`来卸载它。
- en: 'We can now run the `fsck` program. I first want to see what actions it will
    take and so, will use the `-N` option. Run `fsck -N /dev/sdh1`. The following
    output is shown on my system:'
  id: totrans-139
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在我们可以运行`fsck`程序。我首先想看看它将采取什么行动，因此将使用`-N`选项。运行`fsck -N /dev/sdh1`。在我的系统上显示以下输出：
- en: '[PRE16]'
  id: totrans-140
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'This looks good, so let’s include a progress bar and run it for real: `fsck
    -C /dev/sdh1`. The following result is obtained on my system:'
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 看起来不错，所以让我们包括一个进度条并真正运行它：`fsck -C /dev/sdh1`。在我的系统上获得以下结果：
- en: '[PRE17]'
  id: totrans-142
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Since there were no problems on this USB stick, the output is not very exciting.
    I have seen some really bad errors in the past, and if this happens to you, I
    suggest getting the data off the drive as soon as possible, and then either reformatting
    the drive with `mkfs` or getting a new one just to be safe.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 由于这个USB存储设备没有问题，输出并不是很令人兴奋。我过去曾看到一些非常严重的错误，如果这种情况发生在您身上，我建议尽快将数据从驱动器上取出，然后使用`mkfs`重新格式化驱动器，或者为了安全起见，获取一个新的驱动器。
- en: There’s more...
  id: totrans-144
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'The following is a brief list of the options for `fdisk` along with their functions:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是`fdisk`的简要选项列表以及它们的功能：
- en: '`-l`: It will lock the device before checking and can be used on only one device
    at a time.'
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-l`：它将在检查之前锁定设备，一次只能用于一个设备。'
- en: '`-s`: It will serialize the file checking operations. It is useful when checking
    more than one filesystem at a time in the interactive mode.'
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-s`：它将串行化文件检查操作。在交互模式下检查多个文件系统时很有用。'
- en: '`-A`: It uses the entries in the `/etc/fstab` file to go through and check
    all the filesystems in one run. Typically, the root filesystem is checked first
    and then the others based on the values of the `passno` value. See the `man` page
    of `fstab` for more information on the available options.'
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-A`：它使用`/etc/fstab`文件中的条目一次性检查所有文件系统。通常，首先检查根文件系统，然后根据`passno`值检查其他文件系统。有关可用选项的更多信息，请参阅`fstab`的`man`页面。'
- en: '`-C`: It will display a progress bar.'
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-C`：它将显示一个进度条。'
- en: '`-M`: It specifies not to check the mounted filesystems.'
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-M`：指定不检查已挂载的文件系统。'
- en: '`-N`: It will show what actions would be performed on this device but does
    not actually make them'
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-N`：它将显示将在此设备上执行的操作，但实际上不会执行。'
- en: '`-P`: It will check the root filesystem in parallel with the other systems.
    Don’t ever use this option.'
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-P`：它将并行检查根文件系统和其他系统。绝对不要使用此选项。'
- en: '`-R`: It will skip the root filesystem while checking the others.'
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-R`：它将在检查其他系统时跳过根文件系统。'
- en: '`-V`: It will enable verbose output and so its usage is recommended.'
  id: totrans-154
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-V`：它将启用详细输出，因此建议使用。'
- en: 'The following is a list of options usually supported by the filesystem specific
    program:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是通常由特定文件系统程序支持的选项列表：
- en: '`-a`: It will automatically repair the filesystem without any questions. Be
    very careful with this option as I have seen it go horribly wrong on more than
    one occasion.'
  id: totrans-156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-a`：它将自动修复文件系统，无需任何问题。请非常小心使用此选项，因为我曾在多次情况下看到它出现严重错误。'
- en: '`-n`: This option is supposed to tell the specific checker to not perform any
    repairs. It is unreliable and so not recommended.'
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-n`：此选项应告诉特定的检查器不执行任何修复。它不可靠，因此不建议使用。'
- en: '`-r`: It will repair the filesystem interactively. Do not use this option if
    running `fsck` in parallel.'
  id: totrans-158
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-r`：它将以交互方式修复文件系统。如果并行运行`fsck`，不要使用此选项。'
- en: '`-y`: It tells some specific checkers to make repairs automatically.'
  id: totrans-159
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-y`：它告诉某些特定的检查器自动进行修复。'
- en: In theory, a journaling filesystem, such as `ext3` or `ext4`, should not need
    a lot of checking or repair. If this is not the case on your system, I would suspect
    the hardware or maybe the hardware CMOS levels. Make sure everything in your system
    is flashed to the proper version.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 理论上，像`ext3`或`ext4`这样的日志文件系统不应需要大量的检查或修复。如果在您的系统上不是这种情况，我会怀疑是硬件或者硬件CMOS级别的问题。确保系统中的所有内容都刷新到正确的版本。
- en: Note
  id: totrans-161
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: In order to repair a filesystem, it must not be mounted. Also, checking a mounted
    filesystem may give bogus error messages sometimes.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 为了修复文件系统，它必须没有挂载。此外，检查已挂载的文件系统有时可能会产生虚假的错误消息。
- en: Logical Volume Management (LVM)
  id: totrans-163
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 逻辑卷管理（LVM）
- en: LVM for Linux allows one to manage disks or arrays of disks as one large pool
    of storage. An LVM consists of one or more physical volumes along with one or
    more logical volumes.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: Linux的LVM允许将磁盘或磁盘阵列管理为一个大的存储池。一个LVM由一个或多个物理卷以及一个或多个逻辑卷组成。
- en: Directories such as `/root` and `/home` for example, are located in a logical
    volume. Several commands exist to manage the LVM. Some operate on physical volumes,
    some operate on logical volumes, and some on both.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，`/root`和`/home`等目录位于一个逻辑卷中。有一些命令用于管理LVM。有些操作在物理卷上进行，有些在逻辑卷上进行，有些在两者上都进行。
- en: 'The following list can be used as a quick reference guide for the LVM commands:'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 以下列表可用作LVM命令的快速参考指南：
- en: '`pvcreate`: It initializes a disk or partition'
  id: totrans-167
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pvcreate`：它初始化磁盘或分区'
- en: '`pvchange`: It changes the allocation permissions of one or more physical volumes'
  id: totrans-168
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pvchange`：它改变一个或多个物理卷的分配权限'
- en: '`pvck`: It checks the physical volume metadata'
  id: totrans-169
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pvck`：它检查物理卷的元数据'
- en: '`pvdisplay`: It displays the attributes of a physical volume'
  id: totrans-170
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pvdisplay`：它显示物理卷的属性'
- en: '`pvmove`: It moves physical extents'
  id: totrans-171
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pvmove`：它移动物理区段'
- en: '`pvremove`: It removes a physical volume'
  id: totrans-172
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pvremove`：它移除一个物理卷'
- en: '`pvresize`: It resizes a disk or partition'
  id: totrans-173
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pvresize`：它调整磁盘或分区的大小'
- en: '`pvs`: It reports information about physical volumes'
  id: totrans-174
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pvs`：它报告有关物理卷的信息'
- en: '`pvscan`: It scans all the disks for physical volumes'
  id: totrans-175
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pvscan`：它扫描所有磁盘以查找物理卷'
- en: '`vgcfgbackup`: It backs up the volume group descriptor area'
  id: totrans-176
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`vgcfgbackup`：它备份卷组描述符区域'
- en: '`vgcfgrestore`: It restores the volume group descriptor area'
  id: totrans-177
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`vgcfgrestore`：它恢复卷组描述符区域'
- en: '`vgchange`: It changes attributes of a volume group'
  id: totrans-178
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`vgchange`：它改变卷组的属性'
- en: '`vgck`: It checks the volume group metadata'
  id: totrans-179
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`vgck`：它检查卷组的元数据'
- en: '`vgconvert`: It converts the volume group metadata format'
  id: totrans-180
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`vgconvert`：它转换卷组的元数据格式'
- en: '`vgcreate`: It creates a volume group'
  id: totrans-181
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`vgcreate`：它创建一个卷组'
- en: '`vgdisplay`: It displays the attributes of volume groups'
  id: totrans-182
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`vgdisplay`：它显示卷组的属性'
- en: '`vgexport`: It makes volume groups unknown to the system'
  id: totrans-183
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`vgexport`：它使卷组对系统不可见'
- en: '`vgextend`: It adds physical volumes to a volume group'
  id: totrans-184
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`vgextend`：它向卷组添加物理卷'
- en: '`vgimport`: It makes exported volume groups known to the system'
  id: totrans-185
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`vgimport`：它使导出的卷组对系统可见'
- en: '`vgimportclone`: It imports and renames a duplicated volume group'
  id: totrans-186
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`vgimportclone`：它导入并重命名重复的卷组'
- en: '`vgmerge`: It merges two volume groups'
  id: totrans-187
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`vgmerge`：它合并两个卷组'
- en: '`vgmknodes`: It recreates a volume group directory and logical volume special
    files'
  id: totrans-188
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`vgmknodes`：它重新创建卷组目录和逻辑卷特殊文件'
- en: '`vgreduce`: It removes the unused physical volumes from a volume group'
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`vgreduce`：它从卷组中删除未使用的物理卷'
- en: '`vgremove`: It removes a volume group'
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`vgremove`：它移除一个卷组'
- en: '`vgrename`: It renames a volume group'
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`vgrename`：它重命名一个卷组'
- en: '`vgs`: It reports information about volume groups'
  id: totrans-192
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`vgs`：它报告有关卷组的信息'
- en: '`vgscan`: It scans all the disks for volume groups and rebuilds caches'
  id: totrans-193
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`vgscan`：它扫描所有磁盘以查找卷组并重建缓存'
- en: '`vgsplit`: It splits a volume group into two'
  id: totrans-194
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`vgsplit`：它将卷组分割成两个'
- en: '`lvchange`: It changes the attributes of a logical volume'
  id: totrans-195
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`lvchange`：它改变逻辑卷的属性'
- en: '`lvconvert`: It converts a logical volume from linear to mirror or snapshot'
  id: totrans-196
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`lvconvert`：它将逻辑卷从线性转换为镜像或快照'
- en: '`lvcreate`: It creates a logical volume in an existing volume group'
  id: totrans-197
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`lvcreate`：它在现有卷组中创建逻辑卷'
- en: '`lvdisplay`: It displays the attributes of a logical volume'
  id: totrans-198
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`lvdisplay`：它显示逻辑卷的属性'
- en: '`lvextend`: It extends the size of a logical volume'
  id: totrans-199
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`lvextend`：它扩展逻辑卷的大小'
- en: '`lvmdiskscan`: It scans for all the devices visible to lvm2'
  id: totrans-200
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`lvmdiskscan`：它扫描所有对lvm2可见的设备'
- en: '`lvmdump`: It creates lvm2 information dumps for diagnostic purposes'
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`lvmdump`：它为诊断目的创建lvm2信息转储'
- en: '`lvreduce`: It reduces the size of a logical volume'
  id: totrans-202
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`lvreduce`：它减小逻辑卷的大小'
- en: '`lvremove`: It removes a logical volume'
  id: totrans-203
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`lvremove`：它移除一个逻辑卷'
- en: '`lvrename`: It renames a logical volume'
  id: totrans-204
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`lvrename`：它重命名逻辑卷'
- en: '`lvresize`: It resizes a logical volume'
  id: totrans-205
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`lvresize`：它调整逻辑卷的大小'
- en: '`lvs`: It reports information about logical volumes'
  id: totrans-206
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`lvs`：它报告有关逻辑卷的信息'
- en: '`lvscan`: It scans all the disks for logical volumes'
  id: totrans-207
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`lvscan`：它扫描所有磁盘以查找逻辑卷'
- en: Getting ready
  id: totrans-208
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: The following commands assume that you are running an LVM-aware system. Note
    that you do not need to actually have your drive in an LVM format in order to
    try the commands.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 以下命令假定您正在运行一个了解LVM的系统。请注意，您不需要实际上将驱动器格式化为LVM格式才能尝试这些命令。
- en: How to do it...
  id: totrans-210
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'The following are some non-destructive commands you can try on your system
    (you will need to be in root to run these):'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是您可以在系统上尝试的一些非破坏性命令（您需要以root用户身份运行这些命令）：
- en: 'Let’s see all the physical volumes on the system:'
  id: totrans-212
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们看看系统上的所有物理卷：
- en: '[PRE18]'
  id: totrans-213
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'Now let’s scan the disks:'
  id: totrans-214
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在让我们扫描磁盘：
- en: '[PRE19]'
  id: totrans-215
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'Then, display the attributes of the volume groups:'
  id: totrans-216
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，显示卷组的属性：
- en: '[PRE20]'
  id: totrans-217
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'We report information about volume groups:'
  id: totrans-218
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们报告有关卷组的信息：
- en: '[PRE21]'
  id: totrans-219
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'The disks for all the volume groups are then scanned:'
  id: totrans-220
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后扫描所有卷组的磁盘：
- en: '[PRE22]'
  id: totrans-221
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Then the attributes for the logical volume (this one gets used a lot) need
    to be displayed:'
  id: totrans-222
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后需要显示逻辑卷的属性（这个经常使用）：
- en: '[PRE23]'
  id: totrans-223
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'Scan for all the devices visible to LVM:'
  id: totrans-224
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 扫描所有对LVM可见的设备：
- en: '[PRE24]'
  id: totrans-225
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'Report information about the logical volumes:'
  id: totrans-226
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 报告有关逻辑卷的信息：
- en: '[PRE25]'
  id: totrans-227
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'Scan all the disks for logical volumes:'
  id: totrans-228
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 扫描所有磁盘以查找逻辑卷：
- en: '[PRE26]'
  id: totrans-229
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'The following is a screenshot of `pvdisplay` and `vgdisplay` on my Fedora 14
    system:'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是我在我的Fedora 14系统上的`pvdisplay`和`vgdisplay`的屏幕截图：
- en: '![How to do it...](img/3008OS_07_03.jpg)'
  id: totrans-231
  prefs: []
  type: TYPE_IMG
  zh: '![如何做...](img/3008OS_07_03.jpg)'
- en: There’s more...
  id: totrans-232
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: If you are accustomed to the traditional method of configuring disk drives,
    LVM can take a while to get used to. I have found the man pages to be pretty good
    in this area, and the Internet has some good articles on it as well.
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您习惯于传统的磁盘驱动器配置方法，LVM可能需要一段时间才能习惯。我发现man页面在这方面非常好，互联网上也有一些很好的文章。
- en: Understanding different filesystems
  id: totrans-234
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 了解不同的文件系统
- en: 'At the time of writing this, there are over 60 different filesystems available
    for Linux. The following is a brief overview of the common ones you may frequently
    encounter:'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 在撰写本文时，Linux上有60多种不同的文件系统可用。以下是您可能经常遇到的常见文件系统的简要概述：
- en: '`Btrfs`: B-tree filesystem is a copy-on-write filesystem developed by Oracle
    in 2007\. It is still in the developmental stage and considered experimental.
    The intention of `Btrfs` is to allow the filesystem to scale as drives get larger
    and larger. Because of its benefits, it is being considered as the filesystem
    to replace `ext4`.'
  id: totrans-236
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Btrfs`：B树文件系统是由Oracle于2007年开发的写时复制文件系统。它仍处于开发阶段，被认为是实验性的。`Btrfs`的意图是允许文件系统随着驱动器变得越来越大而扩展。由于其优势，它被认为是取代`ext4`的文件系统。'
- en: '`ext2`: It was introduced in 1993\. This filesystem does not have journaling
    and hence, has fewer writes per cycle, making it a good choice for flash drives.'
  id: totrans-237
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ext2`：它是在1993年引入的。这个文件系统没有日志记录，因此每个周期的写入较少，使其成为闪存驱动器的良好选择。'
- en: '`ext3`: It is very similar to `ext2` with the addition of journaling, which
    improves reliability, especially after an unclean shutdown.'
  id: totrans-238
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ext3`：它与`ext2`非常相似，但增加了日志记录，这提高了可靠性，特别是在非正常关闭后。'
- en: '`ext4`: Being released in 2008, it is considered the successor of `ext3`. It
    can handle volumes up to 1 exbibyte and files up to 16 tebibytes. This filesystem
    uses extents to replace the traditional block mapping scheme used by earlier versions
    of ext. It has enhancements allowing for faster filesystem checks (`fsck`).'
  id: totrans-239
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ext4`：发布于2008年，被认为是`ext3`的后继者。它可以处理高达1 exbibyte的卷和高达16 tebibytes的文件。这个文件系统使用范围来替代早期版本的ext使用的传统块映射方案。它具有增强功能，可以加快文件系统检查（`fsck`）的速度。'
- en: '`FAT`: This is the abbreviation of File Allocation Table and the format was
    originally used by DOS, OS/2, and Windows. It is available in the kernel mainly
    to provide support for external devices such as USB flash drives.'
  id: totrans-240
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`FAT`：这是文件分配表的缩写，最初由DOS、OS/2和Windows使用。它主要在内核中提供对外部设备（如USB闪存驱动器）的支持。'
- en: '`ReiserFS` (or `Reiser3`): It is a general purpose filesystem with journaling,
    originally designed and written by Hans Reiser. When it was created, it contained
    many features that were not yet available at the time including journaling, online
    growth, and a scheme to limit internal fragmentation.'
  id: totrans-241
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ReiserFS`（或`Reiser3`）：这是一个带有日志记录的通用文件系统，最初由Hans Reiser设计和编写。当它被创建时，它包含了当时尚未可用的许多功能，包括日志记录、在线增长和限制内部碎片的方案。'
- en: '`Reiser4`: It is the successor of `ReiserFS` (due to the conviction of the
    designer Hans Reiser for murder, future development is uncertain).'
  id: totrans-242
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Reiser4`：这是`ReiserFS`的后继者（由于设计者Hans Reiser因谋杀罪被定罪，未来的发展是不确定的）。'
