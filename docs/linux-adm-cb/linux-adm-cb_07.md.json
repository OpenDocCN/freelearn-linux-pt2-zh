["```\n# -*- mode: ruby -*-\n# vi: set ft=ruby :\n\nVagrant.configure(\"2\") do |config|\n\n config.vm.define \"centos1\" do |centos1|\n centos1.vm.box = \"centos/7\"\n centos1.vm.box_version = \"1804.02\"\n centos1.vm.network \"private_network\", ip: \"192.168.33.10\"\n centos1.vm.hostname = \"centos1\"\n centos1.vm.provider \"virtualbox\" do |centos1p|\n centos1p.memory = 2048\n centos1p.cpus = 2\n end\n end\n\n config.vm.define \"centos2\" do |centos2|\n centos2.vm.box = \"centos/7\"\n centos2.vm.box_version = \"1804.02\"\n centos2.vm.network \"private_network\", ip: \"192.168.33.11\"\n centos2.vm.hostname = \"centos2\"\n end\n\n config.vm.define \"debian1\" do |debian1|\n debian1.vm.box = \"debian/stretch64\"\n debian1.vm.box_version = \"9.5.0\"\n debian1.vm.network \"private_network\", ip: \"192.168.33.12\"\n debian1.vm.hostname = \"debian1\"\n debian1.vm.provider \"virtualbox\" do |debian1p|\n debian1p.cpus = 1\n end\n end\n\n config.vm.define \"debian2\" do |debian2|\n debian2.vm.box = \"debian/stretch64\"\n debian2.vm.box_version = \"9.5.0\"\n debian2.vm.network \"private_network\", ip: \"192.168.33.13\"\n debian2.vm.hostname = \"debian2\"\n debian2.vm.provider \"virtualbox\" do |debian2p|\n debian2p.cpus = 1\n end\n end\n\nend\n```", "```\n$ vagrant ssh centos1\n```", "```\n$ cd /var/log\n$ ls -l\ntotal 156\ndrwxr-xr-x. 2 root   root      219 May 12 18:55 anaconda\ndrwx------. 2 root   root       23 Oct  9 16:55 audit\n-rw-------. 1 root   root        6 Oct  9 16:55 boot.log\n-rw-------. 1 root   utmp        0 May 12 18:51 btmp\ndrwxr-xr-x. 2 chrony chrony      6 Apr 12 17:37 chrony\n-rw-------. 1 root   root      807 Oct  9 17:01 cron\n-rw-r--r--. 1 root   root    28601 Oct  9 16:55 dmesg\n-rw-r--r--. 1 root   root      193 May 12 18:51 grubby_prune_debug\n-rw-r--r--. 1 root   root   292292 Oct  9 17:21 lastlog\n-rw-------. 1 root   root      198 Oct  9 16:55 maillog\n-rw-------. 1 root   root    91769 Oct  9 17:23 messages\ndrwxr-xr-x. 2 root   root        6 Aug  4  2017 qemu-ga\ndrwxr-xr-x. 2 root   root        6 May 12 18:55 rhsm\n-rw-------. 1 root   root     2925 Oct  9 17:21 secure\n-rw-------. 1 root   root        0 May 12 18:52 spooler\n-rw-------. 1 root   root        0 May 12 18:50 tallylog\ndrwxr-xr-x. 2 root   root       23 Oct  9 16:55 tuned\n-rw-rw-r--. 1 root   utmp     1920 Oct  9 17:21 wtmp\n```", "```\n$ sudo tail -10 messages\nDec 28 18:37:18 localhost nm-dispatcher: req:11 'connectivity-change': start running ordered scripts...\nDec 28 18:37:22 localhost systemd-logind: New session 3 of user vagrant.\nDec 28 18:37:22 localhost systemd: Started Session 3 of user vagrant.\nDec 28 18:37:22 localhost systemd: Starting Session 3 of user vagrant.\nDec 28 18:38:13 localhost chronyd[567]: Selected source 95.215.175.2\nDec 28 18:39:18 localhost chronyd[567]: Selected source 178.79.155.116\nDec 28 18:39:35 localhost systemd-logind: Removed session 2.\nDec 28 18:39:46 localhost systemd: Started Session 4 of user vagrant.\nDec 28 18:39:46 localhost systemd-logind: New session 4 of user vagrant.\nDec 28 18:39:46 localhost systemd: Starting Session 4 of user vagrant.\n```", "```\n$ sudo tail -5 secure\nDec 28 18:39:46 localhost sshd[3379]: Accepted publickey for vagrant from 10.0.2.2 port 44394 ssh2: RSA SHA256:7EOuFLwMurYJNPkZ3e+rZvez1FxmGD9ZNpEq6H+wmSA\nDec 28 18:39:46 localhost sshd[3379]: pam_unix(sshd:session): session opened for user vagrant by (uid=0)\nDec 28 18:39:55 localhost sudo: vagrant : TTY=pts/0 ; PWD=/var/log ; USER=root ; COMMAND=/bin/tail -10 messages\nDec 28 18:40:19 localhost sudo: vagrant : TTY=pts/0 ; PWD=/var/log ; USER=root ; COMMAND=/bin/tail -10 secure\nDec 28 18:40:37 localhost sudo: vagrant : TTY=pts/0 ; PWD=/var/log ; USER=root ; COMMAND=/bin/tail -5 secure\n```", "```\n$ sudo cat cron\nDec 28 18:36:57 localhost crond[612]: (CRON) INFO (RANDOM_DELAY will be scaled with factor 89% if used.)\nDec 28 18:36:58 localhost crond[612]: (CRON) INFO (running with inotify support)\n```", "```\n$ sudo grep \"vagrant.\" messages | cut -d\" \" -f 1,3,5\nDec 18:37:07 systemd:\nDec 18:37:07 systemd:\nDec 18:37:07 systemd:\nDec 18:37:07 systemd-logind:\nDec 18:37:07 systemd:\n```", "```\n$ sudo logrotate -f /etc/logrotate.conf\n$ ls -lh\ntotal 168K\ndrwxr-xr-x. 2 root root 219 May 12 18:55 anaconda\ndrwx------. 2 root root 23 Oct 9 16:55 audit\n-rw-------. 1 root root 0 Oct 9 17:35 boot.log\n-rw-------. 1 root root 6 Oct 9 17:35 boot.log-20181009\n-rw-------. 1 root utmp 0 Oct 9 17:35 btmp\n-rw-------. 1 root utmp 0 May 12 18:51 btmp-20181009\ndrwxr-xr-x. 2 chrony chrony 6 Apr 12 17:37 chrony\n-rw-------. 1 root root 0 Oct 9 17:35 cron\n-rw-------. 1 root root 807 Oct 9 17:01 cron-20181009\n-rw-r--r--. 1 root root 28K Oct 9 16:55 dmesg\n-rw-r--r--. 1 root root 193 May 12 18:51 grubby_prune_debug\n-rw-r--r--. 1 root root 286K Oct 9 17:28 lastlog\n-rw-------. 1 root root 0 Oct 9 17:35 maillog\n-rw-------. 1 root root 198 Oct 9 16:55 maillog-20181009\n-rw-------. 1 root root 145 Oct 9 17:35 messages\n-rw-------. 1 root root 90K Oct 9 17:28 messages-20181009\ndrwxr-xr-x. 2 root root 6 Aug 4 2017 qemu-ga\ndrwxr-xr-x. 2 root root 6 May 12 18:55 rhsm\n-rw-------. 1 root root 0 Oct 9 17:35 secure\n-rw-------. 1 root root 5.3K Oct 9 17:35 secure-20181009\n-rw-------. 1 root root 0 Oct 9 17:35 spooler\n-rw-------. 1 root root 0 May 12 18:52 spooler-20181009\n-rw-------. 1 root root 0 May 12 18:50 tallylog\ndrwxr-xr-x. 2 root root 23 Oct 9 16:55 tuned\n-rw-rw-r--. 1 root utmp 0 Oct 9 17:35 wtmp\n-rw-rw-r--. 1 root utmp 1.9K Oct 9 17:21 wtmp-20181009\n\n```", "```\n$ sudo cat messages\nDec 28 18:41:38 centos1 rsyslogd: [origin software=\"rsyslogd\" swVersion=\"8.24.0\" x-pid=\"898\" x-info=\"http://www.rsyslog.com\"] rsyslogd was HUPed\n```", "```\n#### RULES ####\n\n# Log all kernel messages to the console.\n# Logging much else clutters up the screen.\n#kern.*                                                 /dev/console\n\n# Log anything (except mail) of level info or higher.\n# Don't log private authentication messages!\n*.info;mail.none;authpriv.none;cron.none                /var/log/messages\n\n# The authpriv file has restricted access.\nauthpriv.*                                              /var/log/secure\n\n# Log all the mail messages in one place.\nmail.*                                                  -/var/log/maillog\n\n# Log cron stuff\ncron.*                                                  /var/log/cron\n\n# Everybody gets emergency messages\n*.emerg                                                 :omusrmsg:*\n\n# Save news errors of level crit and higher in a special file.\nuucp,news.crit                                          /var/log/spooler\n\n# Save boot messages also to boot.log\nlocal7.*                                                /var/log/boot.log\n```", "```\n$ logger \"So long, and thanks for all the fish.\" \n$ sudo tail -1 /var/log/messages\nOct 9 18:03:03 centos1 vagrant: So long, and thanks for all the fish.\n```", "```\n$ logger -p cron.err \"I'M A PARADOXICAL LOG MESSAGE.\"\n$ sudo tail -3 /var/log/cron\nOct  9 18:07:01 centos1 anacron[3373]: Job `cron.weekly' started\nOct  9 18:07:01 centos1 anacron[3373]: Job `cron.weekly' terminated\nOct  9 18:07:23 centos1 vagrant: I'M A PARADOXICAL LOG MESSAGE.\n```", "```\n$ cat <<HERE | sudo tee /etc/rsyslog.d/cronerr.conf\ncron.err                                                  /var/log/cron.err\nHERE\n```", "```\n$ sudo systemctl restart rsyslog\n$ logger -p cron.err \"I'M A PARADOXICAL LOG MESSAGE.\"\n$ sudo cat /var/log/cron.err \nOct  9 18:17:32 centos1 vagrant: I'M A PARADOXICAL LOG MESSAGE.\n```", "```\n$ cat /etc/logrotate.d/syslog \n/var/log/cron\n/var/log/maillog\n/var/log/messages\n/var/log/secure\n/var/log/spooler\n{\n missingok\n sharedscripts\n postrotate\n /bin/kill -HUP `cat /var/run/syslogd.pid 2> /dev/null` 2> /dev/null || true\n endscript\n}\n```", "```\n$ vagrant ssh centos1\n```", "```\n$ sudo journalctl\n```", "```\n$ sudo journalctl -f\n-- Logs begin at Tue 2018-10-09 18:43:07 UTC. --\nOct 10 17:07:03 centos1 chronyd[554]: System clock was stepped by 80625.148375 seconds\nOct 10 17:07:03 centos1 systemd[1]: Time has been changed\nOct 10 17:07:25 centos1 sshd[1106]: Accepted publickey for vagrant from 10.0.2.2 port 55300 ssh2: RSA SHA256:TTGYuhFa756sxR2rbliMhNqgbggAjFNERKg9htsdvSw\nOct 10 17:07:26 centos1 systemd[1]: Created slice User Slice of vagrant.\nOct 10 17:07:26 centos1 systemd[1]: Starting User Slice of vagrant.\nOct 10 17:07:26 centos1 systemd[1]: Started Session 1 of user vagrant.\nOct 10 17:07:26 centos1 systemd-logind[545]: New session 1 of user vagrant.\nOct 10 17:07:26 centos1 sshd[1106]: pam_unix(sshd:session): session opened for user vagrant by (uid=0)\nOct 10 17:07:26 centos1 systemd[1]: Starting Session 1 of user vagrant.\nOct 10 17:07:28 centos1 sudo[1131]:  vagrant : TTY=pts/0 ; PWD=/home/vagrant ; USER=root ; COMMAND=/bin/journalctl -f\n```", "```\n$ sudo journalctl -k --no-pager | head -n8\n-- Logs begin at Tue 2018-10-09 18:43:07 UTC, end at Wed 2018-10-10 17:09:08 UTC. --\nOct 09 18:43:07 localhost.localdomain kernel: Initializing cgroup subsys cpuset\nOct 09 18:43:07 localhost.localdomain kernel: Initializing cgroup subsys cpu\nOct 09 18:43:07 localhost.localdomain kernel: Initializing cgroup subsys cpuacct\nOct 09 18:43:07 localhost.localdomain kernel: Linux version 3.10.0-862.2.3.el7.x86_64 (builder@kbuilder.dev.centos.org) (gcc version 4.8.5 20150623 (Red Hat 4.8.5-28) (GCC) ) #1 SMP Wed May 9 18:05:47 UTC 2018\nOct 09 18:43:07 localhost.localdomain kernel: Command line: BOOT_IMAGE=/vmlinuz-3.10.0-862.2.3.el7.x86_64 root=/dev/mapper/VolGroup00-LogVol00 ro no_timer_check console=tty0 console=ttyS0,115200n8 net.ifnames=0 biosdevname=0 elevator=noop crashkernel=auto rd.lvm.lv=VolGroup00/LogVol00 rd.lvm.lv=VolGroup00/LogVol01 rhgb quiet\nOct 09 18:43:07 localhost.localdomain kernel: e820: BIOS-provided physical RAM map:\nOct 09 18:43:07 localhost.localdomain kernel: BIOS-e820: [mem 0x0000000000000000-0x000000000009fbff] usable\n```", "```\n$ sudo journalctl --since=17:07 --until=17:09\n-- Logs begin at Tue 2018-10-09 18:43:07 UTC, end at Wed 2018-10-10 17:12:51 UTC. --\nOct 09 18:43:18 centos1 chronyd[554]: Selected source 188.114.116.1\nOct 09 18:43:18 centos1 chronyd[554]: System clock wrong by 80625.148375 seconds, adjustment started\nOct 10 17:07:03 centos1 chronyd[554]: System clock was stepped by 80625.148375 seconds\nOct 10 17:07:03 centos1 systemd[1]: Time has been changed\nOct 10 17:07:25 centos1 sshd[1106]: Accepted publickey for vagrant from 10.0.2.2 port 55300 ssh2: RSA SHA256:TTGYuhFa756sxR2rbliMhNqgbggAjFNERKg9htsdvSw\nOct 10 17:07:26 centos1 systemd[1]: Created slice User Slice of vagrant.\nOct 10 17:07:26 centos1 systemd[1]: Starting User Slice of vagrant.\nOct 10 17:07:26 centos1 systemd[1]: Started Session 1 of user vagrant.\nOct 10 17:07:26 centos1 systemd-logind[545]: New session 1 of user vagrant.\nOct 10 17:07:26 centos1 sshd[1106]: pam_unix(sshd:session): session opened for user vagrant by (uid=0)\nOct 10 17:07:26 centos1 systemd[1]: Starting Session 1 of user vagrant.\nOct 10 17:07:28 centos1 sudo[1131]:  vagrant : TTY=pts/0 ; PWD=/home/vagrant ; USER=root ; COMMAND=/bin/journalctl -f\nOct 10 17:08:08 centos1 chronyd[554]: Selected source 194.80.204.184\nOct 10 17:08:41 centos1 sudo[1145]:  vagrant : TTY=pts/0 ; PWD=/home/vagrant ; USER=root ; COMMAND=/bin/journalctl -k\nOct 10 17:08:52 centos1 sudo[1148]:  vagrant : TTY=pts/0 ; PWD=/home/vagrant ; USER=root ; COMMAND=/bin/journalctl -k\n```", "```\n$ sudo journalctl -u chronyd\n-- Logs begin at Tue 2018-10-09 18:43:07 UTC, end at Wed 2018-10-10 17:18:58 UTC. --\nOct 09 18:43:09 centos1 systemd[1]: Starting NTP client/server...\nOct 09 18:43:09 centos1 chronyd[554]: chronyd version 3.2 starting (+CMDMON +NTP +REFCLOCK +RTC +PRIVDROP +SCFILTER +SECHASH +SIGND +ASYNCDNS +IPV6 +DEBUG)\nOct 09 18:43:09 centos1 chronyd[554]: Frequency -3.308 +/- 6.027 ppm read from /var/lib/chrony/drift\nOct 09 18:43:09 centos1 systemd[1]: Started NTP client/server.\nOct 09 18:43:18 centos1 chronyd[554]: Selected source 188.114.116.1\nOct 09 18:43:18 centos1 chronyd[554]: System clock wrong by 80625.148375 seconds, adjustment started\nOct 10 17:07:03 centos1 chronyd[554]: System clock was stepped by 80625.148375 seconds\nOct 10 17:08:08 centos1 chronyd[554]: Selected source 194.80.204.184\n```", "```\n$ sudo journalctl /usr/sbin/chronyd\n-- Logs begin at Tue 2018-10-09 18:43:07 UTC, end at Wed 2018-10-10 17:21:08 UTC. --\nOct 09 18:43:09 centos1 chronyd[554]: chronyd version 3.2 starting (+CMDMON +NTP +REFCLOCK +RTC +PRIVDROP +SCFILTER +SECHASH +SIGND +ASYNCDNS +IPV6 +DEBUG)\nOct 09 18:43:09 centos1 chronyd[554]: Frequency -3.308 +/- 6.027 ppm read from /var/lib/chrony/drift\nOct 09 18:43:18 centos1 chronyd[554]: Selected source 188.114.116.1\nOct 09 18:43:18 centos1 chronyd[554]: System clock wrong by 80625.148375 seconds, adjustment started\nOct 10 17:07:03 centos1 chronyd[554]: System clock was stepped by 80625.148375 seconds\nOct 10 17:08:08 centos1 chronyd[554]: Selected source 194.80.204.184\n```", "```\n$ sudo journalctl -u sshd\n-- Logs begin at Tue 2018-10-09 18:43:07 UTC, end at Wed 2018-10-10 17:25:46 UTC. --\nOct 09 18:43:14 centos1 systemd[1]: Starting OpenSSH server daemon...\nOct 09 18:43:14 centos1 sshd[853]: Server listening on 0.0.0.0 port 22.\nOct 09 18:43:14 centos1 sshd[853]: Server listening on :: port 22.\nOct 09 18:43:14 centos1 systemd[1]: Started OpenSSH server daemon.\nOct 10 17:07:25 centos1 sshd[1106]: Accepted publickey for vagrant from 10.0.2.2 port 55300 ssh2: RSA SHA256:TTGYuhFa756sxR2rbliMhNqgbggAjFNERKg9htsdvSw\n$ sudo journalctl -u sshd -x\n-- Logs begin at Tue 2018-10-09 18:43:07 UTC, end at Wed 2018-10-10 17:26:04 UTC. --\nOct 09 18:43:14 centos1 systemd[1]: Starting OpenSSH server daemon...\n-- Subject: Unit sshd.service has begun start-up\n-- Defined-By: systemd\n-- Support: http://lists.freedesktop.org/mailman/listinfo/systemd-devel\n-- \n-- Unit sshd.service has begun starting up.\nOct 09 18:43:14 centos1 sshd[853]: Server listening on 0.0.0.0 port 22.\nOct 09 18:43:14 centos1 sshd[853]: Server listening on :: port 22.\nOct 09 18:43:14 centos1 systemd[1]: Started OpenSSH server daemon.\n-- Subject: Unit sshd.service has finished start-up\n-- Defined-By: systemd\n-- Support: http://lists.freedesktop.org/mailman/listinfo/systemd-devel\n-- \n-- Unit sshd.service has finished starting up.\n-- \n-- The start-up result is done.\nOct 10 17:07:25 centos1 sshd[1106]: Accepted publickey for vagrant from 10.0.2.2 port 55300 ssh2: RSA SHA256:TTGYuhFa756sxR2rbliMhNqgbggAjFNERKg9htsdvSw\n```", "```\n$ sudo journalctl --since=yesterday _SYSTEMD_UNIT=sshd.service _PID=853 \n-- Logs begin at Tue 2018-10-09 18:43:07 UTC, end at Wed 2018-10-10 17:31:48 UTC. --\nOct 09 18:43:14 centos1 sshd[853]: Server listening on 0.0.0.0 port 22.\nOct 09 18:43:14 centos1 sshd[853]: Server listening on :: port 22.\n```", "```\n$ sudo journalctl -p err\n-- Logs begin at Tue 2018-10-09 18:43:07 UTC, end at Wed 2018-10-10 17:55:48 UTC. --\nOct 09 18:43:09 centos1 systemd[504]: Failed at step STDIN spawning /usr/libexec/selinux/selinux-policy-migrate-local-changes.sh: Inappropriate ioctl for device\nOct 09 18:43:09 centos1 systemd[1]: Failed to start Migrate local SELinux policy changes from the old store structure to the new structure.\nOct 09 18:43:14 centos1 rsyslogd[857]: imjournal: loaded invalid cursor, seeking to the head of journal  [v8.24.0 try http://www.rsyslog.com/e/2027 ]\n```", "```\n$ logger -p cron.err \"I'M ANOTHER PARADOXICAL LOG MESSAGE.\"\n$ sudo journalctl -p err _TRANSPORT=syslog --since 18:00\n-- Logs begin at Tue 2018-10-09 18:43:07 UTC, end at Wed 2018-10-10 18:11:15 UTC. --\nOct 10 18:08:18 centos1 vagrant[1736]: I'M ANOTHER PARADOXICAL LOG MESSAGE.\n```", "```\n$ ls /run/log/journal/\n4eabd6271dbf4ed0bc608378f4311df8\n$ sudo ls -lh /run/log/journal/4eabd6271dbf4ed0bc608378f4311df8/\ntotal 4.0M\n-rwxr-x---+ 1 root systemd-journal 4.0M Oct  9 18:43 system.journal\n```", "```\n$ sudo journalctl --list-boots\n 0 b4c3669c7a9841ba841c330a75125e35 Tue 2018-10-09 18:43:07 UTC\u2014Wed 2018-10-10 18:13:27 UTC\n```", "```\n$ vagrant ssh centos1\n$ sudo yum install tcpdump -y\n\n$ vagrant ssh centos2\n$ sudo yum install tcpdump -y\n```", "```\n$ vagrant ssh debian1\n$ sudo apt install tcpdump systemd-journal-remote -y\n\n$ vagrant ssh debian2\n$ sudo apt install tcpdump systemd-journal-remote -y\n```", "```\n$ sudo sed -i 's/#*.* @@remote-host:514/*.* @192.168.33.11/g' /etc/rsyslog.conf\n$ sudo systemctl restart rsyslog\n```", "```\n$ sudo sed -i 's/#$ModLoad imudp/$ModLoad imudp/g' /etc/rsyslog.conf\n$ sudo sed -i 's/#$UDPServerRun 514/$UDPServerRun 514/g' /etc/rsyslog.conf\n$ sudo systemctl restart rsyslog\n```", "```\n$ sudo tcpdump port 514 -i eth1\n```", "```\n$ logger -p syslog.info \"I'm a regular info message.\"\n```", "```\n$ sudo tail -3 /var/log/messages\nOct 11 18:35:45 centos2 kernel: device eth1 entered promiscuous mode\nOct 11 18:35:48 centos1 vagrant: I'm a regular info message.\nOct 11 18:36:23 centos2 kernel: device eth1 left promiscuous mode\n```", "```\n$ sudo sed -i 's/*.* @192.168.33.11/*.* @@192.168.33.11/g' /etc/rsyslog.conf\n$ sudo systemctl restart rsyslog\n```", "```\n$ sudo sed -i 's/#$ModLoad imtcp/$ModLoad imtcp/g' /etc/rsyslog.conf\n$ sudo sed -i 's/#$InputTCPServerRun 514/$InputTCPServerRun 514/g' /etc/rsyslog.conf\n$ sudo systemctl restart rsyslog\n```", "```\n$ sudo tcpdump port 514 -i eth1\n```", "```\n$ logger -p syslog.err \"I'm a confusing error message.\"\n```", "```\n$ sudo tail -3 /var/log/messages\nOct 11 18:39:09 centos1 vagrant: I'm a confusing error message.\nOct 11 18:39:15 centos2 kernel: device eth1 left promiscuous mode\nOct 11 18:39:27 centos1 systemd-logind: Removed session 3.\n```", "```\n$ sudo sed -i 's/# URL=/URL=http:\\/\\/192.168.33.13/g' /etc/systemd/journal-upload.conf\n```", "```\n$ sudo systemctl edit systemd-journal-remote\n```", "```\n[Service]\nExecStart=\nExecStart=/lib/systemd/systemd-journal-remote --listen-http=-3 --output=/var/log/journal/remote\n```", "```\n$ sudo mkdir -p /var/log/journal/remote\n$ sudo chown systemd-journal-remote /var/log/journal/remote\n$ sudo systemctl restart systemd-journal-remote\n```", "```\n$ sudo systemctl restart systemd-journal-upload\n```", "```\n$ sudo journalctl -D /var/log/journal/remote/ -f\n```", "```\n$ logger -p syslog.err \"Debian1 logs, on Debian2!\"\n```", "```\n$ vagrant ssh centos1 $ sudo yum install epel-release -y\n$ sudo yum install htop -y\n```", "```\n$ vagrant ssh debian1 -- -L 127.0.0.1:19999:127.0.0.1:19999\n```", "```\n$ top\n```", "```\n$ echo \"deb http://ftp.debian.org/debian stretch-backports main\" | sudo tee -a /etc/apt/sources.list\n$ sudo apt update\n$ sudo apt install netdata -y\n```", "```\n$ vagrant ssh centos1\n```", "```\n$ sudo yum install epel-release -y\n$ sudo yum install atop sysstat -y\n```", "```\n$ atop\n```", "```\n$ sudo systemctl enable atop --now\n```", "```\n$ sudo ls /var/log/atop/\natop_20181013  daily.log\n```", "```\n$ atop -r 20181013\n```", "```\n$ sudo cat /etc/cron.d/atop\n# daily restart of atop at midnight\n0 0 * * * root systemctl try-restart atop\n```", "```\n$ sudo systemctl enable --now sysstat\n```", "```\n$ sudo cat /etc/cron.d/sysstat \n# Run system activity accounting tool every 10 minutes\n*/10 * * * * root /usr/lib64/sa/sa1 1 1\n# 0 * * * * root /usr/lib64/sa/sa1 600 6 &\n# Generate a daily summary of process accounting at 23:53\n53 23 * * * root /usr/lib64/sa/sa2 -A\n```", "```\n$ sar -f /var/log/sa/sa13 \nLinux 3.10.0-862.2.3.el7.x86_64 (centos1)     13/10/18     _x86_64_    (1 CPU)\n\n18:50:01        CPU     %user     %nice   %system   %iowait    %steal     %idle\n19:00:01        all      0.03      0.00      0.21      0.00      0.00     99.76\nAverage:        all      0.03      0.00      0.21      0.00      0.00     99.76\n\n19:07:51          LINUX RESTART\n\n19:10:01        CPU     %user     %nice   %system   %iowait    %steal     %idle\n19:14:43        all      0.04      0.00      0.22      0.00      0.00     99.75\n19:15:07        all      0.17      0.00      0.48      0.00      0.00     99.35\n19:20:01        all      0.01      0.00      0.12      0.00      0.00     99.87\n19:30:01        all      0.00      0.00      0.09      0.00      0.00     99.91\n19:40:01        all      0.00      0.00      0.10      0.00      0.00     99.90\nAverage:        all      0.01      0.00      0.12      0.00      0.00     99.87\n```", "```\n$ sar -f /var/log/sa/sa13 -s 19:10:00 -e 19:15:08\nLinux 3.10.0-862.2.3.el7.x86_64 (centos1) 13/10/18 _x86_64_ (1 CPU)\n\n19:10:01 CPU %user %nice %system %iowait %steal %idle\n19:14:43 all 0.04 0.00 0.22 0.00 0.00 99.75\n19:15:07 all 0.17 0.00 0.48 0.\n00 0.00 99.35\nAverage: all 0.05 0.00 0.24 0.00 0.00 99.72\n```", "```\n$ vmstat\nprocs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----\n r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st\n 2  0   1544  65260      0 367336    0    0    57    78   45   47  0  0 100  0  0\n```", "```\n$ vmstat 5\nprocs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----\n r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st\n 2  0   1544  65140      0 367336    0    0    57    77   45   47  0  0 100  0  0\n 0  0   1544  65140      0 367336    0    0     0     0   49   48  0  0 100  0  0\n 0  0   1544  64768      0 367336    0    0     0     0   51   54  0  0 100  0  0\n 0  0   1544  64768      0 367336    0    0     0     0   48   48  0  0 100  0  0\n 0  0   1544  64768      0 367336    0    0     0     1   46   46  0  0 100  0  0\n 0  0   1544  64768      0 367336    0    0     0     0   47   46  0  0 100  0  0\n 0  0   1544  64588      0 367336    0    0     0     0   49   53  0  0 100  0  0\n 0  0   1544  64784      0 367336    0    0     0     0   49   51  0  0 100  0  0\n 0  0   1544  64784      0 367336    0    0     0     0   48   48  0  0 100  0  0\n 1  0   1544  64784      0 367336    0    0     0     0   46   48  0  0 100  0  0\n```", "```\n$ cat /etc/sysconfig/atop \n# sysconfig atop\n#\n\n# Current Day format\nCURDAY=`date +%Y%m%d`\n# Log files path\nLOGPATH=/var/log/atop\n# Binaries path\nBINPATH=/usr/bin\n# PID File\nPIDFILE=/var/run/atop.pid\n# interval (default 10 minutes)\nINTERVAL=600\n$ cat /etc/sysconfig/sysstat\n# sysstat-10.1.5 configuration file.\n# How long to keep log files (in days).\n# If value is greater than 28, then log files are kept in\n# multiple directories, one for each month.\nHISTORY=28\n# Compress (using gzip or bzip2) sa and sar files older than (in days):\nCOMPRESSAFTER=31\n# Parameters for the system activity data collector (see sadc manual page)\n# which are used for the generation of log files.\nSADC_OPTIONS=\"-S DISK\"\n# Compression program to use.\nZIP=\"bzip2\"\n```", "```\n$ vagrant ssh centos1 -- -L 127.0.0.1:8080:127.0.0.1:80\n```", "```\n$ sudo yum install -y epel-release\n$ sudo yum install -y httpd nagios nagios-plugins-all nagios-plugins-nrpe\n```", "```\n$ sudo systemctl enable --now nagios\n$ sudo systemctl enable --now httpd\n```", "```\n$ sudo htpasswd /etc/nagios/passwd nagiosadmin\nNew password: \nRe-type new password: \nUpdating password for user nagiosadmin\n```", "```\n$ echo \"cfg_file=/etc/nagios/objects/debian1.cfg\" | sudo tee -a /etc/nagios/nagios.cfg\n```", "```\n$ sudo cp /etc/nagios/objects/localhost.cfg /etc/nagios/objects/debian1.cfg\n```", "```\n$ sudo sed -i 's/localhost/debian1/g' /etc/nagios/objects/debian1.cfg\n$ sudo sed -i 's/127.0.0.1/192.168.33.12/g' /etc/nagios/objects/debian1.cfg\n$ sudo sed -i 's/linux-servers/remote-vms/g' /etc/nagios/objects/debian1.cfg\n$ sudo sed -i 's/check_local/check_nrpe!check_client/g' /etc/nagios/objects/debian1.cfg\n```", "```\n$ cat <<HERE | sudo tee -a /etc/nagios/objects/commands.cfg\ndefine command{\n command_name    check_nrpe\n command_line    \\$USER1\\$/check_nrpe -H \\$HOSTADDRESS\\$ -c \\$ARG1\\$ \n }\nHERE\n```", "```\n$ sudo systemctl restart nagios\n```", "```\n $ sudo apt install monitoring-plugins nagios-nrpe-server -y\n```", "```\n$ sudo sed -i 's/allowed_hosts=127.0.0.1/allowed_hosts=127.0.0.1,192.168.33.10/g' /etc/nagios/nrpe.cfg\n```", "```\n$ cat <<HERE | sudo tee /etc/nagios/nrpe_local.cfg \ncommand[check_client_load]=/usr/lib/nagios/plugins/check_load -w 5.0,4.0,3.0 -c 10.0,6.0,4.0\ncommand[check_client_users]=/usr/lib/nagios/plugins/check_users -w 20 -c 50\ncommand[check_client_disk]=/usr/lib/nagios/plugins/check_disk -w 20% -c 10% -p /\ncommand[check_client_swap]=/usr/lib/nagios/plugins/check_swap -w 20 -c 10\ncommand[check_client_procs]=/usr/lib/nagios/plugins/check_procs -w 250 -c 400 -s RSZDT\nHERE\n```", "```\n$ sudo systemctl restart nagios-nrpe-server\n```", "```\n$ vagrant ssh centos2 -- -L 127.0.0.1:8181:127.0.0.1:80\n```", "```\n$ sudo yum install epel-release -y\n$ sudo yum install centos-release-scl -y\n$ sudo yum install https://packages.icinga.com/epel/icinga-rpm-release-7-latest.noarch.rpm -y\n$ sudo yum install httpd icinga2 icinga2-ido-mysql nagios-plugins-all icinga2-selinux mariadb-server mariadb icingaweb2 icingacli icingaweb2-selinux rh-php71-php-mysqlnd -y\n$ sudo systemctl enable --now icinga2\n$ sudo systemctl enable --now mariadb\n```", "```\n$ mysql_secure_installation\n\nNOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MariaDB\n      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!\n\nIn order to log into MariaDB to secure it, we'll need the current\npassword for the root user.  If you've just installed MariaDB, and\nyou haven't set the root password yet, the password will be blank,\nso you should just press enter here.\n\nEnter current password for root (enter for none): \nOK, successfully used password, moving on...\n\nSetting the root password ensures that nobody can log into the MariaDB\nroot user without the proper authorisation.\n\nSet root password? [Y/n] Y\nNew password: \nRe-enter new password: \nPassword updated successfully!\nReloading privilege tables..\n ... Success!\n\nBy default, a MariaDB installation has an anonymous user, allowing anyone\nto log into MariaDB without having to have a user account created for\nthem.  This is intended only for testing, and to make the installation\ngo a bit smoother.  You should remove them before moving into a\nproduction environment.\n\nRemove anonymous users? [Y/n] Y\n ... Success!\n\nNormally, root should only be allowed to connect from 'localhost'.  This\nensures that someone cannot guess at the root password from the network.\n\nDisallow root login remotely? [Y/n] Y\n ... Success!\n\nBy default, MariaDB comes with a database named 'test' that anyone can\naccess.  This is also intended only for testing, and should be removed\nbefore moving into a production environment.\n\nRemove test database and access to it? [Y/n] Y\n - Dropping test database...\n ... Success!\n - Removing privileges on test database...\n ... Success!\n\nReloading the privilege tables will ensure that all changes made so far\nwill take effect immediately.\n\nReload privilege tables now? [Y/n] Y\n ... Success!\n\nCleaning up...\n\nAll done!  If you've completed all of the above steps, your MariaDB\ninstallation should now be secure.\n\nThanks for using MariaDB!\n```", "```\n$ mysql -u root -p<The Password You Set Above>\n\nMariaDB [(none)]> CREATE DATABASE icinga;\nQuery OK, 1 row affected (0.00 sec)\n\nMariaDB [(none)]> GRANT SELECT, INSERT, UPDATE, DELETE, DROP, CREATE VIEW, INDEX, EXECUTE ON icinga.* TO 'icinga'@'localhost' IDENTIFIED BY 'icinga';\nQuery OK, 0 rows affected (0.06 sec)\n\nMariaDB [(none)]> quit\nBye\n```", "```\n$ mysql -u root -p icinga < /usr/share/icinga2-ido-mysql/schema/mysql.sql\n```", "```\n$ sudo icinga2 feature enable ido-mysql\n$ sudo systemctl restart icinga2\n```", "```\n$ sudo systemctl enable --now httpd\n```", "```\n$ sudo icinga2 api setup\n$ sudo systemctl restart icinga2\n```", "```\n$ sudo cat /etc/icinga2/conf.d/api-users.conf\n/**\n * The ApiUser objects are used for authentication against the API.\n */\nobject ApiUser \"root\" {\n password = \"40ebca8aaaf1eba0\"\n // client_cn = \"\"\n\n permissions = [ \"*\" ]\n}\n```", "```\n$ sudo sed -i 's/;date.timezone =/date.timezone = UTC/g' /etc/opt/rh/rh-php71/php.ini\n$ sudo systemctl enable --now rh-php71-php-fpm.service\n```", "```\n$ sudo icingacli setup token create\nThe newly generated setup token is: 052f63696e4dc84c\n```", "```\n$ sudo icinga2 node wizard\nWelcome to the Icinga 2 Setup Wizard!\n\nWe will guide you through all required configuration details.\n\nPlease specify if this is a satellite/client setup ('n' installs a master setup) [Y/n]: n\n\nStarting the Master setup routine...\n\nPlease specify the common name (CN) [centos2]: \nReconfiguring Icinga...\nChecking for existing certificates for common name 'centos2'...\nCertificate '/var/lib/icinga2/certs//centos2.crt' for CN 'centos2' already existing. Skipping certificate generation.\nGenerating master configuration for Icinga 2.\n'api' feature already enabled.\n\nMaster zone name [master]: \n\nDefault global zones: global-templates director-global\nDo you want to specify additional global zones? [y/N]: \nPlease specify the API bind host/port (optional):\nBind Host []: \nBind Port []: \n\nDo you want to disable the inclusion of the conf.d directory [Y/n]: \nDisabling the inclusion of the conf.d directory...\nChecking if the api-users.conf file exists...\n\nDone.\n\nNow restart your Icinga 2 daemon to finish the installation!\n```", "```\n$ sudo systemctl restart icinga2\n```", "```\n$ sudo icinga2 pki ticket --cn debian2\n8c7ecd2c04e6ca73bb0d1a6cc62ae4041bf2d5d2\n```", "```\n$ sudo apt install icinga2 -y\n```", "```\n$ sudo icinga2 node wizard\nWelcome to the Icinga 2 Setup Wizard!\n\nWe'll guide you through all required configuration details.\n\nPlease specify if this is a satellite setup ('n' installs a master setup) [Y/n]: \nStarting the Node setup routine...\nPlease specify the common name (CN) [debian2]: \nPlease specify the master endpoint(s) this node should connect to:\nMaster Common Name (CN from your master setup): centos2\nDo you want to establish a connection to the master from this node? [Y/n]: \nPlease fill out the master connection information:\nMaster endpoint host (Your master's IP address or FQDN): 192.168.33.11\nMaster endpoint port [5665]: \nAdd more master endpoints? [y/N]: \nPlease specify the master connection for CSR auto-signing (defaults to master endpoint host):\nHost [192.168.33.11]: \nPort [5665]: \ninformation/base: Writing private key to '/etc/icinga2/pki/debian2.key'.\ninformation/base: Writing X509 certificate to '/etc/icinga2/pki/debian2.crt'.\ninformation/cli: Fetching public certificate from master (192.168.33.11, 5665):\n\nCertificate information:\n\n Subject:     CN = centos2\n Issuer:      CN = Icinga CA\n Valid From:  Oct 13 22:34:30 2018 GMT\n Valid Until: Oct  9 22:34:30 2033 GMT\n Fingerprint: B5 0B 00 5D 5F 34 14 08 D7 48 8E DA E1 83 96 35 D9 0F 54 1F \n\nIs this information correct? [y/N]: y\ninformation/cli: Received trusted master certificate.\n\nPlease specify the request ticket generated on your Icinga 2 master.\n (Hint: # icinga2 pki ticket --cn 'debian2'): 8c7ecd2c04e6ca73bb0d1a6cc62ae4041bf2d5d2\ninformation/cli: Requesting certificate with ticket '8c7ecd2c04e6ca73bb0d1a6cc62ae4041bf2d5d2'.\n\ninformation/cli: Created backup file '/etc/icinga2/pki/debian2.crt.orig'.\ninformation/cli: Writing signed certificate to file '/etc/icinga2/pki/debian2.crt'.\ninformation/cli: Writing CA certificate to file '/etc/icinga2/pki/ca.crt'.\nPlease specify the API bind host/port (optional):\nBind Host []: \nBind Port []: \nAccept config from master? [y/N]: y\nAccept commands from master? [y/N]: y\ninformation/cli: Disabling the Notification feature.\nDisabling feature notification. Make sure to restart Icinga 2 for these changes to take effect.\ninformation/cli: Enabling the Apilistener feature.\nEnabling feature api. Make sure to restart Icinga 2 for these changes to take effect.\ninformation/cli: Created backup file '/etc/icinga2/features-available/api.conf.orig'.\ninformation/cli: Generating local zones.conf.\ninformation/cli: Dumping config items to file '/etc/icinga2/zones.conf'.\ninformation/cli: Created backup file '/etc/icinga2/zones.conf.orig'.\ninformation/cli: Updating constants.conf.\ninformation/cli: Created backup file '/etc/icinga2/constants.conf.orig'.\ninformation/cli: Updating constants file '/etc/icinga2/constants.conf'.\ninformation/cli: Updating constants file '/etc/icinga2/constants.conf'.\nDone.\n\nNow restart your Icinga 2 daemon to finish the installation!\n```", "```\n$ sudo systemctl restart icinga2\n```", "```\n$ ss -t\nState      Recv-Q Send-Q                                     Local Address:Port                                                      Peer Address:Port                \nESTAB      0      0                                              10.0.2.15:ssh                                                           10.0.2.2:44828                \nESTAB 0 0 192.168.33.13:5665 192.168.33.11:49398 \n```", "```\n$ cat <<HERE | sudo tee -a /etc/icinga2/zones.conf\nobject Endpoint \"debian2\" {\n host = \"192.168.33.13\"\n}\nobject Zone \"debian2\" {\n endpoints = [ \"debian2\" ]\n parent = \"master\"\n}\nHERE\n```", "```\n$ sudo mkdir -p /etc/icinga2/zones.d/master\n```", "```\n$ cat <<HERE | sudo tee /etc/icinga2/zones.d/master/hosts.conf\nobject Host \"debian2\" {\n check_command = \"hostalive\"\n address = \"192.168.33.13\"\n vars.client_endpoint = name\n vars.os = \"Linux\"\n}\nHERE\n```", "```\n$ sudo systemctl restart icinga2\n```", "```\n$ cat <<HERE | sudo tee /etc/icinga2/zones.d/master/services.conf\napply Service \"ping4\" {\n check_command = \"ping4\"\n assign where host.address\n}\napply Service \"ssh\" {\n check_command = \"ssh\" \n assign where host.vars.os == \"Linux\"\n}\napply Service \"disk\" {\n check_command = \"disk\"\n command_endpoint = host.vars.client_endpoint\n assign where host.vars.client_endpoint\n}\napply Service \"icinga\" {\n check_command = \"icinga\"\n command_endpoint = host.vars.client_endpoint\n assign where host.vars.client_endpoint\n}\napply Service \"ntp_time\" {\n check_command = \"ntp_time\"\n command_endpoint = host.vars.client_endpoint\n assign where host.vars.client_endpoint\n}\nHERE\n```", "```\n$ sudo systemctl restart icinga2\n```", "```\n$ vagrant destroy -f\n$ vagrant up\n$ vagrant ssh centos1 -- -L127.0.0.1:5601:127.0.0.1:5601\n```", "```\n$ sudo yum install java-1.8.0-openjdk -y\n```", "```\n$ cat <<HERE | sudo tee /etc/yum.repos.d/elasticsearch.repo\n[elasticsearch-6.x]\nname=Elasticsearch repository for 6.x packages\nbaseurl=https://artifacts.elastic.co/packages/6.x/yum\ngpgcheck=1\ngpgkey=https://artifacts.elastic.co/GPG-KEY-elasticsearch\nenabled=1\nautorefresh=1\ntype=rpm-md\nHERE\n```", "```\n$ sudo yum install elasticsearch kibana logstash -y\n```", "```\n$ sudo systemctl daemon-reload\n$ sudo systemctl enable --now elasticsearch\n$ sudo systemctl enable --now kibana\n```", "```\n$ cat <<HERE | sudo tee /etc/logstash/conf.d/logstash-syslog.conf\ninput {\n tcp {\n port => 5000\n type => syslog\n }\n udp {\n port => 5000\n type => syslog\n }\n}\n\nfilter {\n if [type] == \"syslog\" {\n grok {\n match => { \"message\" => \"%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:syslog_hostname} %{DATA:syslog_program}(?:\\[%{POSINT:syslog_pid}\\])?: %{GREEDYDATA:syslog_message}\" }\n add_field => [ \"received_at\", \"%{@timestamp}\" ]\n add_field => [ \"received_from\", \"%{host}\" ]\n }\n date {\n match => [ \"syslog_timestamp\", \"MMM  d HH:mm:ss\", \"MMM dd HH:mm:ss\" ]\n }\n }\n}\n\noutput {\n elasticsearch { hosts => [\"localhost:9200\"] }\n stdout { codec => rubydebug }\n}\nHERE\n```", "```\n$ sudo systemctl enable --now logstash\n```", "```\n$ ss -tunal '( src :5601 or src :9200 or src :5000 )'\nNetid  State      Recv-Q Send-Q                                        Local Address:Port                                                       Peer Address:Port \nudp    UNCONN     0      0                                                         *:5000                                                                  *:* \ntcp    LISTEN     0      128                                               127.0.0.1:5601                                                                  *:* \ntcp    LISTEN     0      128                                                      :::5000                                                                 :::* \ntcp    LISTEN     0      128                                        ::ffff:127.0.0.1:9200                                                                 :::* \ntcp    LISTEN     0      128                                                     ::1:9200                                                                 :::*       \n```", "```\n$ sudo sed -i 's/#*.* @@remote-host:514/*.* @192.168.33.10:5000/g' /etc/rsyslog.conf\n$ sudo systemctl restart rsyslog\n```", "```\n$ logger -p syslog.err \"Digimon was better than Pokemon.\"\n```", "```\n$ echo \"*.* @192.168.33.10:5000\" | sudo tee -a /etc/rsyslog.conf\n$ sudo systemctl restart rsyslog\n$ logger -p syslog.err \"Digimon was better than Pokemon.\"\n```", "```\n(host:192.168.33.13 OR host:192.168.33.12 OR host:192.168.33.11) AND message:\"Pokemon*\"\n```"]