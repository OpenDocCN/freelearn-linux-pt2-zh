["```\n# -*- mode: ruby -*-\n# vi: set ft=ruby :\n\n$provisionScript = <<-SCRIPT\nsed -i 's#PasswordAuthentication no#PasswordAuthentication yes#g' /etc/ssh/sshd_config\nsystemctl restart sshd\nSCRIPT\n\nVagrant.configure(\"2\") do |config|\n\n config.vm.provision \"shell\",\n inline: $provisionScript\n\n config.vm.define \"centos1\" do |centos1|\n   centos1.vm.box = \"centos/7\"\n   centos1.vm.network \"private_network\", ip: \"192.168.33.10\"\n   centos1.vm.network \"private_network\", ip: \"192.168.44.10\", auto_config: false\n   centos1.vm.hostname = \"centos1\"\n   centos1.vm.box_version = \"1804.02\"\n end\n\n config.vm.define \"centos2\" do |centos2|\n   centos2.vm.box = \"centos/7\"\n   centos2.vm.network \"private_network\", ip: \"192.168.33.11\"\n   centos2.vm.network \"private_network\", ip: \"192.168.44.11\", auto_config: false\n   centos2.vm.hostname = \"centos2\"\n   centos2.vm.box_version = \"1804.02\"\n end\n\n config.vm.define \"ubuntu1\" do |ubuntu1|\n   ubuntu1.vm.box = \"ubuntu/bionic64\"\n   ubuntu1.vm.hostname = \"ubuntu1\"\n   ubuntu1.vm.box_version = \"20180927.0.0\"\n end\n\nend\n```", "```\n$ vagrant ssh centos1\n```", "```\n$ vagrant ssh centos1\n```", "```\n$ sudo yum install net-tools\n```", "```\n$ ip address show\n```", "```\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n inet 127.0.0.1/8 scope host lo\n valid_lft forever preferred_lft forever\n inet6 ::1/128 scope host \n valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\n link/ether 52:54:00:c9:c7:04 brd ff:ff:ff:ff:ff:ff\n inet 10.0.2.15/24 brd 10.0.2.255 scope global noprefixroute dynamic eth0\n valid_lft 85733sec preferred_lft 85733sec\n inet6 fe80::5054:ff:fec9:c704/64 scope link \n valid_lft forever preferred_lft forever\n3: eth1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\n link/ether 08:00:27:4b:03:de brd ff:ff:ff:ff:ff:ff\n inet 192.168.33.10/24 brd 192.168.33.255 scope global noprefixroute eth1\n valid_lft forever preferred_lft forever\n inet6 fe80::a00:27ff:fe4b:3de/64 scope link \n valid_lft forever preferred_lft forever\n4: eth2: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\n link/ether 08:00:27:50:a5:cb brd ff:ff:ff:ff:ff:ff\n```", "```\n$ ip address show dev eth1\n```", "```\n3: eth1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\n    link/ether 08:00:27:0d:d9:0c brd ff:ff:ff:ff:ff:ff\n    inet 192.168.33.10/24 brd 192.168.33.255 scope global noprefixroute eth1\n       valid_lft forever preferred_lft forever\n    inet6 fe80::a00:27ff:fe0d:d90c/64 scope link \n       valid_lft forever preferred_lft forever\n```", "```\n$ ip address show dev eth1 | grep \"inet \" | awk '{ print $2 }'\n192.168.33.10/24\n```", "```\n$ ifconfig\neth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST> mtu 1500\n inet 10.0.2.15 netmask 255.255.255.0 broadcast 10.0.2.255\n inet6 fe80::5054:ff:fec9:c704 prefixlen 64 scopeid 0x20<link>\n ether 52:54:00:c9:c7:04 txqueuelen 1000 (Ethernet)\n RX packets 14404 bytes 12885029 (12.2 MiB)\n RX errors 0 dropped 0 overruns 0 frame 0\n TX packets 5672 bytes 409079 (399.4 KiB)\n TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0\n\neth1: flags=4163<UP,BROADCAST,RUNNING,MULTICAST> mtu 1500\n inet 192.168.33.10 netmask 255.255.255.0 broadcast 192.168.33.255\n inet6 fe80::a00:27ff:fe4b:3de prefixlen 64 scopeid 0x20<link>\n ether 08:00:27:4b:03:de txqueuelen 1000 (Ethernet)\n RX packets 8 bytes 3164 (3.0 KiB)\n RX errors 0 dropped 0 overruns 0 frame 0\n TX packets 17 bytes 1906 (1.8 KiB)\n TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0\n\neth2: flags=4163<UP,BROADCAST,RUNNING,MULTICAST> mtu 1500\n ether 08:00:27:50:a5:cb txqueuelen 1000 (Ethernet)\n RX packets 43 bytes 14706 (14.3 KiB)\n RX errors 0 dropped 0 overruns 0 frame 0\n TX packets 112 bytes 19336 (18.8 KiB)\n TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0\n\nlo: flags=73<UP,LOOPBACK,RUNNING> mtu 65536\n inet 127.0.0.1 netmask 255.0.0.0\n inet6 ::1 prefixlen 128 scopeid 0x10<host>\n loop txqueuelen 1000 (Local Loopback)\n RX packets 0 bytes 0 (0.0 B)\n RX errors 0 dropped 0 overruns 0 frame 0\n TX packets 0 bytes 0 (0.0 B)\n TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0\n\n```", "```\n$ ifconfig eth1\neth1: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500\n inet 192.168.33.10  netmask 255.255.255.0  broadcast 192.168.33.255\n inet6 fe80::a00:27ff:fe0d:d90c  prefixlen 64  scopeid 0x20<link>\n ether 08:00:27:0d:d9:0c  txqueuelen 1000  (Ethernet)\n RX packets 24  bytes 4268 (4.1 KiB)\n RX errors 0  dropped 0  overruns 0  frame 0\n TX packets 20  bytes 2116 (2.0 KiB)\n TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n```", "```\n$ ip route \ndefault via 10.0.2.2 dev eth0 proto dhcp metric 102 \n10.0.2.0/24 dev eth0 proto kernel scope link src 10.0.2.15 metric 102 \n192.168.33.0/24 dev eth1 proto kernel scope link src 192.168.33.10 metric 100 \n```", "```\n$ route\nKernel IP routing table\nDestination     Gateway         Genmask         Flags Metric Ref    Use Iface\ndefault         gateway         0.0.0.0         UG    102    0        0 eth0\n10.0.2.0        0.0.0.0         255.255.255.0   U     102    0        0 eth0\n192.168.33.0    0.0.0.0         255.255.255.0   U     100    0        0 eth1\n```", "```\n$ ping 10.0.2.2\nPING 10.0.2.2 (10.0.2.2) 56(84) bytes of data.\n64 bytes from 10.0.2.2: icmp_seq=1 ttl=64 time=0.768 ms\n64 bytes from 10.0.2.2: icmp_seq=2 ttl=64 time=0.333 ms\n64 bytes from 10.0.2.2: icmp_seq=3 ttl=64 time=0.637 ms\n```", "```\n$ ip address show dev eth0\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\n```", "```\n$ ip route get 1.1.1.1\n1.1.1.1 via 10.0.2.2 dev eth0 src 10.0.2.15 \n cache \n```", "```\n$ ip route get 10.0.2.2\n10.0.2.2 dev eth0 src 10.0.2.15 \n cache \n```", "```\n$ ip route get 192.168.33.11\n192.168.33.11 dev eth1 src 192.168.33.10 \n cache \n```", "```\n$ ip route get 192.168.33.10\nlocal 192.168.33.10 dev lo src 192.168.33.10 \n cache <local> \n```", "```\n$ vagrant ssh centos1\n```", "```\n$ sudo ip address add 192.168.33.22/24 dev eth1\n```", "```\n3: eth1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\n    link/ether 08:00:27:0d:d9:0c brd ff:ff:ff:ff:ff:ff\n    inet 192.168.33.10/24 brd 192.168.33.255 scope global noprefixroute eth1\n       valid_lft forever preferred_lft forever\n inet 192.168.33.22/24 scope global secondary eth1\n       valid_lft forever preferred_lft forever\n    inet6 fe80::a00:27ff:fe0d:d90c/64 scope link \n       valid_lft forever preferred_lft forever\n```", "```\n$ sudo ip address del 192.168.33.22/24 dev eth1\n```", "```\n$ sudo ip link set eth1 down\n```", "```\n3: eth1: <BROADCAST,MULTICAST> mtu 1500 qdisc pfifo_fast state DOWN group default qlen 1000\n link/ether 08:00:27:0d:d9:0c brd ff:ff:ff:ff:ff:ff\n inet 192.168.33.10/24 brd 192.168.33.255 scope global noprefixroute eth1\n valid_lft forever preferred_lft forever\n```", "```\n$ sudo ip link set eth1 up\n```", "```\n$ sudo ip route add 172.16.0.0/12 via 192.168.33.11 dev eth1\n```", "```\n$ ip route\ndefault via 10.0.2.2 dev eth0 proto dhcp metric 100 \n10.0.2.0/24 dev eth0 proto kernel scope link src 10.0.2.15 metric 100 \n172.16.0.0/12 via 192.168.33.11 dev eth1 \n192.168.33.0/24 dev eth1 proto kernel scope link src 192.168.33.10 metric 101\n```", "```\nAug 12 12:38:09 centos1 NetworkManager[566]: <info>  [1534077489.1507] device (eth1): state change: activated -> unavailable (reason 'carrier-changed', sys-iface-state: 'managed')\nAug 12 12:38:09 centos1 dbus[545]: [system] Activating via systemd: service name='org.freedesktop.nm_dispatcher' unit='dbus-org.freedesktop.nm-dispatcher.service'\nAug 12 12:38:09 centos1 systemd: Starting Network Manager Script Dispatcher Service...\nAug 12 12:38:09 centos1 dbus[545]: [system] Successfully activated service 'org.freedesktop.nm_dispatcher'\nAug 12 12:38:09 centos1 systemd: Started Network Manager Script Dispatcher Service.\nAug 12 12:38:09 centos1 nm-dispatcher: req:1 'down' [eth1]: new request (3 scripts)\nAug 12 12:38:09 centos1 nm-dispatcher: req:1 'down' [eth1]: start running ordered scripts...\n```", "```\n$ sudo yum install -y tcpdump\n```", "```\n$ ping 172.16.0.3\nPING 172.16.0.3 (172.16.0.3) 56(84) bytes of data.\n```", "```\n$ sudo tcpdump -i eth1\n```", "```\n12:48:26.735055 IP 192.168.33.10 > 172.16.0.3: ICMP echo request, id 1696, seq 1, length 64\n12:48:27.736195 IP 192.168.33.10 > 172.16.0.3: ICMP echo request, id 1696, seq 2, length 64\n12:48:28.738030 IP 192.168.33.10 > 172.16.0.3: ICMP echo request, id 1696, seq 3, length 64\n12:48:29.743270 IP 192.168.33.10 > 172.16.0.3: ICMP echo request, id 1696, seq 4, length 64\n12:48:30.747098 IP 192.168.33.10 > 172.16.0.3: ICMP echo request, id 1696, seq 5, length 64\n12:48:31.750916 IP 192.168.33.10 > 172.16.0.3: ICMP echo request, id 1696, seq 6, length 64\n12:48:32.752634 IP 192.168.33.10 > 172.16.0.3: ICMP echo request, id 1696, seq 7, length 64\n```", "```\n--- 172.16.0.3 ping statistics ---\n8 packets transmitted, 0 received, 100% packet loss, time 7019ms\n```", "```\n$ vagrant ssh centos1\n```", "```\n$ ip link show eth2\n4: eth2: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP mode DEFAULT group default qlen 1000\n link/ether 08:00:27:7d:f3:6b brd ff:ff:ff:ff:ff:ff\n```", "```\n$ sudo touch /etc/sysconfig/network-scripts/ifcfg-eth2\n```", "```\n$ sudo tee /etc/sysconfig/network-scripts/ifcfg-eth2 << HERE \nBOOTPROTO=none\nONBOOT=yes\nIPADDR=192.168.44.10\nNETMASK=255.255.255.0\nDEVICE=eth2\nPEERDNS=no\nHERE\n```", "```\n$ sudo ifdown eth2\n$ sudo ifup eth2\n```", "```\n$ sudo systemctl restart network\n```", "```\nBOOTPROTO=none\n```", "```\nONBOOT=yes\n```", "```\nIPADDR=192.168.44.10\nNETMASK=255.255.255.0\n```", "```\nDEVICE=eth2\n```", "```\nPEERDNS=no\n```", "```\n$ nmcli device \nDEVICE  TYPE      STATE      CONNECTION \neth0    ethernet  connected  System eth0 \neth1    ethernet  connected  System eth1 \neth2    ethernet  connected  System eth2 \nlo      loopback  unmanaged  --  \n```", "```\nBOOTPROTO=none\nONBOOT=yes\nIPADDR=192.168.44.10\nNETMASK=255.255.255.0\nDEVICE=eth2\nPEERDNS=no\nNM_CONTROLLED=no\n```", "```\n$ sudo ifdown eth2\n$ sudo ifup eth2\n```", "```\n$ nmcli device \nDEVICE  TYPE      STATE      CONNECTION \neth0    ethernet  connected  System eth0 \neth1    ethernet  connected  System eth1 \neth2    ethernet  unmanaged  -- \nlo      loopback  unmanaged  --\n```", "```\n$ ping bbc.co.uk\nPING bbc.co.uk (151.101.0.81) 56(84) bytes of data.\n64 bytes from 151.101.0.81 (151.101.0.81): icmp_seq=1 ttl=63 time=30.4 ms\n```", "```\n$ sudo yum install -y bind-utils\n```", "```\n$ dig bbc.co.uk\n\n; <<>> DiG 9.9.4-RedHat-9.9.4-61.el7 <<>> bbc.co.uk\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 6288\n;; flags: qr rd ra; QUERY: 1, ANSWER: 4, AUTHORITY: 0, ADDITIONAL: 1\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 65494\n;; QUESTION SECTION:\n;bbc.co.uk.            IN    A\n\n;; ANSWER SECTION:\nbbc.co.uk.        227    IN    A    151.101.0.81\nbbc.co.uk.        227    IN    A    151.101.64.81\nbbc.co.uk.        227    IN    A    151.101.128.81\nbbc.co.uk.        227    IN    A    151.101.192.81\n\n;; Query time: 24 msec\n;; SERVER: 10.0.2.3#53(10.0.2.3)\n;; WHEN: Sun Aug 12 14:20:28 UTC 2018\n;; MSG SIZE  rcvd: 102\n```", "```\n$ cat /etc/resolv.conf \n# Generated by NetworkManager\nsearch discworld\nnameserver 10.0.2.3\n```", "```\n$ nmcli -f ipv4.dns,ipv4.ignore-auto-dns connection show System\\ eth0\nipv4.dns:                               --\nipv4.ignore-auto-dns:                   no\n```", "```\n$ sudo nmcli connection modify System\\ eth0 ipv4.dns \"1.1.1.1\" ipv4.ignore-auto-dns \"yes\"\n```", "```\n$ sudo nmcli connection up System\\ eth0\n```", "```\n$ cat /etc/resolv.conf \n# Generated by NetworkManager\nnameserver 1.1.1.1\n```", "```\n$ dig bbc.co.uk\n\n; <<>> DiG 9.9.4-RedHat-9.9.4-61.el7 <<>> bbc.co.uk\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 10132\n;; flags: qr rd ra; QUERY: 1, ANSWER: 4, AUTHORITY: 0, ADDITIONAL: 1\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 1452\n;; QUESTION SECTION:\n;bbc.co.uk.            IN    A\n\n;; ANSWER SECTION:\nbbc.co.uk.        210    IN    A    151.101.0.81\nbbc.co.uk.        210    IN    A    151.101.64.81\nbbc.co.uk.        210    IN    A    151.101.128.81\nbbc.co.uk.        210    IN    A    151.101.192.81\n\n;; Query time: 23 msec\n;; SERVER: 1.1.1.1#53(1.1.1.1)\n;; WHEN: Sun Aug 12 14:46:05 UTC 2018\n;; MSG SIZE  rcvd: 102\n```", "```\n$ sudo yum install tcpdump -y\n$ sudo tcpdump -i eth0 -n port 53\n```", "```\n$ dig bbc.co.uk\n```", "```\n14:58:50.303421 IP 10.0.2.15.51686 > 1.1.1.1.domain: 19866+ [1au] A? bbc.co.uk. (38)\n14:58:50.331999 IP 1.1.1.1.domain > 10.0.2.15.51686: 19866 4/0/1 A 151.101.0.81, A 151.101.64.81, A 151.101.128.81, A 151.101.192.81 (102)\n```", "```\n[main]\n#plugins=ifcfg-rh,ibft\ndns=none\n```", "```\n$ cat /etc/sysconfig/network-scripts/ifcfg-eth0\nDEVICE=\"eth0\"\nBOOTPROTO=\"dhcp\"\nONBOOT=\"yes\"\nTYPE=\"Ethernet\"\nPERSISTENT_DHCLIENT=\"yes\"\n```", "```\n$ cat /etc/sysconfig/network-scripts/ifcfg-eth0\nDEVICE=eth0\nBOOTPROTO=dhcp\nONBOOT=yes\nTYPE=Ethernet\nPERSISTENT_DHCLIENT=\"yes\"\nPROXY_METHOD=none\nBROWSER_ONLY=no\nDNS1=1.1.1.1\nDEFROUTE=yes\nPEERDNS=no\nIPV4_FAILURE_FATAL=no\nIPV6INIT=no\nNAME=\"System eth0\"\nUUID=5fb06bd0-0bb0-7ffb-45f1-d6edd65f3e03\n```", "```\n$ sudo yum install -y tcpdump\n$ sudo yum install -y tcpdump\n```", "```\n$ date\nMon 13 Aug 10:05:31 UTC 2018\n```", "```\n$ systemctl status chronyd\n\u25cf chronyd.service - NTP client/server\n   Loaded: loaded (/usr/lib/systemd/system/chronyd.service; enabled; vendor preset: enabled)\n Active: active (running) since Mon 2018-08-13 07:20:48 UTC; 2h 43min ago\n     Docs: man:chronyd(8)\n           man:chrony.conf(5)\n  Process: 576 ExecStartPost=/usr/libexec/chrony-helper update-daemon (code=exited, status=0/SUCCESS)\n  Process: 556 ExecStart=/usr/sbin/chronyd $OPTIONS (code=exited, status=0/SUCCESS)\n Main PID: 570 (chronyd)\n   CGroup: /system.slice/chronyd.service\n           \u2514\u2500570 /usr/sbin/chronyd\n```", "```\n$ sudo tcpdump port 123 -i eth0\n```", "```\n10:07:33.229507 IP centos1.37284 > ntp3.wirehive.net.ntp: NTPv4, Client, length 48\n10:07:33.266188 IP ntp3.wirehive.net.ntp > centos1.37284: NTPv4, Server, length 48\n10:07:39.411433 IP centos1.49376 > 5751b502.skybroadband.com.ntp: NTPv4, Client, length 48\n10:07:39.453834 IP 5751b502.skybroadband.com.ntp > centos1.49376: NTPv4, Server, length 48\n```", "```\n$ chronyc sources\n210 Number of sources = 4\nMS Name/IP address         Stratum Poll Reach LastRx Last sample \n===============================================================================\n^* 85.199.214.100                1   6   377    18   +266us[ +309us] +/- 7548us\n^- clocka.ntpjs.org              2   6   377    17   -126us[ -126us] +/-   37ms\n^- linnaeus.inf.ed.ac.uk         3   6   377    17    -80us[  -80us] +/-   74ms\n^+ 85.199.214.101                1   6   377    17   +166us[ +166us] +/- 7583us\n```", "```\n$ chronyc tracking\nReference ID    : 5751B502 (5751b502.skybroadband.com)\nStratum         : 3\nRef time (UTC)  : Mon Aug 13 17:39:17 2018\nSystem time     : 26450.427734375 seconds slow of NTP time\nLast offset     : -0.000067056 seconds\nRMS offset      : 777.442565918 seconds\nFrequency       : 1.700 ppm slow\nResidual freq   : -0.120 ppm\nSkew            : 3.203 ppm\nRoot delay      : 0.052811030 seconds\nRoot dispersion : 0.006966238 seconds\nUpdate interval : 60.0 seconds\nLeap status     : Normal\n```", "```\n$ chronyc tracking\nReference ID    : 55C7D666 (85.199.214.102)\nStratum         : 2\nRef time (UTC)  : Sun Aug 19 10:55:55 2018\nSystem time     : 0.000031875 seconds slow of NTP time\nLast offset     : -0.000032510 seconds\nRMS offset      : 0.003755528 seconds\nFrequency       : 6.102 ppm slow\nResidual freq   : -0.009 ppm\nSkew            : 3.659 ppm\nRoot delay      : 0.014116751 seconds\nRoot dispersion : 0.000280226 seconds\nUpdate interval : 64.4 seconds\nLeap status     : Normal\n```", "```\nserver 0.centos.pool.ntp.org iburst\nserver 1.centos.pool.ntp.org iburst\nserver 2.centos.pool.ntp.org iburst\nserver 3.centos.pool.ntp.org iburst\n\ndriftfile /var/lib/chrony/drift\n\nmakestep 1.0 3\n\nrtcsync\n\nlogdir /var/log/chrony\n```", "```\n$ sudo systemctl enable chronyd\n$ sudo systemctl start chronyd\n```", "```\n$ sudo tee --append /etc/chrony.conf << HERE\nallow 192.168.33.0/24\nHERE\n```", "```\n$ sudo systemctl restart chronyd\n```", "```\n$ sudo sed -i 's/server/#server/g' /etc/chrony.conf \n```", "```\n$ sudo tee --append /etc/chrony.conf << HERE\nserver 192.168.33.11 iburst\nallow 192.168.33.11\nHERE\n```", "```\n$ sudo systemctl restart chronyd\n```", "```\nallow 192.168.33.0/24\n```", "```\nserver 192.168.33.11 iburst\nallow 192.168.33.11\n```", "```\n$ sudo tcpdump port 123 -i eth1\ntcpdump: verbose output suppressed, use -v or -vv for full protocol decode\nlistening on eth1, link-type EN10MB (Ethernet), capture size 262144 bytes\n11:35:51.370634 IP 192.168.33.10.44912 > centos2.ntp: NTPv4, Client, length 48\n11:35:51.370965 IP centos2.ntp > 192.168.33.10.44912: NTPv4, Server, length 48\n11:35:53.394843 IP 192.168.33.10.52976 > centos2.ntp: NTPv4, Client, length 48\n11:35:53.395162 IP centos2.ntp > 192.168.33.10.52976: NTPv4, Server, length 48\n11:35:55.414496 IP 192.168.33.10.42977 > centos2.ntp: NTPv4, Client, length 48\n11:35:55.414659 IP centos2.ntp > 192.168.33.10.42977: NTPv4, Server, length 48\n11:35:57.437187 IP 192.168.33.10.45651 > centos2.ntp: NTPv4, Client, length 48\n11:35:57.437539 IP centos2.ntp > 192.168.33.10.45651: NTPv4, Server, length 48\n```", "```\n$ chronyc tracking\nReference ID    : C0A8210B (192.168.33.11)\nStratum         : 3\nRef time (UTC)  : Sun Aug 19 11:37:01 2018\nSystem time     : 0.000000264 seconds fast of NTP time\nLast offset     : -0.000468330 seconds\nRMS offset      : 0.000468330 seconds\nFrequency       : 6.604 ppm slow\nResidual freq   : -5.715 ppm\nSkew            : 7.044 ppm\nRoot delay      : 0.016203152 seconds\nRoot dispersion : 0.000595987 seconds\nUpdate interval : 64.2 seconds\nLeap status     : Normal\n```", "```\n$ sudo chronyc sources\n210 Number of sources = 1\nMS Name/IP address         Stratum Poll Reach LastRx Last sample \n===============================================================================\n^* 192.168.33.11                 2   6   377    48    +53us[ +106us] +/- 7783us\n```", "```\n$ sudo chronyc makestep\n200 OK\n```", "```\n$ sudo chronyc serverstats\nNTP packets received       : 8\nNTP packets dropped        : 0\nCommand packets received   : 1\nCommand packets dropped    : 0\nClient log records dropped : 0\n```", "```\n$ sudo systemctl enable --now firewalld\n```", "```\n$ sudo iptables -L\nChain INPUT (policy ACCEPT)\ntarget prot opt source destination \nACCEPT all -- anywhere anywhere ctstate RELATED,ESTABLISHED\nACCEPT all -- anywhere anywhere \nINPUT_direct all -- anywhere anywhere \nINPUT_ZONES_SOURCE all -- anywhere anywhere \nINPUT_ZONES all -- anywhere anywhere \nDROP all -- anywhere anywhere ctstate INVALID\nREJECT all -- anywhere anywhere reject-with icmp-host-prohibited\n\nChain FORWARD (policy ACCEPT)\ntarget prot opt source destination \nACCEPT all -- anywhere anywhere ctstate RELATED,ESTABLISHED\nACCEPT all -- anywhere anywhere \nFORWARD_direct all -- anywhere anywhere \nFORWARD_IN_ZONES_SOURCE all -- anywhere anywhere \nFORWARD_IN_ZONES all -- anywhere anywhere \nFORWARD_OUT_ZONES_SOURCE all -- anywhere anywhere \nFORWARD_OUT_ZONES all -- anywhere anywhere \nDROP all -- anywhere anywhere ctstate INVALID\nREJECT all -- anywhere anywhere reject-with icmp-host-prohibited\n<SNIP>\nChain FWDO_public (3 references)\ntarget prot opt source destination \nFWDO_public_log all -- anywhere anywhere \nFWDO_public_deny all -- anywhere anywhere \nFWDO_public_allow all -- anywhere anywhere \n\nChain FWDO_public_allow (1 references)\ntarget prot opt source destination <SNIP>\n```", "```\n$ sudo iptables -t nat -L\nChain PREROUTING (policy ACCEPT)\ntarget prot opt source destination \nPREROUTING_direct all -- anywhere anywhere \nPREROUTING_ZONES_SOURCE all -- anywhere anywhere \nPREROUTING_ZONES all -- anywhere anywhere \n\nChain INPUT (policy ACCEPT)\ntarget prot opt source destination \n\nChain OUTPUT (policy ACCEPT)\ntarget prot opt source destination \nOUTPUT_direct all -- anywhere anywhere \n\nChain POSTROUTING (policy ACCEPT)\ntarget prot opt source destination \nPOSTROUTING_direct all -- anywhere anywhere \nPOSTROUTING_ZONES_SOURCE all -- anywhere anywhere \nPOSTROUTING_ZONES all -- anywhere anywhere \n\nChain OUTPUT_direct (1 references)\ntarget prot opt source destination \n\nChain POSTROUTING_ZONES (1 references)\ntarget prot opt source destination \nPOST_public all -- anywhere anywhere [goto] \nPOST_public all -- anywhere anywhere [goto] \nPOST_public all -- anywhere anywhere [goto] \nPOST_public all -- anywhere anywhere [goto] \n\nChain POSTROUTING_ZONES_SOURCE (1 references)\ntarget prot opt source destination \n\nChain POSTROUTING_direct (1 references)\ntarget prot opt source destination \n<SNIP>\nChain PRE_public_log (1 references)\ntarget prot opt source destination \n```", "```\n$ sudo iptables -S\n-P INPUT ACCEPT\n-P FORWARD ACCEPT\n-P OUTPUT ACCEPT\n-N FORWARD_IN_ZONES\n-N FORWARD_IN_ZONES_SOURCE\n-N FORWARD_OUT_ZONES\n-N FORWARD_OUT_ZONES_SOURCE\n-N FORWARD_direct\n-N FWDI_public\n-N FWDI_public_allow\n-N FWDI_public_deny\n-N FWDI_public_log\n-N FWDO_public\n-N FWDO_public_allow\n-N FWDO_public_deny\n-N FWDO_public_log\n-N INPUT_ZONES\n-N INPUT_ZONES_SOURCE\n-N INPUT_direct\n-N IN_public\n-N IN_public_allow\n-N IN_public_deny\n-N IN_public_log\n-N OUTPUT_direct\n-A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT\n-A INPUT -i lo -j ACCEPT\n-A INPUT -j INPUT_direct\n-A INPUT -j INPUT_ZONES_SOURCE\n-A INPUT -j INPUT_ZONES\n-A INPUT -m conntrack --ctstate INVALID -j DROP\n-A INPUT -j REJECT --reject-with icmp-host-prohibited\n-A FORWARD -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT\n-A FORWARD -i lo -j ACCEPT\n-A FORWARD -j FORWARD_direct\n-A FORWARD -j FORWARD_IN_ZONES_SOURCE\n-A FORWARD -j FORWARD_IN_ZONES\n-A FORWARD -j FORWARD_OUT_ZONES_SOURCE\n-A FORWARD -j FORWARD_OUT_ZONES\n-A FORWARD -m conntrack --ctstate INVALID -j DROP\n-A FORWARD -j REJECT --reject-with icmp-host-prohibited\n-A OUTPUT -j OUTPUT_direct\n-A FORWARD_IN_ZONES -i eth2 -g FWDI_public\n-A FORWARD_IN_ZONES -i eth1 -g FWDI_public\n-A FORWARD_IN_ZONES -i eth0 -g FWDI_public\n-A FORWARD_IN_ZONES -g FWDI_public\n-A FORWARD_OUT_ZONES -o eth2 -g FWDO_public\n-A FORWARD_OUT_ZONES -o eth1 -g FWDO_public\n-A FORWARD_OUT_ZONES -o eth0 -g FWDO_public\n-A FORWARD_OUT_ZONES -g FWDO_public\n-A FWDI_public -j FWDI_public_log\n-A FWDI_public -j FWDI_public_deny\n-A FWDI_public -j FWDI_public_allow\n-A FWDI_public -p icmp -j ACCEPT\n-A FWDO_public -j FWDO_public_log\n-A FWDO_public -j FWDO_public_deny\n-A FWDO_public -j FWDO_public_allow\n-A INPUT_ZONES -i eth2 -g IN_public\n-A INPUT_ZONES -i eth1 -g IN_public\n-A INPUT_ZONES -i eth0 -g IN_public\n-A INPUT_ZONES -g IN_public\n-A IN_public -j IN_public_log\n-A IN_public -j IN_public_deny\n-A IN_public -j IN_public_allow\n-A IN_public -p icmp -j ACCEPT\n-A IN_public_allow -p tcp -m tcp --dport 22 -m conntrack --ctstate NEW -j ACCEPT\n```", "```\n$ sudo firewall-cmd --get-zones\nblock dmz drop external home internal public trusted work\n```", "```\n$ firewall-cmd --get-active-zones\npublic\n interfaces: eth0 eth1\n```", "```\n$ sudo firewall-cmd --list-all --zone public\npublic (active)\n target: default\n icmp-block-inversion: no\n interfaces: eth0 eth1 eth2\n sources: \n services: ssh dhcpv6-client\n ports: \n protocols: \n masquerade: no\n forward-ports: \n source-ports: \n icmp-blocks: \n rich rules: \n```", "```\n$ sudo firewall-cmd --zone public --list-services \nssh dhcpv6-client\n```", "```\n$ sudo firewall-cmd --info-service ssh\nssh\n ports: 22/tcp\n protocols: \n source-ports: \n modules: \n destination:\n```", "```\nvagrant@ubuntu1:~$ sudo ufw allow ssh/tcp\nRule added\nRule added (v6)\n```", "```\nvagrant@ubuntu1:~$ sudo ufw enable\nCommand may disrupt existing ssh connections. Proceed with operation (y|n)? y\nFirewall is active and enabled on system startup\n```", "```\nvagrant@ubuntu1:~$ sudo ufw status verbose\nStatus: active\nLogging: on (low)\nDefault: deny (incoming), allow (outgoing), disabled (routed)\nNew profiles: skip\n\nTo                         Action      From\n--                         ------      ----\n22/tcp                     ALLOW IN    Anywhere                  \n22/tcp (v6)                ALLOW IN    Anywhere (v6) \n```", "```\n$ yum whatprovides iptables\n```", "```\n$ sudo systemctl enable --now firewalld\n```", "```\n$ python -m SimpleHTTPServer &> /dev/null &\n[1] 2732\n```", "```\n$ curl 192.168.33.10:8000\ncurl: (7) Failed connect to 192.168.33.10:8000; No route to host\n```", "```\n$ sudo firewall-cmd --zone public --list-all\npublic (active)\n target: default\n icmp-block-inversion: no\n interfaces: eth0 eth1\n sources: \n services: ssh dhcpv6-client\n ports: \n protocols: \n masquerade: no\n forward-ports: \n source-ports: \n icmp-blocks: \n rich rules: \n```", "```\n$ sudo firewall-cmd --permanent --zone=public --add-port 8000/tcp\n```", "```\n$ sudo firewall-cmd --zone=public --add-port 8000/tcp\n```", "```\n$ sudo firewall-cmd --zone public --list-all \npublic (active)\n target: default\n icmp-block-inversion: no\n interfaces: eth0 eth1 eth2\n sources: \n services: ssh dhcpv6-client\n ports: 8000/tcp\n protocols: \n masquerade: no\n forward-ports: \n source-ports: \n icmp-blocks: \n rich rules:\n```", "```\n$ curl 192.168.33.10:8000\n<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 3.2 Final//EN\"><html>\n<title>Directory listing for /</title>\n<body>\n<h2>Directory listing for /</h2>\n<hr>\n<ul>\n<li><a href=\".bash_history\">.bash_history</a>\n<li><a href=\".bash_logout\">.bash_logout</a>\n<li><a href=\".bash_profile\">.bash_profile</a>\n<li><a href=\".bashrc\">.bashrc</a>\n<li><a href=\".ssh/\">.ssh/</a>\n</ul>\n<hr>\n</body>\n</html>\n```", "```\n$ sudo firewall-cmd --zone=public --remove-port 8000/tcp\nsuccess\n```", "```\n$ sudo systemctl disable --now firewalld\n```", "```\n$ sudo iptables -S\n-P INPUT ACCEPT\n-P FORWARD ACCEPT\n-P OUTPUT ACCEPT\n```", "```\n$ sudo iptables -A INPUT -i eth1 -p tcp -m tcp --dport 22 -j DROP\n```", "```\n$ sudo iptables -A INPUT -s 10.0.2.0/24 -p tcp -m tcp --dport 22 -j ACCEPT\n```", "```\n$ sudo iptables -P INPUT DROP\n```", "```\n$ sudo iptables -A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT\n```", "```\n$ sudo iptables -S\n-P INPUT DROP\n-P FORWARD ACCEPT\n-P OUTPUT ACCEPT\n-A INPUT -i eth1 -p tcp -m tcp --dport 22 -j DROP\n-A INPUT -s 10.0.2.0/24 -p tcp -m tcp --dport 22 -j ACCEPT\n-A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT\n```", "```\nvagrant@ubuntu1:~$ sudo ufw allow ssh/tcp\nRule added\nRule added (v6)\n```", "```\nvagrant@ubuntu1:~$ sudo ufw status verbose\nStatus: active\nLogging: on (low)\nDefault: deny (incoming), allow (outgoing), disabled (routed)\nNew profiles: skip\n```", "```\nvagrant@ubuntu1:~$ sudo ufw allow from 10.0.2.0/24 to any port 80 proto tcp\nRule added\n```", "```\nvagrant@ubuntu1:~$ sudo ufw status\nStatus: active\n\nTo                         Action      From\n--                         ------      ----\n22/tcp                     ALLOW       Anywhere \n80/tcp                     ALLOW       10.0.2.0/24 \n22/tcp (v6)                ALLOW       Anywhere (v6)  \n```", "```\nvagrant@ubuntu1:~$ sudo ufw delete allow from 10.0.2.0/24 to any port 80 proto tcp\nRule deleted\n```", "```\n$ sudo iptables -S\n-P INPUT ACCEPT\n-P FORWARD ACCEPT\n-P OUTPUT ACCEPT\n```", "```\n$ sudo iptables -A INPUT -s 10.0.2.0/24 -p tcp -m tcp --dport 22 -j ACCEPT\n```", "```\n$ sudo iptables\n```", "```\n-A INPUT\n```", "```\n-s 10.0.2.0/24\n```", "```\n-p tcp -m tcp\n```", "```\n--dport 22\n```", "```\n-j ACCEPT\n```", "```\n$ sudo iptables-save\n# Generated by iptables-save v1.4.21 on Sun Aug 19 15:04:14 2018\n*filter\n:INPUT DROP [0:0]\n:FORWARD ACCEPT [0:0]\n:OUTPUT ACCEPT [3:236]\n-A INPUT -i eth1 -p tcp -m tcp --dport 22 -j DROP\n-A INPUT -s 10.0.2.0/24 -p tcp -m tcp --dport 22 -j ACCEPT\n-A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT\nCOMMIT\n# Completed on Sun Aug 19 15:04:14 2018\n```", "```\n$ sudo iptables-save | sudo tee /etc/sysconfig/iptables\n```", "```\n$ sudo yum install -y iptables-services\n```", "```\n$ sudo systemctl enable iptables\n```", "```\n$ sudo service iptables restart\nRedirecting to /bin/systemctl restart iptables.service\n$ sudo iptables -S\n-P INPUT DROP\n-P FORWARD ACCEPT\n-P OUTPUT ACCEPT\n-A INPUT -i eth1 -p tcp -m tcp --dport 22 -j DROP\n-A INPUT -s 10.0.2.0/24 -p tcp -m tcp --dport 22 -j ACCEPT\n-A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT\n```", "```\n$ sudo iptables -S\n-P INPUT DROP\n-P FORWARD ACCEPT\n-P OUTPUT ACCEPT\n-A INPUT -i eth1 -p tcp -m tcp --dport 22 -j DROP\n-A INPUT -s 10.0.2.0/24 -p tcp -m tcp --dport 22 -j ACCEPT\n-A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT\n```", "```\n$ sudo iptables -F\n$\n```", "```\n$ sudo yum install -y lsof\n```", "```\n$ ss -tua\nNetid  State      Recv-Q Send-Q                                      Local Address:Port                                                       Peer Address:Port \nudp    UNCONN     0      0                                               127.0.0.1:323                                                                   *:* \nudp    UNCONN     0      0                                                       *:bootpc                                                                *:* \nudp    UNCONN     0      0                                                       *:bootpc                                                                *:* \nudp    UNCONN     0      0                                                       *:sunrpc                                                                *:* \nudp    UNCONN     0      0                                                       *:ntp                                                                   *:* \nudp    UNCONN     0      0                                                       *:728                                                                   *:* \nudp    UNCONN     0      0                                                     ::1:323                                                                  :::* \nudp    UNCONN     0      0                                                      :::sunrpc                                                               :::* \nudp    UNCONN     0      0                                                      :::728                                                                  :::* \ntcp    LISTEN     0      5                                                       *:irdmi                                                                 *:* \ntcp    LISTEN     0      128                                                     *:sunrpc                                                                *:* \ntcp    LISTEN     0      128                                                     *:ssh                                                                   *:* \ntcp    LISTEN     0      100                                             127.0.0.1:smtp                                                                  *:* \ntcp    ESTAB      0      0                                               10.0.2.15:ssh                                                            10.0.2.2:36116 \ntcp    LISTEN     0      128                                                    :::sunrpc                                                               :::* \ntcp    LISTEN     0      128                                                    :::ssh                                                                  :::* \ntcp    LISTEN     0      100                                                   ::1:smtp                                                                 :::* \n```", "```\n$ ss -tua state established\nNetid  Recv-Q Send-Q                                           Local Address:Port                                                            Peer Address:Port \ntcp    0      0                                                    10.0.2.15:ssh                                                                 10.0.2.2:36116       \n```", "```\n$ ss -tl \nState      Recv-Q Send-Q                                         Local Address:Port                                                          Peer Address:Port \nLISTEN     0      5                                                          *:irdmi                                                                    *:* \nLISTEN     0      128                                                        *:sunrpc                                                                   *:* \nLISTEN     0      128                                                        *:ssh                                                                      *:* \nLISTEN     0      100                                                127.0.0.1:smtp                                                                     *:* \nLISTEN     0      128                                                       :::sunrpc                                                                  :::* \nLISTEN     0      128                                                       :::ssh                                                                     :::* \nLISTEN     0      100                                                      ::1:smtp                                                                    :::*             \n```", "```\n$ ss -ul \nState      Recv-Q Send-Q                                         Local Address:Port                                                          Peer Address:Port \nUNCONN     0      0                                                  127.0.0.1:323                                                                      *:* \nUNCONN     0      0                                                          *:bootpc                                                                   *:* \nUNCONN     0      0                                                          *:sunrpc                                                                   *:* \nUNCONN     0      0                                                          *:ntp                                                                      *:* \nUNCONN     0      0                                                          *:728                                                                      *:* \nUNCONN     0      0                                                        ::1:323                                                                     :::* \nUNCONN     0      0                                                         :::sunrpc                                                                  :::* \nUNCONN     0      0                                                         :::728                                                                     :::*          \n```", "```\n$ ss -l sport = :22\nNetid  State      Recv-Q Send-Q                                      Local Address:Port                                                       Peer Address:Port \ntcp    LISTEN     0      128                                                     *:ssh                                                                   *:* \ntcp    LISTEN     0      128                                                    :::ssh                                                                  :::*       \n```", "```\n$ grep \"^ssh \" /etc/services\nssh             22/tcp                          # The Secure Shell (SSH) Protocol\nssh             22/udp                          # The Secure Shell (SSH) Protocol\nssh             22/sctp                 # SSH\n```", "```\n$ ss -l sport = :2222\nNetid  State      Recv-Q Send-Q                                      Local Address:Port                                                       Peer Address:Port \ntcp    LISTEN     0      5                                                       *:EtherNet/IP-1                                                         *:*     \n```", "```\n$ grep \"^EtherNet\" /etc/services\nEtherNet/IP-1   2222/tcp  EtherNet-IP-1 # EtherNet/IP I/O\nEtherNet/IP-1   2222/udp  EtherNet-IP-1 # EtherNet/IP I/O\nEtherNet/IP-2   44818/tcp EtherNet-IP-2  # EtherNet/IP messaging\nEtherNet/IP-2   44818/udp EtherNet-IP-2  # EtherNet/IP messaging\n```", "```\n$ sudo lsof -i :22\nCOMMAND  PID    USER   FD   TYPE DEVICE SIZE/OFF NODE NAME\nsshd     877    root    3u  IPv4  17409      0t0  TCP *:ssh (LISTEN)\nsshd     877    root    4u  IPv6  17479      0t0  TCP *:ssh (LISTEN)\nsshd    4262    root    3u  IPv4  43232      0t0  TCP centos1:ssh->gateway:36116 (ESTABLISHED)\nsshd    4265 vagrant    3u  IPv4  43232      0t0  TCP centos1:ssh->gateway:36116 (ESTABLISHED) \n```", "```\n$ sudo lsof -Pni :22\nCOMMAND PID USER FD TYPE DEVICE SIZE/OFF NODE NAME\nsshd 3454 root 3u IPv4 26892 0t0 TCP *:22 (LISTEN)\nsshd 3454 root 4u IPv6 26894 0t0 TCP *:22 (LISTEN)\nsshd 3457 root 3u IPv4 26951 0t0 TCP 10.0.2.15:22->10.0.2.2:33066 (ESTABLISHED)\nsshd 3460 vagrant 3u IPv4 26951 0t0 TCP 10.0.2.15:22->10.0.2.2:33066 (ESTABLISHED)\n```", "```\n$ sudo lsof -i :2222\nCOMMAND  PID    USER   FD   TYPE DEVICE SIZE/OFF NODE NAME\npython  4542 vagrant    3u  IPv4  45493      0t0  TCP *:EtherNet/IP-1 (LISTEN)\n```", "```\n$ ps aux | grep 4542\nvagrant   4542  0.0  2.0  97820 10136 pts/2    S    15:39   0:00 python -m SimpleHTTPServer 2222\n```", "```\n$ sudo yum install -y epel-release\n$ sudo yum install -y iftop\n```", "```\n$ sudo iftop -i eth1\n```", "```\n$ ssh 192.168.33.11\nThe authenticity of host '192.168.33.11 (192.168.33.11)' can't be established.\nECDSA key fingerprint is SHA256:GwCeJ/ObTsyKxMxzazTaYvvyY3SFgxPl6ucjPDGwmao.\nECDSA key fingerprint is MD5:0d:41:ad:71:67:07:35:d4:59:07:de:41:bf:a4:b4:93.\nAre you sure you want to continue connecting (yes/no)? yes\nWarning: Permanently added '192.168.33.11' (ECDSA) to the list of known hosts.\nvagrant@192.168.33.11's password: \nLast login: Sun Aug 19 15:04:49 2018 from 10.0.2.2\n$ \n```", "```\n$ sudo iftop -i eth1 -t\ninterface: eth1\nIP address is: 192.168.33.11\nMAC address is: 08:00:27:f1:e9:56\nListening on eth1\n # Host name (port/service if enabled)            last 2s   last 10s   last 40s cumulative\n--------------------------------------------------------------------------------------------\n 1 centos2                                  =>     35.7Kb     35.7Kb     35.7Kb     8.91KB\n 192.168.33.10                            <=       416b       416b       416b       104B\n--------------------------------------------------------------------------------------------\nTotal send rate:                                     35.7Kb     35.7Kb     35.7Kb\nTotal receive rate:                                    416b       416b       416b\nTotal send and receive rate:                         36.1Kb     36.1Kb     36.1Kb\n--------------------------------------------------------------------------------------------\nPeak rate (sent/received/total):                     35.7Kb       416b     36.1Kb\nCumulative (sent/received/total):                    8.91KB       104B     9.02KB\n=============================================================================================\n```"]